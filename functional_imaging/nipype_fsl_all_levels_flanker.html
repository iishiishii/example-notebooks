

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Setup Neurodesk &#8212; Neurodesk</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'functional_imaging/nipype_fsl_all_levels_flanker';</script>
    <link rel="canonical" href="https://iishiishii.github.io/example-notebooks/functional_imaging/nipype_fsl_all_levels_flanker.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    <p class="title logo__title">Neurodesk</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://play-sydney.neurodesk.org/v2/gh/neurodesk/example-notebooks/v2/gh/iishiishii/example-notebooks/master?urlpath=tree/functional_imaging/nipype_fsl_all_levels_flanker.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/iishiishii/example-notebooks/blob/master/functional_imaging/nipype_fsl_all_levels_flanker.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/iishiishii/example-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/iishiishii/example-notebooks/edit/main/functional_imaging/nipype_fsl_all_levels_flanker.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/iishiishii/example-notebooks/issues/new?title=Issue%20on%20page%20%2Ffunctional_imaging/nipype_fsl_all_levels_flanker.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/functional_imaging/nipype_fsl_all_levels_flanker.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Setup Neurodesk</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Setup Neurodesk</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#first-level-glm-using-nipype-fsl">First-level GLM using Nipype FSL</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-data-path">Set up data path</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#start-the-workflow">Start the workflow</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initialisation">Initialisation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motion-correction">Motion Correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functionally-masking">Functionally Masking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grand-mean-scaling">Grand Mean Scaling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#susan-noise-reduction">SUSAN Noise Reduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-filtering">Temporal Filtering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#first-level-glm">First-Level GLM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-events">Get events</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-contrasts">Set-up contrasts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#registration">Registration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1">Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2">Step 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-first-level-glm">The first-level GLM</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#second-level-glm-using-nipype-fsl">Second level GLM using Nipype FSL</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-level-glm">Second-level GLM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-level-input-files-preparation">Higher-level input files preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-merge-registered-copes-varcopes-masks">Step 1: Merge registered copes &amp; varcopes &amp; masks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-making-mask">Step 2: Making mask</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-masking-copes-varcopes">Step 3: Masking copes &amp; varcopes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-second-level-contrasts-and-fixed-effects">Set up second-level contrasts and fixed-effects</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-second-level-glm">The second-level GLM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regapply">Regapply</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copes-from-the-second-level-glm">Copes from the second-level GLM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#third-level-glm-using-nipype-fsl">Third-level GLM using Nipype FSL</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#third-level-glm">Third-level GLM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Higher-level input files preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Step 1: Merge registered copes &amp; varcopes &amp; masks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Step 2: Making mask</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Step 3: Masking copes &amp; varcopes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-third-level-contrasts">Set up third-level contrasts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-stats">Post-Stats</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#smoothness-estimation">Smoothness estimation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mask-zstats-file">Mask zstats file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-wise-thresholding">Cluster-wise thresholding</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-the-output">Save the output</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unthresholded-copes">Unthresholded COPEs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thresholded-p-0-05-zstats">Thresholded (p &lt; 0.05) zstats</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><a href="https://play-sydney.neurodesk.org/v2/gh/neurodesk/example-notebooks/main?labpath=functional_imaging%2Fnipype_fsl_all_levels_flanker.ipynb" target="_parent"><img src="https://img.shields.io/badge/launch-binder-579aca.svg?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADUElEQVR4nCyTzUtkRxfGn6pTtz/FtvsVp32NKBgF6QiBCU505xBpBdsJiMkyi2SRxSSEZPI3JKuEbGYREgaCi0zMENBeSCSCqwzRCCIzSBtHuqEl9ihif9zbfe+tqnCaqdXh1q1znuec31EAkM/nEYlEcH5+jmw2K5VSwvM8rVT3GmEYIh6PUxiGtlKpmNHRUQRBgK2tLdDi4iLOzs4wMjKCaDRKxhijlLIRx0kmk8lhIkoHQeArpTpaa5vJZCgej9vj42NMT09DVSoVXF5ewm21SAihAbwJ4HM/CO42ms2slJIT/wvgD2vtN9baQ8/zqFqtaiKCYIlLS0uklNJBEHwspfyu2WpF+lIpTIyPo9Fs4sXZGYzWiMVinTAMPyWi7621VCwWtSgUCuxNSynfl1L+zDLvzs3pd+/do/8PDsJrt1EqlfDL+rp+9vw5xWIxobV+T2u97jgOScdxjLU2o5R66LquffvOHfPJ/fuqL5USFxcXgs9bt2+LLx88UIPZrAmCwBLRQwBpfistayFaBZCBELqvr4+01uAJOI6DiOPg5uYG2Vu3MDc3R51ORwsh+olopft2cnISxpgvhBBvdNptWyqVZOnkBP/LZPD6xARe1mqonp+jVqvh1ydPcHV1ZdiGtbZORL91m7i8vLzt+/47+Xxe53I5+vPpU9xcX+O14WEcHBygv78fuVwOPP/t7W19eHhI0Wj0942NjbxaXV1Fu91uEhFb6c52fn4ejUYD+/v73XhsbIxBQrlcxs7ODqSUFkBjZWUFMpPJwFq7z/Stra1ZrthqtdgWewZb9DyPi6BYLHIC+2oSf/f29kIODQ1Ba/2YIerp6RG+79tkMgm+dF23i3E6nWYGGF/L/xhjQmvt41QqBbm3t8cQ/QPgaykllUqlIAgCI4RAIpFgCsFxo1E35XI5UEoRgK+klC9OT09JLCwsCMdx5NHRkZmamnqktf5gYGAAMzMzmJ2dNaxid3dXsrV6vQ4ierS5uflhoVCQYRgawcsEQLDsRCJhr6+vP/J9/7NOp5Nj2dwL3rxYLPZMKfVtOp3+0XVdwX0CYBXL44ArWWsZrB9yudxP1Wp12vO88VfLdNLTk/yrVnvpu64rm82m4e98/gsAAP//Lbmu802E+U4AAAAASUVORK5CYII=" alt="Open In Binder"/>  </a>
<a href="https://colab.research.google.com/github/NeuroDesk/example-notebooks/blob/main/functional_imaging/nipype_fsl_all_levels_flanker.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>   </a></p>
<p>Author: Monika Doerig</p>
<p>Original peper: <a class="reference external" href="https://www.frontiersin.org/articles/10.3389/fnimg.2022.953215/full">https://www.frontiersin.org/articles/10.3389/fnimg.2022.953215/full</a></p>
<p>Original code: <a class="reference external" href="https://osf.io/prg53/?view_only=9d7974834a484cdb972bcc3989589b78">https://osf.io/prg53/?view_only=9d7974834a484cdb972bcc3989589b78</a></p>
<section id="setup-neurodesk">
<h1>Setup Neurodesk<a class="headerlink" href="#setup-neurodesk" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%capture
import os
import sys
IN_COLAB = &#39;google.colab&#39; in sys.modules

if IN_COLAB:
  os.environ[&quot;LD_PRELOAD&quot;] = &quot;&quot;;
  os.environ[&quot;APPTAINER_BINDPATH&quot;] = &quot;/content,/tmp,/cvmfs&quot;
  os.environ[&quot;MPLCONFIGDIR&quot;] = &quot;/content/matplotlib-mpldir&quot;
  os.environ[&quot;LMOD_CMD&quot;] = &quot;/usr/share/lmod/lmod/libexec/lmod&quot;

  !curl -J -O https://raw.githubusercontent.com/NeuroDesk/neurocommand/main/googlecolab_setup.sh
  !chmod +x googlecolab_setup.sh
  !./googlecolab_setup.sh

  os.environ[&quot;MODULEPATH&quot;] = &#39;:&#39;.join(map(str, list(map(lambda x: os.path.join(os.path.abspath(&#39;/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/&#39;), x),os.listdir(&#39;/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/&#39;)))))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Output CPU information:</span>
<span class="o">!</span>cat<span class="w"> </span>/proc/cpuinfo<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;vendor&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq
<span class="o">!</span>cat<span class="w"> </span>/proc/cpuinfo<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;model name&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vendor_id	: GenuineIntel
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>model name	: Intel(R) Xeon(R) Platinum 8272CL CPU @ 2.60GHz
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pandas<span class="w"> </span>nilearn<span class="w"> </span>matplotlib
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Defaulting to user installation because normal site-packages is not writeable
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pandas in /home/runner/.local/lib/python3.8/site-packages (2.0.2)
Requirement already satisfied: nilearn in /home/runner/.local/lib/python3.8/site-packages (0.10.1)
Requirement already satisfied: matplotlib in /home/runner/.local/lib/python3.8/site-packages (3.7.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: python-dateutil&gt;=2.8.2 in /home/runner/.local/lib/python3.8/site-packages (from pandas) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /home/runner/.local/lib/python3.8/site-packages (from pandas) (2023.3)
Requirement already satisfied: tzdata&gt;=2022.1 in /home/runner/.local/lib/python3.8/site-packages (from pandas) (2023.3)
Requirement already satisfied: numpy&gt;=1.20.3 in /home/runner/.local/lib/python3.8/site-packages (from pandas) (1.24.3)
Requirement already satisfied: joblib&gt;=1.0.0 in /home/runner/.local/lib/python3.8/site-packages (from nilearn) (1.2.0)
Requirement already satisfied: lxml in /home/runner/.local/lib/python3.8/site-packages (from nilearn) (4.9.2)
Requirement already satisfied: nibabel&gt;=3.2.0 in /home/runner/.local/lib/python3.8/site-packages (from nilearn) (5.1.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.8/dist-packages (from nilearn) (23.1)
Requirement already satisfied: requests&gt;=2.25.0 in /home/runner/.local/lib/python3.8/site-packages (from nilearn) (2.31.0)
Requirement already satisfied: scikit-learn&gt;=1.0.0 in /home/runner/.local/lib/python3.8/site-packages (from nilearn) (1.2.2)
Requirement already satisfied: scipy&gt;=1.6.0 in /home/runner/.local/lib/python3.8/site-packages (from nilearn) (1.10.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: contourpy&gt;=1.0.1 in /home/runner/.local/lib/python3.8/site-packages (from matplotlib) (1.1.0)
Requirement already satisfied: cycler&gt;=0.10 in /home/runner/.local/lib/python3.8/site-packages (from matplotlib) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /home/runner/.local/lib/python3.8/site-packages (from matplotlib) (4.40.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /home/runner/.local/lib/python3.8/site-packages (from matplotlib) (1.4.4)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/lib/python3/dist-packages (from matplotlib) (7.0.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /home/runner/.local/lib/python3.8/site-packages (from matplotlib) (3.1.0)
Requirement already satisfied: importlib-resources&gt;=3.2.0 in /home/runner/.local/lib/python3.8/site-packages (from matplotlib) (5.12.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: zipp&gt;=3.1.0 in /home/runner/.local/lib/python3.8/site-packages (from importlib-resources&gt;=3.2.0-&gt;matplotlib) (3.15.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: six&gt;=1.5 in /usr/lib/python3/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.14.0)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /home/runner/.local/lib/python3.8/site-packages (from requests&gt;=2.25.0-&gt;nilearn) (3.1.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/lib/python3/dist-packages (from requests&gt;=2.25.0-&gt;nilearn) (2.8)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/lib/python3/dist-packages (from requests&gt;=2.25.0-&gt;nilearn) (1.25.8)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/lib/python3/dist-packages (from requests&gt;=2.25.0-&gt;nilearn) (2019.11.28)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /home/runner/.local/lib/python3.8/site-packages (from scikit-learn&gt;=1.0.0-&gt;nilearn) (3.1.0)
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="first-level-glm-using-nipype-fsl">
<h1>First-level GLM using Nipype FSL<a class="headerlink" href="#first-level-glm-using-nipype-fsl" title="Permalink to this heading">#</a></h1>
<p>In this notebook, we recreate the first-level GLM and the first level GLM of FSL GUI using nipype code. For each nipype node, we list the corresponding fsl command from the log file. The dataset we use is a Flanker task, which can be downloaded <a class="reference external" href="https://openneuro.org/datasets/ds000102/versions/00001">here</a>.</p>
<p>We also borrow some helps from this <a class="reference external" href="https://nipype.readthedocs.io/en/latest/users/examples/fmri_fsl.html">document</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#load fsl module</span>
<span class="kn">import</span> <span class="nn">lmod</span>
<span class="k">await</span> <span class="n">lmod</span><span class="o">.</span><span class="n">purge</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">await</span> <span class="n">lmod</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;fsl/6.0.5.1&#39;</span><span class="p">)</span> <span class="c1">#Original pipeline: FSL 6.0.4, nipype 1.6.1.</span>
<span class="k">await</span> <span class="n">lmod</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lmod Warning: The environment MODULEPATH has been changed in unexpected ways.
Lmod is unable to use given MODULEPATH. It is using:

&quot;/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/functional_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/rodent_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_registration:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/structural_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_segmentation:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/quantitative_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/workflows:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/hippocampus:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_reconstruction:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/data_organisation:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/electrophysiology:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/phase_processing:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/programming:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/machine_learning:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/diffusion_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/body:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/visualization:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/spectroscopy:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/quality_control:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/statistics:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/shape_analysis:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/spine:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/molecular_biology:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/bids_apps::&quot;.

Please use &quot;module use ...&quot; to change MODULEPATH instead. 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Lmod&#39;,
 &#39;Warning:&#39;,
 &#39;The&#39;,
 &#39;environment&#39;,
 &#39;MODULEPATH&#39;,
 &#39;has&#39;,
 &#39;been&#39;,
 &#39;changed&#39;,
 &#39;in&#39;,
 &#39;unexpected&#39;,
 &#39;ways.&#39;,
 &#39;Lmod&#39;,
 &#39;is&#39;,
 &#39;unable&#39;,
 &#39;to&#39;,
 &#39;use&#39;,
 &#39;given&#39;,
 &#39;MODULEPATH.&#39;,
 &#39;It&#39;,
 &#39;is&#39;,
 &#39;using:&#39;,
 &#39;&quot;/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/functional_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/rodent_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_registration:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/structural_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_segmentation:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/quantitative_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/workflows:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/hippocampus:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_reconstruction:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/data_organisation:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/electrophysiology:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/phase_processing:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/programming:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/machine_learning:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/diffusion_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/body:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/visualization:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/spectroscopy:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/quality_control:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/statistics:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/shape_analysis:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/spine:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/molecular_biology:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/bids_apps::&quot;.&#39;,
 &#39;Please&#39;,
 &#39;use&#39;,
 &#39;&quot;module&#39;,
 &#39;use&#39;,
 &#39;to&#39;,
 &#39;change&#39;,
 &#39;MODULEPATH&#39;,
 &#39;instead.&#39;,
 &#39;fsl/6.0.5.1&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;FSLDIR&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;/cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;FSLOUTPUTTYPE&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;NIFTI_GZ&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SINGULARITY_BINDPATH&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;/data,/neurodesktop-storage,/tmp,/cvmfs&quot;</span>
</pre></div>
</div>
</div>
</div>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Permalink to this heading">#</a></h2>
<p>Import all the relevant libraries needed for the preprocessing stage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">str</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">range</span>

<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>

<span class="kn">from</span> <span class="nn">nipype</span> <span class="kn">import</span> <span class="n">Function</span>
<span class="kn">from</span> <span class="nn">nipype.interfaces</span> <span class="kn">import</span> <span class="n">fsl</span><span class="p">,</span> <span class="n">utility</span> <span class="k">as</span> <span class="n">util</span><span class="p">,</span> <span class="n">io</span> <span class="k">as</span> <span class="n">nio</span>
<span class="kn">import</span> <span class="nn">nipype.pipeline.engine</span> <span class="k">as</span> <span class="nn">pe</span>  <span class="c1"># pypeline engine</span>
<span class="kn">import</span> <span class="nn">nipype.algorithms.modelgen</span> <span class="k">as</span> <span class="nn">model</span>  <span class="c1"># model generation</span>
<span class="kn">import</span> <span class="nn">nipype.algorithms.rapidart</span> <span class="k">as</span> <span class="nn">ra</span>  <span class="c1"># artifact detection</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">nilearn</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">surface</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check output type and fsl version</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fsl</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">output_type</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fsl</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">version</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NIFTI_GZ
6.0.5.1:57b01774
</pre></div>
</div>
</div>
</div>
<section id="set-up-data-path">
<h3>Set up data path<a class="headerlink" href="#set-up-data-path" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Input: Set the BIDS path</span>
<span class="n">data_dir_first</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;ds000102&#39;</span><span class="p">)</span>
<span class="c1"># Output: Set path where nipype will store stepwise results</span>
<span class="n">exp_dir_first</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;output_level1&#39;</span><span class="p">)</span>

<span class="c1"># Input: Set path of first level outputs</span>
<span class="n">data_dir_second</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;output_level1/level1_results/&#39;</span><span class="p">)</span>
<span class="c1"># Output: Set path where nipype will store stepwise results</span>
<span class="n">exp_dir_second</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;output_level2/&#39;</span><span class="p">)</span>

<span class="c1"># Input: Set path of second level outputs</span>
<span class="n">data_dir_third</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;output_level2/level2_results/&#39;</span><span class="p">)</span>
<span class="c1"># Output: Set path where nipype will store stepwise results</span>
<span class="n">exp_dir_third</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;output_level3/&#39;</span><span class="p">)</span>

<span class="n">PATTERN</span> <span class="o">=</span> <span class="s2">&quot;sub-0*&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>datalad<span class="w"> </span>install<span class="w"> </span>https://github.com/OpenNeuroDatasets/ds000102.git
<span class="o">!</span><span class="nb">cd</span><span class="w"> </span>ds000102<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>datalad<span class="w"> </span>get<span class="w"> </span><span class="nv">$PATTERN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>It is highly recommended to configure Git before using DataLad. Set both &#39;user.name&#39; and &#39;user.email&#39; configuration variables.
It is highly recommended to configure Git before using DataLad. Set both &#39;user.name&#39; and &#39;user.email&#39; configuration variables.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Clone attempt:   0%|              | 0.00/2.00 [00:00&lt;?, ? Candidate locations/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cloning (counting objects):   0%|             | 0.00/27.0 [00:00&lt;?, ? objects/s]

Cloning (counting objects):   4%|▏    | 1.00/27.0 [00:00&lt;00:00, 37.1k objects/s]

Cloning (counting objects):   7%|▎    | 2.00/27.0 [00:00&lt;00:00, 20.6k objects/s]

Cloning (counting objects):  11%|▌    | 3.00/27.0 [00:00&lt;00:00, 19.9k objects/s]

Cloning (counting objects):  15%|▋    | 4.00/27.0 [00:00&lt;00:00, 19.7k objects/s]

Cloning (counting objects):  19%|▉    | 5.00/27.0 [00:00&lt;00:00, 20.0k objects/s]

Cloning (counting objects):  22%|█    | 6.00/27.0 [00:00&lt;00:00, 20.3k objects/s]

Cloning (counting objects):  26%|█▎   | 7.00/27.0 [00:00&lt;00:00, 20.6k objects/s]

Cloning (counting objects):  30%|█▍   | 8.00/27.0 [00:00&lt;00:00, 20.7k objects/s]

Cloning (counting objects):  33%|█▋   | 9.00/27.0 [00:00&lt;00:00, 20.8k objects/s]

Cloning (counting objects):  37%|█▊   | 10.0/27.0 [00:00&lt;00:00, 21.0k objects/s]

Cloning (counting objects):  41%|██   | 11.0/27.0 [00:00&lt;00:00, 21.1k objects/s]

Cloning (counting objects):  44%|██▏  | 12.0/27.0 [00:00&lt;00:00, 21.3k objects/s]

Cloning (counting objects):  48%|██▍  | 13.0/27.0 [00:00&lt;00:00, 21.3k objects/s]

Cloning (counting objects):  52%|██▌  | 14.0/27.0 [00:00&lt;00:00, 21.4k objects/s]

Cloning (counting objects):  56%|██▊  | 15.0/27.0 [00:00&lt;00:00, 21.5k objects/s]

Cloning (counting objects):  59%|██▉  | 16.0/27.0 [00:00&lt;00:00, 21.6k objects/s]

Cloning (counting objects):  63%|███▏ | 17.0/27.0 [00:00&lt;00:00, 21.6k objects/s]

Cloning (counting objects):  67%|███▎ | 18.0/27.0 [00:00&lt;00:00, 21.6k objects/s]

Cloning (counting objects):  70%|███▌ | 19.0/27.0 [00:00&lt;00:00, 21.7k objects/s]

Cloning (counting objects):  74%|███▋ | 20.0/27.0 [00:00&lt;00:00, 21.7k objects/s]

Cloning (counting objects):  78%|███▉ | 21.0/27.0 [00:00&lt;00:00, 21.8k objects/s]

Cloning (counting objects):  81%|████ | 22.0/27.0 [00:00&lt;00:00, 21.8k objects/s]

Cloning (counting objects):  85%|████▎| 23.0/27.0 [00:00&lt;00:00, 21.9k objects/s]

Cloning (counting objects):  89%|████▍| 24.0/27.0 [00:00&lt;00:00, 21.9k objects/s]

Cloning (counting objects):  93%|████▋| 25.0/27.0 [00:00&lt;00:00, 22.0k objects/s]

Cloning (counting objects):  96%|████▊| 26.0/27.0 [00:00&lt;00:00, 22.0k objects/s]

Cloning (counting objects): 100%|█████| 27.0/27.0 [00:00&lt;00:00, 22.0k objects/s]

Cloning (counting objects): 100%|█████| 27.0/27.0 [00:00&lt;00:00, 21.2k objects/s]

                                                                                

Cloning (compressing objects):   0%|          | 0.00/23.0 [00:00&lt;?, ? objects/s]

Cloning (compressing objects):   4%|  | 1.00/23.0 [00:00&lt;00:00, 82.2k objects/s]

Cloning (compressing objects):   9%|▏ | 2.00/23.0 [00:00&lt;00:00, 33.4k objects/s]

Cloning (compressing objects):  13%|▎ | 3.00/23.0 [00:00&lt;00:00, 27.0k objects/s]

Cloning (compressing objects):  17%|▎ | 4.00/23.0 [00:00&lt;00:00, 25.6k objects/s]

Cloning (compressing objects):  22%|▍ | 5.00/23.0 [00:00&lt;00:00, 23.4k objects/s]

Cloning (compressing objects):  26%|▌ | 6.00/23.0 [00:00&lt;00:00, 23.2k objects/s]

Cloning (compressing objects):  30%|▌ | 7.00/23.0 [00:00&lt;00:00, 23.0k objects/s]

Cloning (compressing objects):  35%|▋ | 8.00/23.0 [00:00&lt;00:00, 22.9k objects/s]

Cloning (compressing objects):  39%|▊ | 9.00/23.0 [00:00&lt;00:00, 22.9k objects/s]

Cloning (compressing objects):  43%|▊ | 10.0/23.0 [00:00&lt;00:00, 22.8k objects/s]

Cloning (compressing objects):  48%|▉ | 11.0/23.0 [00:00&lt;00:00, 22.7k objects/s]

Cloning (compressing objects):  52%|█ | 12.0/23.0 [00:00&lt;00:00, 22.7k objects/s]

Cloning (compressing objects):  57%|█▏| 13.0/23.0 [00:00&lt;00:00, 22.7k objects/s]

Cloning (compressing objects):  61%|█▏| 14.0/23.0 [00:00&lt;00:00, 22.8k objects/s]

Cloning (compressing objects):  65%|█▎| 15.0/23.0 [00:00&lt;00:00, 21.8k objects/s]

Cloning (compressing objects):  70%|█▍| 16.0/23.0 [00:00&lt;00:00, 21.8k objects/s]

Cloning (compressing objects):  74%|█▍| 17.0/23.0 [00:00&lt;00:00, 21.9k objects/s]

Cloning (compressing objects):  78%|█▌| 18.0/23.0 [00:00&lt;00:00, 21.9k objects/s]

Cloning (compressing objects):  83%|█▋| 19.0/23.0 [00:00&lt;00:00, 21.9k objects/s]

Cloning (compressing objects):  87%|█▋| 20.0/23.0 [00:00&lt;00:00, 21.9k objects/s]

Cloning (compressing objects):  91%|█▊| 21.0/23.0 [00:00&lt;00:00, 22.0k objects/s]

Cloning (compressing objects):  96%|█▉| 22.0/23.0 [00:00&lt;00:00, 21.9k objects/s]

Cloning (compressing objects): 100%|██| 23.0/23.0 [00:00&lt;00:00, 22.0k objects/s]

Cloning (compressing objects): 100%|██| 23.0/23.0 [00:00&lt;00:00, 21.0k objects/s]

                                                                                

Cloning (receiving objects):   0%|           | 0.00/2.15k [00:00&lt;?, ? objects/s]

Cloning (receiving objects):   0%|   | 1.00/2.15k [00:00&lt;00:00, 66.6k objects/s]

Cloning (receiving objects):   1%|    | 22.0/2.15k [00:00&lt;00:00, 134k objects/s]

Cloning (receiving objects):   2%|    | 43.0/2.15k [00:00&lt;00:00, 101k objects/s]

Cloning (receiving objects):   3%|   | 65.0/2.15k [00:00&lt;00:00, 5.52k objects/s]

Cloning (receiving objects):   4%|   | 86.0/2.15k [00:00&lt;00:00, 7.13k objects/s]

Cloning (receiving objects):   5%|▏   | 108/2.15k [00:00&lt;00:00, 8.84k objects/s]

Cloning (receiving objects):   6%|▏   | 129/2.15k [00:00&lt;00:00, 10.4k objects/s]

Cloning (receiving objects):   7%|▎   | 151/2.15k [00:00&lt;00:00, 12.1k objects/s]

Cloning (receiving objects):   8%|▎   | 172/2.15k [00:00&lt;00:00, 13.6k objects/s]

Cloning (receiving objects):   9%|▎   | 194/2.15k [00:00&lt;00:00, 15.3k objects/s]

Cloning (receiving objects):  10%|▍   | 215/2.15k [00:00&lt;00:00, 16.8k objects/s]

Cloning (receiving objects):  11%|▍   | 237/2.15k [00:00&lt;00:00, 18.4k objects/s]

Cloning (receiving objects):  12%|▍   | 258/2.15k [00:00&lt;00:00, 19.8k objects/s]

Cloning (receiving objects):  13%|▌   | 280/2.15k [00:00&lt;00:00, 21.4k objects/s]

Cloning (receiving objects):  14%|▌   | 301/2.15k [00:00&lt;00:00, 22.7k objects/s]

Cloning (receiving objects):  15%|▌   | 323/2.15k [00:00&lt;00:00, 24.3k objects/s]

Cloning (receiving objects):  16%|▋   | 344/2.15k [00:00&lt;00:00, 25.7k objects/s]

Cloning (receiving objects):  17%|▋   | 366/2.15k [00:00&lt;00:00, 27.2k objects/s]

Cloning (receiving objects):  18%|▋   | 387/2.15k [00:00&lt;00:00, 18.2k objects/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cloning (receiving objects):  19%|▊   | 409/2.15k [00:00&lt;00:00, 15.2k objects/s]

Cloning (receiving objects):  20%|▊   | 430/2.15k [00:00&lt;00:00, 15.9k objects/s]

Cloning (receiving objects):  21%|▊   | 452/2.15k [00:00&lt;00:00, 16.7k objects/s]

Cloning (receiving objects):  22%|▉   | 473/2.15k [00:00&lt;00:00, 12.6k objects/s]

Cloning (receiving objects):  23%|▉   | 495/2.15k [00:00&lt;00:00, 13.1k objects/s]

Cloning (receiving objects):  24%|▉   | 516/2.15k [00:00&lt;00:00, 13.6k objects/s]

Cloning (receiving objects):  25%|█   | 538/2.15k [00:00&lt;00:00, 14.2k objects/s]

Cloning (receiving objects):  26%|█   | 559/2.15k [00:00&lt;00:00, 14.7k objects/s]

Cloning (receiving objects):  27%|█   | 581/2.15k [00:00&lt;00:00, 15.3k objects/s]

Cloning (receiving objects):  28%|█   | 602/2.15k [00:00&lt;00:00, 15.8k objects/s]

Cloning (receiving objects):  29%|█▏  | 624/2.15k [00:00&lt;00:00, 16.3k objects/s]

Cloning (receiving objects):  30%|█▏  | 645/2.15k [00:00&lt;00:00, 16.8k objects/s]

Cloning (receiving objects):  31%|█▏  | 667/2.15k [00:00&lt;00:00, 17.3k objects/s]

Cloning (receiving objects):  32%|█▎  | 688/2.15k [00:00&lt;00:00, 17.9k objects/s]

Cloning (receiving objects):  33%|█▎  | 710/2.15k [00:00&lt;00:00, 18.4k objects/s]

Cloning (receiving objects):  34%|█▎  | 731/2.15k [00:00&lt;00:00, 18.9k objects/s]

Cloning (receiving objects):  35%|█▍  | 753/2.15k [00:00&lt;00:00, 19.4k objects/s]

Cloning (receiving objects):  36%|█▍  | 774/2.15k [00:00&lt;00:00, 19.9k objects/s]

Cloning (receiving objects):  37%|█▍  | 796/2.15k [00:00&lt;00:00, 20.4k objects/s]

Cloning (receiving objects):  38%|█▌  | 817/2.15k [00:00&lt;00:00, 20.9k objects/s]

Cloning (receiving objects):  39%|█▌  | 839/2.15k [00:00&lt;00:00, 21.4k objects/s]

Cloning (receiving objects):  40%|█▌  | 860/2.15k [00:00&lt;00:00, 21.9k objects/s]

Cloning (receiving objects):  41%|█▋  | 882/2.15k [00:00&lt;00:00, 22.5k objects/s]

Cloning (receiving objects):  42%|█▋  | 903/2.15k [00:00&lt;00:00, 23.0k objects/s]

Cloning (receiving objects):  43%|█▋  | 925/2.15k [00:00&lt;00:00, 23.5k objects/s]

Cloning (receiving objects):  44%|█▊  | 946/2.15k [00:00&lt;00:00, 24.0k objects/s]

Cloning (receiving objects):  45%|█▊  | 968/2.15k [00:00&lt;00:00, 24.5k objects/s]

Cloning (receiving objects):  46%|█▊  | 989/2.15k [00:00&lt;00:00, 25.0k objects/s]

Cloning (receiving objects):  47%|▉ | 1.01k/2.15k [00:00&lt;00:00, 23.2k objects/s]

Cloning (receiving objects):  48%|▉ | 1.03k/2.15k [00:00&lt;00:00, 23.6k objects/s]

Cloning (receiving objects):  49%|▉ | 1.05k/2.15k [00:00&lt;00:00, 24.1k objects/s]

Cloning (receiving objects):  50%|█ | 1.07k/2.15k [00:00&lt;00:00, 24.4k objects/s]

Cloning (receiving objects):  51%|█ | 1.10k/2.15k [00:00&lt;00:00, 24.9k objects/s]

Cloning (receiving objects):  52%|█ | 1.12k/2.15k [00:00&lt;00:00, 22.8k objects/s]

Cloning (receiving objects):  53%|█ | 1.14k/2.15k [00:00&lt;00:00, 23.2k objects/s]

Cloning (receiving objects):  54%|█ | 1.16k/2.15k [00:00&lt;00:00, 23.6k objects/s]

Cloning (receiving objects):  55%|█ | 1.18k/2.15k [00:00&lt;00:00, 24.0k objects/s]

Cloning (receiving objects):  56%|█ | 1.20k/2.15k [00:00&lt;00:00, 24.4k objects/s]

Cloning (receiving objects):  57%|█▏| 1.23k/2.15k [00:00&lt;00:00, 19.7k objects/s]

Cloning (receiving objects):  58%|█▏| 1.25k/2.15k [00:00&lt;00:00, 20.0k objects/s]

Cloning (receiving objects):  59%|█▏| 1.27k/2.15k [00:00&lt;00:00, 20.3k objects/s]

Cloning (receiving objects):  60%|█▏| 1.29k/2.15k [00:00&lt;00:00, 20.6k objects/s]

Cloning (receiving objects):  61%|█▏| 1.31k/2.15k [00:00&lt;00:00, 20.9k objects/s]

Cloning (receiving objects):  62%|█▏| 1.33k/2.15k [00:00&lt;00:00, 21.2k objects/s]

Cloning (receiving objects):  63%|█▎| 1.35k/2.15k [00:00&lt;00:00, 21.6k objects/s]

Cloning (receiving objects):  64%|█▎| 1.38k/2.15k [00:00&lt;00:00, 21.9k objects/s]

Cloning (receiving objects):  65%|█▎| 1.40k/2.15k [00:00&lt;00:00, 22.2k objects/s]

Cloning (receiving objects):  66%|█▎| 1.42k/2.15k [00:00&lt;00:00, 22.5k objects/s]

Cloning (receiving objects):  67%|█▎| 1.44k/2.15k [00:00&lt;00:00, 22.8k objects/s]

Cloning (receiving objects):  68%|█▎| 1.46k/2.15k [00:00&lt;00:00, 23.1k objects/s]

Cloning (receiving objects):  69%|█▍| 1.48k/2.15k [00:00&lt;00:00, 23.5k objects/s]

Cloning (receiving objects):  70%|█▍| 1.50k/2.15k [00:00&lt;00:00, 23.8k objects/s]

Cloning (receiving objects):  71%|█▍| 1.53k/2.15k [00:00&lt;00:00, 24.1k objects/s]

Cloning (receiving objects):  72%|█▍| 1.55k/2.15k [00:00&lt;00:00, 24.4k objects/s]

Cloning (receiving objects):  73%|█▍| 1.57k/2.15k [00:00&lt;00:00, 24.7k objects/s]

Cloning (receiving objects):  74%|█▍| 1.59k/2.15k [00:00&lt;00:00, 25.0k objects/s]

Cloning (receiving objects):  75%|█▌| 1.61k/2.15k [00:00&lt;00:00, 25.4k objects/s]

Cloning (receiving objects):  76%|█▌| 1.63k/2.15k [00:00&lt;00:00, 25.7k objects/s]

Cloning (receiving objects):  77%|█▌| 1.66k/2.15k [00:00&lt;00:00, 26.0k objects/s]

Cloning (receiving objects):  78%|█▌| 1.68k/2.15k [00:00&lt;00:00, 26.3k objects/s]

Cloning (receiving objects):  79%|█▌| 1.70k/2.15k [00:00&lt;00:00, 26.6k objects/s]

Cloning (receiving objects):  80%|█▌| 1.72k/2.15k [00:00&lt;00:00, 26.9k objects/s]

Cloning (receiving objects):  81%|█▌| 1.74k/2.15k [00:00&lt;00:00, 27.2k objects/s]

Cloning (receiving objects):  82%|█▋| 1.76k/2.15k [00:00&lt;00:00, 27.5k objects/s]

Cloning (receiving objects):  83%|█▋| 1.78k/2.15k [00:00&lt;00:00, 27.8k objects/s]

Cloning (receiving objects):  84%|█▋| 1.81k/2.15k [00:00&lt;00:00, 28.1k objects/s]

Cloning (receiving objects):  85%|█▋| 1.83k/2.15k [00:00&lt;00:00, 28.4k objects/s]

Cloning (receiving objects):  86%|█▋| 1.85k/2.15k [00:00&lt;00:00, 28.7k objects/s]

Cloning (receiving objects):  87%|█▋| 1.87k/2.15k [00:00&lt;00:00, 29.0k objects/s]

Cloning (receiving objects):  88%|█▊| 1.89k/2.15k [00:00&lt;00:00, 29.3k objects/s]

Cloning (receiving objects):  89%|█▊| 1.91k/2.15k [00:00&lt;00:00, 29.6k objects/s]

Cloning (receiving objects):  90%|█▊| 1.94k/2.15k [00:00&lt;00:00, 29.9k objects/s]

Cloning (receiving objects):  91%|█▊| 1.96k/2.15k [00:00&lt;00:00, 30.2k objects/s]

Cloning (receiving objects):  92%|█▊| 1.98k/2.15k [00:00&lt;00:00, 30.5k objects/s]

Cloning (receiving objects):  93%|█▊| 2.00k/2.15k [00:00&lt;00:00, 30.8k objects/s]

Cloning (receiving objects):  94%|█▉| 2.02k/2.15k [00:00&lt;00:00, 31.1k objects/s]

Cloning (receiving objects):  95%|█▉| 2.04k/2.15k [00:00&lt;00:00, 31.4k objects/s]

Cloning (receiving objects):  96%|█▉| 2.06k/2.15k [00:00&lt;00:00, 31.7k objects/s]

Cloning (receiving objects):  97%|█▉| 2.09k/2.15k [00:00&lt;00:00, 32.0k objects/s]

Cloning (receiving objects):  98%|█▉| 2.11k/2.15k [00:00&lt;00:00, 32.3k objects/s]

Cloning (receiving objects):  99%|█▉| 2.13k/2.15k [00:00&lt;00:00, 32.6k objects/s]

Cloning (receiving objects): 100%|██| 2.15k/2.15k [00:00&lt;00:00, 32.9k objects/s]

Cloning (receiving objects): 100%|██| 2.15k/2.15k [00:00&lt;00:00, 32.9k objects/s]

                                                                                

Cloning (resolving stuff):   0%|               | 0.00/537 [00:00&lt;?, ? objects/s]

Cloning (resolving stuff):   0%|               | 0.00/537 [00:00&lt;?, ? objects/s]

Cloning (resolving stuff):   1%|       | 6.00/537 [00:00&lt;00:00, 55.3k objects/s]

Cloning (resolving stuff):   2%|▏      | 11.0/537 [00:00&lt;00:00, 60.4k objects/s]

Cloning (resolving stuff):   3%|▏      | 17.0/537 [00:00&lt;00:00, 72.9k objects/s]

Cloning (resolving stuff):   4%|▎      | 22.0/537 [00:00&lt;00:00, 66.1k objects/s]

Cloning (resolving stuff):   5%|▎      | 27.0/537 [00:00&lt;00:00, 70.7k objects/s]

Cloning (resolving stuff):   6%|▍      | 33.0/537 [00:00&lt;00:00, 70.5k objects/s]

Cloning (resolving stuff):   7%|▍      | 38.0/537 [00:00&lt;00:00, 72.7k objects/s]

Cloning (resolving stuff):   8%|▌      | 43.0/537 [00:00&lt;00:00, 75.5k objects/s]

Cloning (resolving stuff):   9%|▋      | 49.0/537 [00:00&lt;00:00, 74.4k objects/s]

Cloning (resolving stuff):  10%|▋      | 54.0/537 [00:00&lt;00:00, 76.0k objects/s]

Cloning (resolving stuff):  11%|▊      | 60.0/537 [00:00&lt;00:00, 79.2k objects/s]

Cloning (resolving stuff):  12%|▊      | 65.0/537 [00:00&lt;00:00, 76.7k objects/s]

Cloning (resolving stuff):  13%|▉      | 70.0/537 [00:00&lt;00:00, 78.0k objects/s]

Cloning (resolving stuff):  14%|▉      | 76.0/537 [00:00&lt;00:00, 80.5k objects/s]

Cloning (resolving stuff):  15%|█      | 81.0/537 [00:00&lt;00:00, 77.7k objects/s]

Cloning (resolving stuff):  16%|█      | 86.0/537 [00:00&lt;00:00, 78.7k objects/s]

Cloning (resolving stuff):  17%|█▏     | 92.0/537 [00:00&lt;00:00, 80.8k objects/s]

Cloning (resolving stuff):  18%|█▎     | 97.0/537 [00:00&lt;00:00, 78.9k objects/s]

Cloning (resolving stuff):  19%|█▌      | 103/537 [00:00&lt;00:00, 80.5k objects/s]

Cloning (resolving stuff):  20%|█▌      | 108/537 [00:00&lt;00:00, 81.4k objects/s]

Cloning (resolving stuff):  21%|█▋      | 113/537 [00:00&lt;00:00, 79.8k objects/s]

Cloning (resolving stuff):  22%|█▊      | 119/537 [00:00&lt;00:00, 81.2k objects/s]

Cloning (resolving stuff):  23%|█▊      | 124/537 [00:00&lt;00:00, 82.0k objects/s]

Cloning (resolving stuff):  24%|█▉      | 129/537 [00:00&lt;00:00, 80.6k objects/s]

Cloning (resolving stuff):  25%|██      | 135/537 [00:00&lt;00:00, 81.9k objects/s]

Cloning (resolving stuff):  26%|██      | 140/537 [00:00&lt;00:00, 82.6k objects/s]

Cloning (resolving stuff):  27%|██▏     | 145/537 [00:00&lt;00:00, 81.2k objects/s]

Cloning (resolving stuff):  28%|██▏     | 151/537 [00:00&lt;00:00, 82.4k objects/s]

Cloning (resolving stuff):  29%|██▎     | 156/537 [00:00&lt;00:00, 83.0k objects/s]

Cloning (resolving stuff):  30%|██▍     | 162/537 [00:00&lt;00:00, 82.2k objects/s]

Cloning (resolving stuff):  31%|██▍     | 167/537 [00:00&lt;00:00, 82.7k objects/s]

Cloning (resolving stuff):  32%|██▌     | 172/537 [00:00&lt;00:00, 83.3k objects/s]

Cloning (resolving stuff):  33%|██▋     | 178/537 [00:00&lt;00:00, 82.5k objects/s]

Cloning (resolving stuff):  34%|██▋     | 183/537 [00:00&lt;00:00, 83.0k objects/s]

Cloning (resolving stuff):  35%|██▊     | 188/537 [00:00&lt;00:00, 82.2k objects/s]

Cloning (resolving stuff):  36%|██▉     | 194/537 [00:00&lt;00:00, 82.8k objects/s]

Cloning (resolving stuff):  37%|██▉     | 199/537 [00:00&lt;00:00, 83.3k objects/s]

Cloning (resolving stuff):  38%|███     | 205/537 [00:00&lt;00:00, 82.9k objects/s]

Cloning (resolving stuff):  39%|███▏    | 210/537 [00:00&lt;00:00, 83.1k objects/s]

Cloning (resolving stuff):  40%|███▏    | 215/537 [00:00&lt;00:00, 83.5k objects/s]

Cloning (resolving stuff):  41%|███▎    | 221/537 [00:00&lt;00:00, 83.1k objects/s]

Cloning (resolving stuff):  42%|███▎    | 226/537 [00:00&lt;00:00, 83.3k objects/s]

Cloning (resolving stuff):  43%|███▍    | 231/537 [00:00&lt;00:00, 83.7k objects/s]

Cloning (resolving stuff):  44%|███▌    | 237/537 [00:00&lt;00:00, 82.9k objects/s]

Cloning (resolving stuff):  45%|███▌    | 242/537 [00:00&lt;00:00, 83.2k objects/s]

Cloning (resolving stuff):  46%|███▋    | 248/537 [00:00&lt;00:00, 83.9k objects/s]

Cloning (resolving stuff):  47%|███▊    | 253/537 [00:00&lt;00:00, 83.1k objects/s]

Cloning (resolving stuff):  48%|███▊    | 258/537 [00:00&lt;00:00, 83.4k objects/s]

Cloning (resolving stuff):  49%|███▉    | 264/537 [00:00&lt;00:00, 84.1k objects/s]

Cloning (resolving stuff):  50%|████    | 269/537 [00:00&lt;00:00, 83.0k objects/s]

Cloning (resolving stuff):  51%|████    | 274/537 [00:00&lt;00:00, 83.2k objects/s]

Cloning (resolving stuff):  52%|████▏   | 280/537 [00:00&lt;00:00, 83.8k objects/s]

Cloning (resolving stuff):  53%|████▏   | 285/537 [00:00&lt;00:00, 83.0k objects/s]

Cloning (resolving stuff):  54%|████▎   | 290/537 [00:00&lt;00:00, 83.3k objects/s]

Cloning (resolving stuff):  55%|████▍   | 296/537 [00:00&lt;00:00, 83.0k objects/s]

Cloning (resolving stuff):  56%|████▍   | 301/537 [00:00&lt;00:00, 83.2k objects/s]

Cloning (resolving stuff):  57%|████▌   | 307/537 [00:00&lt;00:00, 80.6k objects/s]

Cloning (resolving stuff):  58%|████▋   | 312/537 [00:00&lt;00:00, 80.7k objects/s]

Cloning (resolving stuff):  59%|████▋   | 317/537 [00:00&lt;00:00, 80.2k objects/s]

Cloning (resolving stuff):  60%|████▊   | 323/537 [00:00&lt;00:00, 80.5k objects/s]

Cloning (resolving stuff):  61%|████▉   | 328/537 [00:00&lt;00:00, 80.8k objects/s]

Cloning (resolving stuff):  62%|████▉   | 333/537 [00:00&lt;00:00, 80.2k objects/s]

Cloning (resolving stuff):  63%|█████   | 339/537 [00:00&lt;00:00, 80.7k objects/s]

Cloning (resolving stuff):  64%|█████   | 344/537 [00:00&lt;00:00, 80.9k objects/s]

Cloning (resolving stuff):  65%|█████▏  | 350/537 [00:00&lt;00:00, 80.7k objects/s]

Cloning (resolving stuff):  66%|█████▎  | 355/537 [00:00&lt;00:00, 80.9k objects/s]

Cloning (resolving stuff):  67%|█████▎  | 360/537 [00:00&lt;00:00, 81.2k objects/s]

Cloning (resolving stuff):  68%|█████▍  | 366/537 [00:00&lt;00:00, 80.9k objects/s]

Cloning (resolving stuff):  69%|█████▌  | 371/537 [00:00&lt;00:00, 81.1k objects/s]

Cloning (resolving stuff):  70%|█████▌  | 376/537 [00:00&lt;00:00, 81.4k objects/s]

Cloning (resolving stuff):  71%|█████▋  | 382/537 [00:00&lt;00:00, 81.1k objects/s]

Cloning (resolving stuff):  72%|█████▊  | 387/537 [00:00&lt;00:00, 81.3k objects/s]

Cloning (resolving stuff):  73%|█████▊  | 393/537 [00:00&lt;00:00, 81.8k objects/s]

Cloning (resolving stuff):  74%|█████▉  | 398/537 [00:00&lt;00:00, 81.3k objects/s]

Cloning (resolving stuff):  75%|██████  | 403/537 [00:00&lt;00:00, 81.5k objects/s]

Cloning (resolving stuff):  76%|██████  | 409/537 [00:00&lt;00:00, 82.0k objects/s]

Cloning (resolving stuff):  77%|██████▏ | 414/537 [00:00&lt;00:00, 81.5k objects/s]

Cloning (resolving stuff):  78%|██████▏ | 419/537 [00:00&lt;00:00, 81.7k objects/s]

Cloning (resolving stuff):  79%|██████▎ | 425/537 [00:00&lt;00:00, 82.1k objects/s]

Cloning (resolving stuff):  80%|██████▍ | 430/537 [00:00&lt;00:00, 82.2k objects/s]

Cloning (resolving stuff):  81%|██████▍ | 435/537 [00:00&lt;00:00, 82.4k objects/s]

Cloning (resolving stuff):  82%|██████▌ | 441/537 [00:00&lt;00:00, 82.8k objects/s]

Cloning (resolving stuff):  83%|██████▋ | 446/537 [00:00&lt;00:00, 83.1k objects/s]

Cloning (resolving stuff):  84%|██████▋ | 452/537 [00:00&lt;00:00, 83.5k objects/s]

Cloning (resolving stuff):  85%|██████▊ | 457/537 [00:00&lt;00:00, 83.8k objects/s]

Cloning (resolving stuff):  86%|██████▉ | 462/537 [00:00&lt;00:00, 84.0k objects/s]

Cloning (resolving stuff):  87%|██████▉ | 468/537 [00:00&lt;00:00, 84.4k objects/s]

Cloning (resolving stuff):  88%|███████ | 473/537 [00:00&lt;00:00, 84.7k objects/s]

Cloning (resolving stuff):  89%|███████ | 478/537 [00:00&lt;00:00, 84.9k objects/s]

Cloning (resolving stuff):  90%|███████▏| 484/537 [00:00&lt;00:00, 85.3k objects/s]

Cloning (resolving stuff):  91%|███████▎| 489/537 [00:00&lt;00:00, 85.5k objects/s]

Cloning (resolving stuff):  92%|███████▎| 495/537 [00:00&lt;00:00, 85.8k objects/s]

Cloning (resolving stuff):  93%|███████▍| 500/537 [00:00&lt;00:00, 86.1k objects/s]

Cloning (resolving stuff):  94%|███████▌| 505/537 [00:00&lt;00:00, 86.4k objects/s]

Cloning (resolving stuff):  95%|███████▌| 511/537 [00:00&lt;00:00, 86.9k objects/s]

Cloning (resolving stuff):  96%|███████▋| 516/537 [00:00&lt;00:00, 87.2k objects/s]

Cloning (resolving stuff):  97%|███████▊| 521/537 [00:00&lt;00:00, 87.5k objects/s]

Cloning (resolving stuff):  98%|███████▊| 527/537 [00:00&lt;00:00, 88.0k objects/s]

Cloning (resolving stuff):  99%|███████▉| 532/537 [00:00&lt;00:00, 88.3k objects/s]

Cloning (resolving stuff): 100%|████████| 537/537 [00:00&lt;00:00, 88.6k objects/s]

Cloning (resolving stuff): 100%|████████| 537/537 [00:00&lt;00:00, 88.1k objects/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                
                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO   ] Author identity unknown 
[INFO   ]  
[INFO   ] *** Please tell me who you are. 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO   ]  
[INFO   ] Run 
[INFO   ]  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO   ]   git config --global user.email &quot;you@example.com&quot; 
[INFO   ]   git config --global user.name &quot;Your Name&quot; 
[INFO   ] to set your account&#39;s default identity. 
[INFO   ] Omit --global to set the identity only in this repository. 
[INFO   ] fatal: empty ident name (for &lt;runner@fv-az96-114.m4cgkdvplvgupd014rd20bgx3d.gx.internal.cloudapp.net&gt;) not allowed 
[INFO   ]   Remote origin not usable by git-annex; setting annex-ignore 
[INFO   ] access to 1 dataset sibling s3-PRIVATE not auto-enabled, enable with:
| 		datalad siblings -d &quot;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/ds000102&quot; enable -s s3-PRIVATE 
<span class=" -Color -Color-Bold">install</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): /home/runner/work/example-notebooks/example-notebooks/functional_imaging/ds000102 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">dataset</span>)

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>It is highly recommended to configure Git before using DataLad. Set both &#39;user.name&#39; and &#39;user.email&#39; configuration variables.
It is highly recommended to configure Git before using DataLad. Set both &#39;user.name&#39; and &#39;user.email&#39; configuration variables.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   0%|                                         | 0.00/618M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-08/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.6M [00:00&lt;?, ?B/s]


sub-08/func .. bold.nii.gz:   0%|                   | 0.00/28.6M [00:00&lt;?, ?B/s]



sub-08/func .. bold.nii.gz:   0%|                   | 0.00/28.6M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   0%|                                  | 104k/618M [00:00&lt;58:05, 177kB/s]


sub-08/func .. bold.nii.gz:   0%|            | 107k/28.6M [00:00&lt;00:31, 909kB/s]

sub-08/anat .. _T1w.nii.gz:   2%|▏          | 173k/10.6M [00:00&lt;00:07, 1.33MB/s]



sub-08/func .. bold.nii.gz:   0%|           | 121k/28.6M [00:00&lt;00:27, 1.05MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   0%|                                 | 1.29M/618M [00:00&lt;40:51, 252kB/s]



sub-08/func .. bold.nii.gz:   3%|▎          | 869k/28.6M [00:00&lt;00:19, 1.41MB/s]


sub-08/func .. bold.nii.gz:   3%|▎          | 838k/28.6M [00:00&lt;00:22, 1.22MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   1%|▏                                | 4.28M/618M [00:00&lt;28:33, 358kB/s]

sub-08/anat .. _T1w.nii.gz:  24%|██▍       | 2.57M/10.6M [00:00&lt;00:04, 1.83MB/s]



sub-08/func .. bold.nii.gz:   6%|▋         | 1.83M/28.6M [00:00&lt;00:14, 1.89MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   1%|▍                                | 8.46M/618M [00:00&lt;19:55, 510kB/s]

sub-08/anat .. _T1w.nii.gz:  38%|███▊      | 4.03M/10.6M [00:00&lt;00:02, 2.47MB/s]



sub-08/func .. bold.nii.gz:  11%|█         | 3.11M/28.6M [00:00&lt;00:10, 2.53MB/s]


sub-08/func .. bold.nii.gz:  14%|█▍        | 4.15M/28.6M [00:00&lt;00:14, 1.69MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   2%|▋                                | 12.4M/618M [00:01&lt;13:56, 724kB/s]

sub-08/anat .. _T1w.nii.gz:  49%|████▉     | 5.17M/10.6M [00:00&lt;00:01, 3.22MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   3%|▊                               | 16.7M/618M [00:01&lt;09:45, 1.03MB/s]

sub-08/anat .. _T1w.nii.gz:  64%|██████▍   | 6.78M/10.6M [00:00&lt;00:00, 4.23MB/s]



sub-08/func .. bold.nii.gz:  23%|██▎       | 6.48M/28.6M [00:00&lt;00:06, 3.40MB/s]


sub-08/func .. bold.nii.gz:  24%|██▍       | 6.85M/28.6M [00:00&lt;00:09, 2.29MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   3%|█                               | 21.4M/618M [00:01&lt;06:50, 1.45MB/s]

sub-08/anat .. _T1w.nii.gz:  76%|███████▌  | 8.01M/10.6M [00:00&lt;00:00, 5.27MB/s]



sub-08/func .. bold.nii.gz:  28%|██▊       | 7.99M/28.6M [00:00&lt;00:04, 4.43MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   4%|█▎                              | 25.6M/618M [00:01&lt;04:49, 2.05MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-08/anat .. _T1w.nii.gz:  87%|████████▋ | 9.24M/10.6M [00:00&lt;00:00, 6.35MB/s]



sub-08/func .. bold.nii.gz:  34%|███▍      | 9.72M/28.6M [00:00&lt;00:03, 5.68MB/s]


sub-08/func .. bold.nii.gz:  35%|███▍      | 10.0M/28.6M [00:00&lt;00:06, 3.08MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   5%|█▌                              | 30.2M/618M [00:01&lt;03:25, 2.87MB/s]

sub-08/anat .. _T1w.nii.gz:  99%|█████████▉| 10.5M/10.6M [00:00&lt;00:00, 7.42MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-08/func .. bold.nii.gz:  39%|███▉      | 11.2M/28.6M [00:00&lt;00:02, 6.81MB/s]


sub-08/func .. bold.nii.gz:  40%|████      | 11.5M/28.6M [00:00&lt;00:04, 3.98MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   6%|█▊                              | 34.5M/618M [00:01&lt;02:27, 3.96MB/s]


sub-08/func .. bold.nii.gz:  46%|████▌     | 13.2M/28.6M [00:01&lt;00:02, 5.17MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-08/func .. bold.nii.gz:  48%|████▊     | 13.7M/28.6M [00:01&lt;00:01, 7.94MB/s]
Total:   6%|██                              | 38.9M/618M [00:01&lt;01:47, 5.40MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-08/func .. bold.nii.gz:  54%|█████▍    | 15.4M/28.6M [00:01&lt;00:01, 9.47MB/s]


sub-08/func .. bold.nii.gz:  57%|█████▋    | 16.2M/28.6M [00:01&lt;00:01, 6.42MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   7%|██▎                             | 44.3M/618M [00:01&lt;01:20, 7.15MB/s]



sub-08/func .. bold.nii.gz:  61%|██████    | 17.5M/28.6M [00:01&lt;00:00, 11.3MB/s]


sub-08/func .. bold.nii.gz:  63%|██████▎   | 17.9M/28.6M [00:01&lt;00:01, 7.91MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   8%|██▍                             | 48.0M/618M [00:01&lt;01:00, 9.42MB/s]



sub-08/func .. bold.nii.gz:  68%|██████▊   | 19.5M/28.6M [00:01&lt;00:00, 13.0MB/s]


sub-08/func .. bold.nii.gz:  70%|███████   | 20.1M/28.6M [00:01&lt;00:00, 9.74MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.6M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   8%|██▋                             | 52.3M/618M [00:02&lt;00:45, 12.3MB/s]



sub-08/func .. bold.nii.gz:  76%|███████▌  | 21.7M/28.6M [00:01&lt;00:00, 14.8MB/s]


sub-08/func .. bold.nii.gz:  78%|███████▊  | 22.4M/28.6M [00:01&lt;00:00, 11.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:   9%|██▉                             | 56.7M/618M [00:02&lt;00:35, 15.7MB/s]



sub-08/func .. bold.nii.gz:  82%|████████▏ | 23.6M/28.6M [00:01&lt;00:00, 15.8MB/s]


sub-08/func .. bold.nii.gz:  85%|████████▍ | 24.3M/28.6M [00:01&lt;00:00, 13.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/anat .. _T1w.nii.gz:   7%|▊          | 730k/10.6M [00:00&lt;00:02, 3.64MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  10%|███▏                            | 60.7M/618M [00:02&lt;00:29, 19.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/anat .. _T1w.nii.gz:  22%|██▏       | 2.35M/10.6M [00:00&lt;00:01, 4.74MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  11%|███▍                            | 65.7M/618M [00:02&lt;00:23, 23.5MB/s]



sub-08/func .. bold.nii.gz:  93%|█████████▎| 26.7M/28.6M [00:01&lt;00:00, 15.7MB/s]


sub-08/func .. bold.nii.gz:  96%|█████████▋| 27.6M/28.6M [00:01&lt;00:00, 14.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/anat .. _T1w.nii.gz:  39%|███▉      | 4.14M/10.6M [00:00&lt;00:01, 6.08MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  11%|███▋                            | 70.4M/618M [00:02&lt;00:19, 27.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/anat .. _T1w.nii.gz:  53%|█████▎    | 5.59M/10.6M [00:00&lt;00:00, 7.36MB/s]



sub-08/func .. bold.nii.gz: 100%|██████████| 28.6M/28.6M [00:01&lt;00:00, 14.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  12%|███▉                            | 75.1M/618M [00:02&lt;00:22, 24.3MB/s]




sub-01/anat .. _T1w.nii.gz:  69%|██████▉   | 7.29M/10.6M [00:00&lt;00:00, 7.62MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/anat .. _T1w.nii.gz:  79%|███████▉  | 8.40M/10.6M [00:00&lt;00:00, 8.41MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/anat .. _T1w.nii.gz:  99%|█████████▉| 10.5M/10.6M [00:00&lt;00:00, 10.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:   0%|                   | 0.00/29.2M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:   0%|                   | 0.00/29.2M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:   0%|           | 137k/29.2M [00:00&lt;00:24, 1.17MB/s]
Total:  13%|████▏                           | 79.8M/618M [00:03&lt;00:32, 16.6MB/s]





sub-09/func .. bold.nii.gz:   4%|▍         | 1.23M/29.2M [00:00&lt;00:04, 6.16MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:   3%|▎          | 990k/29.2M [00:00&lt;00:17, 1.57MB/s]







sub-09/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.8M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  14%|████▎                           | 84.3M/618M [00:03&lt;00:28, 18.7MB/s]






sub-09/func .. bold.nii.gz:   9%|▉         | 2.68M/29.2M [00:00&lt;00:12, 2.16MB/s]





sub-09/func .. bold.nii.gz:  18%|█▊        | 5.28M/29.2M [00:00&lt;00:03, 7.78MB/s]







sub-09/anat .. _T1w.nii.gz:   1%|▏          | 138k/10.8M [00:00&lt;00:09, 1.17MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  14%|████▌                           | 88.8M/618M [00:03&lt;00:23, 22.4MB/s]






sub-09/func .. bold.nii.gz:  15%|█▌        | 4.49M/29.2M [00:00&lt;00:08, 2.93MB/s]





sub-09/func .. bold.nii.gz:  23%|██▎       | 6.84M/29.2M [00:00&lt;00:02, 9.15MB/s]







sub-09/anat .. _T1w.nii.gz:   8%|▊          | 835k/10.8M [00:00&lt;00:06, 1.56MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  15%|████▊                           | 93.6M/618M [00:03&lt;00:20, 26.0MB/s]






sub-09/func .. bold.nii.gz:  22%|██▏       | 6.49M/29.2M [00:00&lt;00:05, 3.90MB/s]





sub-09/func .. bold.nii.gz:  28%|██▊       | 8.25M/29.2M [00:00&lt;00:02, 10.2MB/s]







sub-09/anat .. _T1w.nii.gz:  21%|██        | 2.26M/10.8M [00:00&lt;00:04, 2.13MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  16%|█████                           | 97.8M/618M [00:03&lt;00:18, 28.6MB/s]





sub-09/func .. bold.nii.gz:  32%|███▏      | 9.38M/29.2M [00:00&lt;00:01, 10.4MB/s]







sub-09/anat .. _T1w.nii.gz:  33%|███▎      | 3.57M/10.8M [00:00&lt;00:02, 2.83MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:  32%|███▏      | 9.28M/29.2M [00:00&lt;00:03, 5.02MB/s]
Total:  17%|█████▌                           | 103M/618M [00:03&lt;00:15, 33.6MB/s]







sub-09/anat .. _T1w.nii.gz:  44%|████▍     | 4.76M/10.8M [00:00&lt;00:01, 3.68MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:  37%|███▋      | 10.7M/29.2M [00:00&lt;00:02, 6.20MB/s]







sub-09/anat .. _T1w.nii.gz:  55%|█████▍    | 5.93M/10.8M [00:00&lt;00:01, 4.62MB/s]
Total:  17%|█████▊                           | 108M/618M [00:03&lt;00:14, 35.4MB/s]





sub-09/func .. bold.nii.gz:  43%|████▎     | 12.7M/29.2M [00:00&lt;00:01, 11.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:  42%|████▏     | 12.2M/29.2M [00:00&lt;00:02, 7.46MB/s]







sub-09/anat .. _T1w.nii.gz:  70%|██████▉   | 7.50M/10.8M [00:00&lt;00:00, 5.85MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  18%|██████                           | 114M/618M [00:04&lt;00:14, 35.2MB/s]





sub-09/func .. bold.nii.gz:  53%|█████▎    | 15.5M/29.2M [00:01&lt;00:01, 12.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/anat .. _T1w.nii.gz:  81%|████████▏ | 8.76M/10.8M [00:00&lt;00:00, 6.94MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total:  19%|██████▎                          | 118M/618M [00:04&lt;00:13, 37.0MB/s]






sub-09/func .. bold.nii.gz:  52%|█████▏    | 15.1M/29.2M [00:01&lt;00:01, 8.72MB/s]







sub-09/anat .. _T1w.nii.gz:  94%|█████████▍| 10.1M/10.8M [00:00&lt;00:00, 8.11MB/s]





sub-09/func .. bold.nii.gz:  59%|█████▉    | 17.3M/29.2M [00:01&lt;00:00, 12.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (1 ok out of 27):  20%|███▏            | 122M/618M [00:04&lt;00:13, 37.0MB/s]

                                                                                
Total (2 ok out of 27):  20%|███▏            | 122M/618M [00:04&lt;00:13, 37.0MB/s]

                                                                                
Total (3 ok out of 27):  20%|███▏            | 122M/618M [00:04&lt;00:13, 37.0MB/s]


                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (3 ok out of 27):  20%|███▏            | 123M/618M [00:04&lt;00:12, 39.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:  62%|██████▏   | 18.1M/29.2M [00:01&lt;00:01, 9.95MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (3 ok out of 27):  21%|███▎            | 128M/618M [00:04&lt;00:12, 39.3MB/s]


sub-09/func .. bold.nii.gz:  70%|██████▉   | 20.4M/29.2M [00:01&lt;00:00, 13.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:  76%|███████▌  | 22.1M/29.2M [00:01&lt;00:00, 12.2MB/s]
Total (3 ok out of 27):  21%|███▍            | 132M/618M [00:04&lt;00:14, 32.9MB/s]



sub-09/func .. bold.nii.gz:  71%|███████   | 20.6M/29.2M [00:01&lt;00:00, 10.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:  78%|███████▊  | 22.8M/29.2M [00:01&lt;00:00, 12.4MB/s]
Total (3 ok out of 27):  22%|███▌            | 137M/618M [00:04&lt;00:14, 34.3MB/s]


sub-09/func .. bold.nii.gz:  85%|████████▍ | 24.7M/29.2M [00:01&lt;00:00, 13.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:  85%|████████▌ | 24.9M/29.2M [00:01&lt;00:00, 14.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:   0%|                   | 0.00/28.1M [00:00&lt;?, ?B/s]
Total (3 ok out of 27):  23%|███▋            | 141M/618M [00:04&lt;00:13, 36.6MB/s]


sub-09/func .. bold.nii.gz:  92%|█████████▏| 26.9M/29.2M [00:01&lt;00:00, 15.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz:  92%|█████████▏| 27.0M/29.2M [00:01&lt;00:00, 15.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (3 ok out of 27):  23%|███▊            | 145M/618M [00:04&lt;00:12, 37.8MB/s]


sub-09/func .. bold.nii.gz:  99%|█████████▉| 29.0M/29.2M [00:01&lt;00:00, 16.7MB/s]





sub-01/func .. bold.nii.gz:   0%|           | 137k/28.1M [00:00&lt;00:24, 1.13MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-09/func .. bold.nii.gz: 100%|██████████| 29.2M/29.2M [00:01&lt;00:00, 16.4MB/s]
Total (4 ok out of 27):  24%|███▊            | 148M/618M [00:04&lt;00:12, 37.8MB/s]

                                                                                




sub-01/func .. bold.nii.gz:   2%|▎          | 676k/28.1M [00:00&lt;00:18, 1.48MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.7M [00:00&lt;?, ?B/s]
Total (4 ok out of 27):  24%|███▊            | 149M/618M [00:05&lt;00:15, 29.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:   0%|                   | 0.00/28.8M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  11%|█         | 3.15M/28.1M [00:00&lt;00:12, 2.01MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  25%|███▉            | 153M/618M [00:05&lt;00:15, 30.0MB/s]






sub-03/func .. bold.nii.gz:   4%|▍         | 1.16M/28.8M [00:00&lt;00:02, 11.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/anat .. _T1w.nii.gz:  27%|██▋       | 2.87M/10.7M [00:00&lt;00:00, 14.3MB/s]




sub-01/func .. bold.nii.gz:  17%|█▋        | 4.64M/28.1M [00:00&lt;00:08, 2.70MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  26%|████            | 158M/618M [00:05&lt;00:13, 33.0MB/s]






sub-03/func .. bold.nii.gz:   9%|▉         | 2.67M/28.8M [00:00&lt;00:02, 12.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/anat .. _T1w.nii.gz:  43%|████▎     | 4.57M/10.7M [00:00&lt;00:00, 15.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  26%|████▏           | 162M/618M [00:05&lt;00:12, 35.5MB/s]






sub-03/func .. bold.nii.gz:  14%|█▎        | 3.92M/28.8M [00:00&lt;00:02, 12.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  28%|██▊       | 7.80M/28.1M [00:00&lt;00:05, 3.60MB/s]





sub-03/anat .. _T1w.nii.gz:  55%|█████▍    | 5.85M/10.7M [00:00&lt;00:00, 14.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  27%|████▎           | 167M/618M [00:05&lt;00:12, 37.0MB/s]






sub-03/func .. bold.nii.gz:  18%|█▊        | 5.23M/28.8M [00:00&lt;00:01, 12.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  33%|███▎      | 9.31M/28.1M [00:00&lt;00:04, 4.66MB/s]





sub-03/anat .. _T1w.nii.gz:  68%|██████▊   | 7.29M/10.7M [00:00&lt;00:00, 14.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  28%|████▍           | 173M/618M [00:05&lt;00:12, 36.9MB/s]




sub-01/func .. bold.nii.gz:  40%|████      | 11.3M/28.1M [00:00&lt;00:02, 6.04MB/s]





sub-03/anat .. _T1w.nii.gz:  81%|████████  | 8.69M/10.7M [00:00&lt;00:00, 13.9MB/s]






sub-03/func .. bold.nii.gz:  26%|██▌       | 7.44M/28.8M [00:00&lt;00:01, 12.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  29%|████▌           | 178M/618M [00:05&lt;00:10, 40.8MB/s]




sub-01/func .. bold.nii.gz:  45%|████▌     | 12.7M/28.1M [00:01&lt;00:02, 7.23MB/s]





sub-03/anat .. _T1w.nii.gz: 100%|██████████| 10.7M/10.7M [00:00&lt;00:00, 14.9MB/s]






sub-03/func .. bold.nii.gz:  31%|███       | 8.88M/28.8M [00:00&lt;00:01, 12.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  51%|█████     | 14.3M/28.1M [00:01&lt;00:01, 8.63MB/s]
Total (4 ok out of 27):  30%|████▋           | 183M/618M [00:05&lt;00:10, 40.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:   0%|                   | 0.00/28.8M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  41%|████      | 11.7M/28.8M [00:00&lt;00:01, 13.6MB/s]




sub-01/func .. bold.nii.gz:  56%|█████▋    | 15.8M/28.1M [00:01&lt;00:01, 9.85MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  30%|████▊           | 188M/618M [00:06&lt;00:10, 39.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  62%|██████▏   | 17.5M/28.1M [00:01&lt;00:00, 11.2MB/s]






sub-03/func .. bold.nii.gz:  47%|████▋     | 13.6M/28.8M [00:01&lt;00:01, 13.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  31%|████▉           | 193M/618M [00:06&lt;00:10, 40.1MB/s]







sub-03/func .. bold.nii.gz:  11%|█         | 3.19M/28.8M [00:00&lt;00:01, 15.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  32%|█████           | 197M/618M [00:06&lt;00:10, 39.2MB/s]







sub-03/func .. bold.nii.gz:  17%|█▋        | 4.87M/28.8M [00:00&lt;00:01, 15.6MB/s]




sub-01/func .. bold.nii.gz:  71%|███████   | 19.8M/28.1M [00:01&lt;00:00, 11.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  57%|█████▋    | 16.3M/28.8M [00:01&lt;00:00, 13.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  33%|█████▏          | 202M/618M [00:06&lt;00:10, 39.9MB/s]




sub-01/func .. bold.nii.gz:  77%|███████▋  | 21.7M/28.1M [00:01&lt;00:00, 12.6MB/s]






sub-03/func .. bold.nii.gz:  61%|██████▏   | 17.7M/28.8M [00:01&lt;00:00, 13.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  25%|██▌       | 7.28M/28.8M [00:00&lt;00:01, 14.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  34%|█████▍          | 208M/618M [00:06&lt;00:10, 40.6MB/s]






sub-03/func .. bold.nii.gz:  67%|██████▋   | 19.1M/28.8M [00:01&lt;00:00, 13.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  31%|███       | 8.97M/28.8M [00:00&lt;00:01, 14.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  89%|████████▊ | 24.8M/28.1M [00:01&lt;00:00, 13.3MB/s]
Total (4 ok out of 27):  34%|█████▌          | 213M/618M [00:06&lt;00:09, 42.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  76%|███████▌  | 21.8M/28.8M [00:01&lt;00:00, 13.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (4 ok out of 27):  35%|█████▋          | 218M/618M [00:06&lt;00:09, 41.4MB/s]







sub-03/func .. bold.nii.gz:  41%|████      | 11.8M/28.8M [00:00&lt;00:01, 14.4MB/s]




sub-01/func .. bold.nii.gz:  97%|█████████▋| 27.3M/28.1M [00:02&lt;00:00, 13.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  81%|████████▏ | 23.4M/28.8M [00:01&lt;00:00, 14.1MB/s]
Total (5 ok out of 27):  36%|█████▋          | 222M/618M [00:06&lt;00:09, 41.4MB/s]

                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (5 ok out of 27):  36%|█████▊          | 223M/618M [00:06&lt;00:09, 42.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  49%|████▉     | 14.2M/28.8M [00:01&lt;00:01, 13.7MB/s]





sub-03/func .. bold.nii.gz:  88%|████████▊ | 25.4M/28.8M [00:01&lt;00:00, 13.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (5 ok out of 27):  37%|█████▉          | 228M/618M [00:07&lt;00:11, 34.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  95%|█████████▍| 27.2M/28.8M [00:02&lt;00:00, 13.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  58%|█████▊    | 16.7M/28.8M [00:01&lt;00:00, 13.3MB/s]
Total (5 ok out of 27):  38%|██████          | 232M/618M [00:07&lt;00:11, 34.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (6 ok out of 27):  38%|██████          | 232M/618M [00:07&lt;00:11, 34.2MB/s]


                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  64%|██████▎   | 18.3M/28.8M [00:01&lt;00:00, 13.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:   0%|                   | 0.00/28.1M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (6 ok out of 27):  38%|██████          | 236M/618M [00:07&lt;00:12, 29.6MB/s]





sub-03/func .. bold.nii.gz:  72%|███████▏  | 20.6M/28.8M [00:01&lt;00:00, 15.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.7M [00:00&lt;?, ?B/s]






sub-01/func .. bold.nii.gz:   1%|           | 189k/28.1M [00:00&lt;00:14, 1.88MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  80%|███████▉  | 22.9M/28.8M [00:01&lt;00:00, 17.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (6 ok out of 27):  39%|██████▏         | 240M/618M [00:07&lt;00:13, 27.9MB/s]







sub-02/anat .. _T1w.nii.gz:  15%|█▍        | 1.57M/10.7M [00:00&lt;00:00, 15.2MB/s]






sub-01/func .. bold.nii.gz:   3%|▎          | 920k/28.1M [00:00&lt;00:11, 2.42MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (6 ok out of 27):  40%|██████▎         | 245M/618M [00:07&lt;00:11, 31.5MB/s]






sub-01/func .. bold.nii.gz:   7%|▋         | 2.10M/28.1M [00:00&lt;00:08, 3.17MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz:  91%|█████████ | 26.2M/28.8M [00:01&lt;00:00, 16.8MB/s]







sub-02/anat .. _T1w.nii.gz:  39%|███▉      | 4.16M/10.7M [00:00&lt;00:00, 14.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (6 ok out of 27):  41%|██████▍         | 250M/618M [00:07&lt;00:10, 33.9MB/s]





sub-03/func .. bold.nii.gz:  98%|█████████▊| 28.2M/28.8M [00:01&lt;00:00, 16.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/anat .. _T1w.nii.gz:  52%|█████▏    | 5.56M/10.7M [00:00&lt;00:00, 13.8MB/s]






sub-01/func .. bold.nii.gz:  16%|█▋        | 4.64M/28.1M [00:00&lt;00:05, 4.09MB/s]
Total (7 ok out of 27):  41%|██████▌         | 254M/618M [00:07&lt;00:10, 33.9MB/s]

                                                                                
Total (8 ok out of 27):  41%|██████▌         | 254M/618M [00:07&lt;00:10, 33.9MB/s]


                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (8 ok out of 27):  41%|██████▌         | 255M/618M [00:07&lt;00:10, 34.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  21%|██        | 5.90M/28.1M [00:00&lt;00:04, 5.13MB/s]





sub-02/anat .. _T1w.nii.gz:  66%|██████▌   | 7.05M/10.7M [00:00&lt;00:00, 14.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:   0%|                   | 0.00/29.2M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  26%|██▌       | 7.23M/28.1M [00:00&lt;00:03, 6.18MB/s]
Total (8 ok out of 27):  42%|██████▋         | 259M/618M [00:08&lt;00:10, 33.2MB/s]





sub-02/anat .. _T1w.nii.gz:  76%|███████▋  | 8.20M/10.7M [00:00&lt;00:00, 12.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:   5%|▍         | 1.34M/29.2M [00:00&lt;00:02, 12.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/anat .. _T1w.nii.gz:  91%|█████████ | 9.76M/10.7M [00:00&lt;00:00, 13.3MB/s]
Total (8 ok out of 27):  43%|██████▊         | 264M/618M [00:08&lt;00:10, 34.6MB/s]




sub-01/func .. bold.nii.gz:  30%|███       | 8.47M/28.1M [00:00&lt;00:02, 7.16MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (8 ok out of 27):  43%|██████▉         | 269M/618M [00:08&lt;00:09, 35.7MB/s]






sub-02/func .. bold.nii.gz:  16%|█▌        | 4.53M/29.2M [00:00&lt;00:01, 13.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  42%|████▏     | 11.7M/28.1M [00:01&lt;00:01, 8.59MB/s]







sub-05/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.8M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (8 ok out of 27):  44%|███████         | 273M/618M [00:08&lt;00:09, 37.2MB/s]






sub-02/func .. bold.nii.gz:  23%|██▎       | 6.58M/29.2M [00:00&lt;00:01, 14.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/anat .. _T1w.nii.gz:   9%|▉          | 925k/10.8M [00:00&lt;00:01, 8.31MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (8 ok out of 27):  45%|███████▏        | 278M/618M [00:08&lt;00:08, 39.4MB/s]






sub-02/func .. bold.nii.gz:  29%|██▊       | 8.35M/29.2M [00:00&lt;00:01, 15.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  54%|█████▍    | 15.1M/28.1M [00:01&lt;00:01, 10.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (8 ok out of 27):  46%|███████▎        | 282M/618M [00:08&lt;00:08, 41.3MB/s]






sub-02/func .. bold.nii.gz:  34%|███▍      | 9.94M/29.2M [00:00&lt;00:01, 15.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  59%|█████▊    | 16.5M/28.1M [00:01&lt;00:01, 10.9MB/s]







sub-05/anat .. _T1w.nii.gz:  33%|███▎      | 3.51M/10.8M [00:00&lt;00:00, 9.30MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  39%|███▉      | 11.4M/29.2M [00:00&lt;00:01, 15.1MB/s]
Total (8 ok out of 27):  46%|███████▍        | 287M/618M [00:08&lt;00:08, 39.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  64%|██████▎   | 17.9M/28.1M [00:01&lt;00:00, 11.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  44%|████▍     | 12.9M/29.2M [00:00&lt;00:01, 14.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (8 ok out of 27):  47%|███████▌        | 292M/618M [00:08&lt;00:08, 38.2MB/s]







sub-05/anat .. _T1w.nii.gz:  64%|██████▎   | 6.83M/10.8M [00:00&lt;00:00, 10.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  49%|████▉     | 14.4M/29.2M [00:00&lt;00:00, 15.0MB/s]




sub-01/func .. bold.nii.gz:  70%|██████▉   | 19.6M/28.1M [00:01&lt;00:00, 11.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (8 ok out of 27):  48%|███████▋        | 297M/618M [00:09&lt;00:07, 41.5MB/s]







sub-05/anat .. _T1w.nii.gz:  81%|████████  | 8.70M/10.8M [00:00&lt;00:00, 12.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/anat .. _T1w.nii.gz:  95%|█████████▌| 10.2M/10.8M [00:00&lt;00:00, 13.1MB/s]
Total (8 ok out of 27):  49%|███████▊        | 303M/618M [00:09&lt;00:07, 43.9MB/s]




sub-01/func .. bold.nii.gz:  80%|███████▉  | 22.4M/28.1M [00:01&lt;00:00, 12.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  57%|█████▋    | 16.8M/29.2M [00:01&lt;00:00, 13.4MB/s]
Total (9 ok out of 27):  49%|███████▉        | 305M/618M [00:09&lt;00:07, 43.9MB/s]

                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  85%|████████▌ | 24.0M/28.1M [00:01&lt;00:00, 13.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (9 ok out of 27):  50%|███████▉        | 308M/618M [00:09&lt;00:07, 40.7MB/s]





sub-02/func .. bold.nii.gz:  63%|██████▎   | 18.5M/29.2M [00:01&lt;00:00, 14.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz:  93%|█████████▎| 26.1M/28.1M [00:01&lt;00:00, 15.1MB/s]







sub-05/func .. bold.nii.gz:   0%|                   | 0.00/29.7M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  70%|███████   | 20.5M/29.2M [00:01&lt;00:00, 15.7MB/s]
Total (9 ok out of 27):  51%|████████        | 313M/618M [00:09&lt;00:08, 37.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-01/func .. bold.nii.gz: 100%|██████████| 28.1M/28.1M [00:02&lt;00:00, 13.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (9 ok out of 27):  52%|████████▏       | 318M/618M [00:09&lt;00:07, 41.0MB/s]







sub-05/func .. bold.nii.gz:  10%|█         | 2.99M/29.7M [00:00&lt;00:01, 14.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  80%|███████▉  | 23.3M/29.2M [00:01&lt;00:00, 15.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  15%|█▌        | 4.56M/29.7M [00:00&lt;00:01, 15.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:   0%|                   | 0.00/29.2M [00:00&lt;?, ?B/s]
Total (9 ok out of 27):  52%|████████▍       | 324M/618M [00:09&lt;00:07, 38.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  89%|████████▉ | 26.0M/29.2M [00:01&lt;00:00, 14.4MB/s]








sub-02/func .. bold.nii.gz:   4%|▍         | 1.28M/29.2M [00:00&lt;00:02, 12.7MB/s]
Total (9 ok out of 27):  53%|████████▌       | 329M/618M [00:09&lt;00:07, 36.7MB/s]







sub-05/func .. bold.nii.gz:  26%|██▌       | 7.76M/29.7M [00:00&lt;00:01, 15.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  11%|█         | 3.10M/29.2M [00:00&lt;00:01, 13.8MB/s]





sub-02/func .. bold.nii.gz:  95%|█████████▌| 27.7M/29.2M [00:01&lt;00:00, 14.0MB/s]
Total (9 ok out of 27):  54%|████████▋       | 333M/618M [00:09&lt;00:07, 39.7MB/s]







sub-05/func .. bold.nii.gz:  31%|███       | 9.07M/29.7M [00:00&lt;00:01, 14.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  16%|█▌        | 4.70M/29.2M [00:00&lt;00:01, 14.3MB/s]





sub-02/func .. bold.nii.gz: 100%|██████████| 29.2M/29.2M [00:01&lt;00:00, 13.7MB/s]
Total (9 ok out of 27):  55%|████████▋       | 338M/618M [00:10&lt;00:06, 41.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  55%|████████▏      | 338M/618M [00:10&lt;00:06, 41.2MB/s]






                                                                                







sub-02/func .. bold.nii.gz:  21%|██        | 6.09M/29.2M [00:00&lt;00:01, 14.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  38%|███▊      | 11.3M/29.7M [00:00&lt;00:01, 13.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:   0%|                   | 0.00/29.7M [00:00&lt;?, ?B/s]







sub-02/func .. bold.nii.gz:  26%|██▌       | 7.45M/29.2M [00:00&lt;00:01, 14.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  55%|████████▎      | 342M/618M [00:10&lt;00:08, 32.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:   4%|▎         | 1.05M/29.7M [00:00&lt;00:03, 9.23MB/s]






sub-05/func .. bold.nii.gz:  44%|████▍     | 13.2M/29.7M [00:01&lt;00:01, 11.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  56%|████████▍      | 347M/618M [00:10&lt;00:09, 29.6MB/s]







sub-02/func .. bold.nii.gz:  33%|███▎      | 9.68M/29.2M [00:00&lt;00:01, 12.5MB/s]








sub-05/func .. bold.nii.gz:   7%|▋         | 2.07M/29.7M [00:00&lt;00:02, 9.31MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  57%|████████▌      | 350M/618M [00:10&lt;00:08, 30.5MB/s]








sub-05/func .. bold.nii.gz:  10%|█         | 3.01M/29.7M [00:00&lt;00:02, 8.99MB/s]






sub-05/func .. bold.nii.gz:  50%|█████     | 14.9M/29.7M [00:01&lt;00:01, 10.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  39%|███▉      | 11.4M/29.2M [00:00&lt;00:01, 11.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  13%|█▎        | 3.73M/29.7M [00:00&lt;00:03, 8.08MB/s]
Total (10 ok out of 27):  57%|████████▌      | 354M/618M [00:10&lt;00:08, 29.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  55%|█████▍    | 16.2M/29.7M [00:01&lt;00:01, 10.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  58%|████████▋      | 357M/618M [00:10&lt;00:09, 26.6MB/s]







sub-02/func .. bold.nii.gz:  45%|████▌     | 13.2M/29.2M [00:01&lt;00:01, 10.3MB/s]








sub-05/func .. bold.nii.gz:  19%|█▊        | 5.51M/29.7M [00:00&lt;00:02, 8.52MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  62%|██████▏   | 18.3M/29.7M [00:01&lt;00:01, 10.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  58%|████████▊      | 361M/618M [00:10&lt;00:09, 27.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  21%|██▏       | 6.32M/29.7M [00:00&lt;00:02, 8.00MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  51%|█████▏    | 15.0M/29.2M [00:01&lt;00:01, 9.80MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  59%|████████▊      | 365M/618M [00:11&lt;00:08, 28.6MB/s]








sub-05/func .. bold.nii.gz:  26%|██▌       | 7.58M/29.7M [00:00&lt;00:02, 8.73MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  68%|██████▊   | 20.2M/29.7M [00:01&lt;00:00, 9.92MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  60%|████████▉      | 369M/618M [00:11&lt;00:08, 28.2MB/s]






sub-05/func .. bold.nii.gz:  72%|███████▏  | 21.4M/29.7M [00:01&lt;00:00, 9.77MB/s]







sub-02/func .. bold.nii.gz:  58%|█████▊    | 17.0M/29.2M [00:01&lt;00:01, 9.80MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  33%|███▎      | 9.77M/29.7M [00:01&lt;00:02, 9.28MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  60%|█████████      | 372M/618M [00:11&lt;00:08, 28.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  37%|███▋      | 10.9M/29.7M [00:01&lt;00:01, 9.63MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  61%|█████████      | 375M/618M [00:11&lt;00:08, 28.3MB/s]






sub-05/func .. bold.nii.gz:  79%|███████▊  | 23.3M/29.7M [00:02&lt;00:00, 9.78MB/s]







sub-02/func .. bold.nii.gz:  65%|██████▌   | 19.0M/29.2M [00:01&lt;00:01, 9.69MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  40%|████      | 11.9M/29.7M [00:01&lt;00:01, 9.38MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  61%|█████████▏     | 378M/618M [00:11&lt;00:08, 29.3MB/s]






sub-05/func .. bold.nii.gz:  82%|████████▏ | 24.5M/29.7M [00:02&lt;00:00, 10.0MB/s]







sub-02/func .. bold.nii.gz:  69%|██████▊   | 20.0M/29.2M [00:01&lt;00:00, 9.69MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  44%|████▍     | 13.0M/29.7M [00:01&lt;00:01, 9.53MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  62%|█████████▎     | 382M/618M [00:11&lt;00:07, 30.7MB/s]






sub-05/func .. bold.nii.gz:  87%|████████▋ | 25.9M/29.7M [00:02&lt;00:00, 11.0MB/s]







sub-02/func .. bold.nii.gz:  72%|███████▏  | 21.0M/29.2M [00:01&lt;00:00, 9.63MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  48%|████▊     | 14.1M/29.7M [00:01&lt;00:01, 8.93MB/s]
Total (10 ok out of 27):  62%|█████████▎     | 385M/618M [00:11&lt;00:07, 30.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  93%|█████████▎| 27.6M/29.7M [00:02&lt;00:00, 10.1MB/s]







sub-02/func .. bold.nii.gz:  78%|███████▊  | 22.6M/29.2M [00:02&lt;00:00, 9.22MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (10 ok out of 27):  63%|█████████▍     | 389M/618M [00:11&lt;00:08, 25.6MB/s]








sub-05/func .. bold.nii.gz:  54%|█████▍    | 16.0M/29.7M [00:01&lt;00:01, 8.80MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-05/func .. bold.nii.gz:  99%|█████████▊| 29.3M/29.7M [00:02&lt;00:00, 9.54MB/s]
Total (10 ok out of 27):  63%|█████████▌     | 392M/618M [00:12&lt;00:08, 26.8MB/s]







sub-02/func .. bold.nii.gz:  83%|████████▎ | 24.3M/29.2M [00:02&lt;00:00, 8.89MB/s]








sub-05/func .. bold.nii.gz:  58%|█████▊    | 17.2M/29.7M [00:01&lt;00:01, 9.69MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-03/func .. bold.nii.gz: 100%|███████████| 28.8M/28.8M [00:06&lt;00:00, 997kB/s]
Total (11 ok out of 27):  64%|█████████▌     | 394M/618M [00:12&lt;00:08, 26.8MB/s]

                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (11 ok out of 27):  64%|█████████▌     | 396M/618M [00:12&lt;00:08, 27.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:   0%|                   | 0.00/29.4M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-02/func .. bold.nii.gz:  88%|████████▊ | 25.7M/29.2M [00:02&lt;00:00, 8.17MB/s]







sub-05/func .. bold.nii.gz:  64%|██████▍   | 19.0M/29.7M [00:02&lt;00:01, 9.13MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (11 ok out of 27):  65%|█████████▋     | 399M/618M [00:12&lt;00:09, 23.2MB/s]






sub-02/func .. bold.nii.gz:  91%|█████████▏| 26.7M/29.2M [00:02&lt;00:00, 8.41MB/s]







sub-05/func .. bold.nii.gz:  68%|██████▊   | 20.2M/29.7M [00:02&lt;00:00, 9.92MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:   6%|▌         | 1.81M/29.4M [00:00&lt;00:03, 8.65MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (11 ok out of 27):  65%|█████████▊     | 402M/618M [00:12&lt;00:08, 25.2MB/s]






sub-02/func .. bold.nii.gz:  95%|█████████▌| 27.8M/29.2M [00:02&lt;00:00, 9.05MB/s]







sub-05/func .. bold.nii.gz:  72%|███████▏  | 21.4M/29.7M [00:02&lt;00:00, 10.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (11 ok out of 27):  66%|█████████▊     | 405M/618M [00:12&lt;00:08, 26.4MB/s]







sub-05/func .. bold.nii.gz:  76%|███████▌  | 22.5M/29.7M [00:02&lt;00:00, 10.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  13%|█▎        | 3.87M/29.4M [00:00&lt;00:02, 9.34MB/s]






sub-02/func .. bold.nii.gz: 100%|██████████| 29.2M/29.2M [00:02&lt;00:00, 8.98MB/s]
Total (12 ok out of 27):  66%|█████████▉     | 409M/618M [00:12&lt;00:07, 26.4MB/s]



                                                                                
Total (13 ok out of 27):  66%|█████████▉     | 409M/618M [00:12&lt;00:07, 26.4MB/s]



                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  66%|█████████▉     | 409M/618M [00:12&lt;00:07, 27.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  17%|█▋        | 4.89M/29.4M [00:00&lt;00:02, 8.87MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:   0%|                   | 0.00/29.4M [00:00&lt;?, ?B/s]





sub-05/func .. bold.nii.gz:  80%|████████  | 23.8M/29.7M [00:02&lt;00:00, 8.44MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:   2%|▏          | 564k/29.4M [00:00&lt;00:06, 4.13MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  67%|██████████     | 412M/618M [00:13&lt;00:11, 17.4MB/s]







sub-06/func .. bold.nii.gz:   3%|▎          | 791k/29.4M [00:00&lt;00:09, 3.08MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  20%|██        | 5.97M/29.4M [00:00&lt;00:04, 5.21MB/s]





sub-05/func .. bold.nii.gz:  83%|████████▎ | 24.8M/29.7M [00:02&lt;00:00, 5.33MB/s]







sub-06/func .. bold.nii.gz:   4%|▍         | 1.18M/29.4M [00:00&lt;00:08, 3.15MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  67%|██████████     | 415M/618M [00:13&lt;00:13, 15.3MB/s]






sub-06/func .. bold.nii.gz:  24%|██▍       | 7.17M/29.4M [00:01&lt;00:03, 6.27MB/s]





sub-05/func .. bold.nii.gz:  87%|████████▋ | 25.9M/29.7M [00:03&lt;00:00, 6.31MB/s]







sub-06/func .. bold.nii.gz:   7%|▋         | 2.04M/29.4M [00:00&lt;00:07, 3.87MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  68%|██████████▏    | 419M/618M [00:13&lt;00:10, 19.0MB/s]






sub-06/func .. bold.nii.gz:  28%|██▊       | 8.36M/29.4M [00:01&lt;00:02, 7.22MB/s]







sub-06/func .. bold.nii.gz:  12%|█▏        | 3.40M/29.4M [00:00&lt;00:05, 4.88MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  68%|██████████▎    | 423M/618M [00:13&lt;00:09, 21.5MB/s]





sub-05/func .. bold.nii.gz:  99%|█████████▊| 29.2M/29.7M [00:03&lt;00:00, 7.72MB/s]







sub-06/func .. bold.nii.gz:  16%|█▌        | 4.72M/29.4M [00:00&lt;00:04, 6.02MB/s]






sub-06/func .. bold.nii.gz:  32%|███▏      | 9.39M/29.4M [00:01&lt;00:02, 7.76MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  69%|██████████▎    | 427M/618M [00:13&lt;00:07, 24.7MB/s]






sub-06/func .. bold.nii.gz:  37%|███▋      | 10.7M/29.4M [00:01&lt;00:02, 8.87MB/s]







sub-06/func .. bold.nii.gz:  21%|██        | 6.18M/29.4M [00:00&lt;00:03, 7.29MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.6M [00:00&lt;?, ?B/s]
Total (13 ok out of 27):  70%|██████████▍    | 431M/618M [00:13&lt;00:06, 27.7MB/s]






sub-06/func .. bold.nii.gz:  41%|████▏     | 12.2M/29.4M [00:01&lt;00:01, 10.0MB/s]







sub-06/func .. bold.nii.gz:  25%|██▌       | 7.36M/29.4M [00:00&lt;00:02, 8.04MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  47%|████▋     | 13.9M/29.4M [00:01&lt;00:01, 11.3MB/s]
Total (13 ok out of 27):  70%|██████████▌    | 435M/618M [00:13&lt;00:05, 30.7MB/s]







sub-06/func .. bold.nii.gz:  30%|███       | 8.90M/29.4M [00:00&lt;00:02, 9.38MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/anat .. _T1w.nii.gz:  26%|██▌       | 2.72M/10.6M [00:00&lt;00:00, 13.6MB/s]






sub-06/func .. bold.nii.gz:  53%|█████▎    | 15.7M/29.4M [00:01&lt;00:01, 12.6MB/s]
Total (13 ok out of 27):  71%|██████████▋    | 440M/618M [00:13&lt;00:05, 33.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/anat .. _T1w.nii.gz:  38%|███▊      | 4.05M/10.6M [00:00&lt;00:00, 13.5MB/s]






sub-06/func .. bold.nii.gz:  59%|█████▊    | 17.2M/29.4M [00:01&lt;00:00, 13.4MB/s]
Total (13 ok out of 27):  72%|██████████▊    | 444M/618M [00:13&lt;00:04, 35.7MB/s]







sub-06/func .. bold.nii.gz:  39%|███▉      | 11.5M/29.4M [00:01&lt;00:01, 10.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/anat .. _T1w.nii.gz:  51%|█████     | 5.39M/10.6M [00:00&lt;00:00, 13.3MB/s]






sub-06/func .. bold.nii.gz:  64%|██████▎   | 18.7M/29.4M [00:01&lt;00:00, 13.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  73%|██████████▉    | 449M/618M [00:14&lt;00:04, 34.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  47%|████▋     | 13.7M/29.4M [00:01&lt;00:01, 10.8MB/s]








sub-06/anat .. _T1w.nii.gz:  62%|██████▏   | 6.64M/10.6M [00:00&lt;00:00, 13.0MB/s]






sub-06/func .. bold.nii.gz:  69%|██████▉   | 20.2M/29.4M [00:01&lt;00:00, 14.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  73%|███████████    | 454M/618M [00:14&lt;00:04, 35.2MB/s]








sub-06/anat .. _T1w.nii.gz:  79%|███████▊  | 8.36M/10.6M [00:00&lt;00:00, 14.0MB/s]







sub-06/func .. bold.nii.gz:  53%|█████▎    | 15.6M/29.4M [00:01&lt;00:01, 11.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (13 ok out of 27):  74%|███████████    | 458M/618M [00:14&lt;00:04, 36.5MB/s]








sub-06/anat .. _T1w.nii.gz:  91%|█████████ | 9.63M/10.6M [00:00&lt;00:00, 13.5MB/s]






sub-06/func .. bold.nii.gz:  78%|███████▊  | 23.0M/29.4M [00:02&lt;00:00, 13.8MB/s]







sub-06/func .. bold.nii.gz:  58%|█████▊    | 17.0M/29.4M [00:01&lt;00:00, 12.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (14 ok out of 27):  75%|███████████▏   | 462M/618M [00:14&lt;00:04, 36.5MB/s]





                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (15 ok out of 27):  75%|███████████▏   | 462M/618M [00:14&lt;00:04, 36.5MB/s]


                                                                                
Total (15 ok out of 27):  75%|███████████▏   | 463M/618M [00:14&lt;00:03, 39.8MB/s]





sub-06/func .. bold.nii.gz:  63%|██████▎   | 18.6M/29.4M [00:01&lt;00:00, 13.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  87%|████████▋ | 25.6M/29.4M [00:02&lt;00:00, 13.8MB/s]
Total (15 ok out of 27):  76%|███████████▎   | 467M/618M [00:14&lt;00:03, 39.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  73%|███████▎  | 21.4M/29.4M [00:01&lt;00:00, 14.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  94%|█████████▍| 27.6M/29.4M [00:02&lt;00:00, 15.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (15 ok out of 27):  77%|███████████▍   | 473M/618M [00:14&lt;00:03, 38.4MB/s]







sub-07/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.7M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (16 ok out of 27):  77%|███████████▍   | 473M/618M [00:14&lt;00:03, 38.4MB/s]


                                                                                




sub-06/func .. bold.nii.gz:  81%|████████▏ | 23.9M/29.4M [00:02&lt;00:00, 15.2MB/s]
Total (17 ok out of 27):  77%|███████████▌   | 475M/618M [00:14&lt;00:03, 38.4MB/s]

                                                                                
Total (18 ok out of 27):  77%|███████████▌   | 475M/618M [00:14&lt;00:03, 38.4MB/s]

                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/anat .. _T1w.nii.gz:   1%|▏          | 155k/10.7M [00:00&lt;00:06, 1.54MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (18 ok out of 27):  77%|███████████▌   | 477M/618M [00:14&lt;00:04, 29.2MB/s]




sub-07/anat .. _T1w.nii.gz:   7%|▊          | 782k/10.7M [00:00&lt;00:04, 1.99MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz:  94%|█████████▍| 27.6M/29.4M [00:02&lt;00:00, 16.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (18 ok out of 27):  78%|███████████▋   | 484M/618M [00:15&lt;00:03, 34.6MB/s]




sub-07/anat .. _T1w.nii.gz:  27%|██▋       | 2.87M/10.7M [00:00&lt;00:02, 2.74MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (19 ok out of 27):  78%|███████████▋   | 484M/618M [00:15&lt;00:03, 34.6MB/s]



                                                                                




sub-04/func .. bold.nii.gz:   0%|                   | 0.00/29.1M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/anat .. _T1w.nii.gz:  42%|████▏     | 4.48M/10.7M [00:00&lt;00:01, 3.64MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:   0%|           | 122k/29.1M [00:00&lt;00:26, 1.09MB/s]





sub-07/func .. bold.nii.gz:   0%|                   | 0.00/29.0M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/anat .. _T1w.nii.gz:  54%|█████▍    | 5.82M/10.7M [00:00&lt;00:01, 4.66MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:   3%|▎          | 888k/29.1M [00:00&lt;00:19, 1.46MB/s]
Total (19 ok out of 27):  79%|███████████▊   | 489M/618M [00:15&lt;00:04, 29.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/anat .. _T1w.nii.gz:  65%|██████▌   | 7.00M/10.7M [00:00&lt;00:00, 5.68MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:   9%|▊         | 2.47M/29.1M [00:00&lt;00:13, 2.00MB/s]
Total (19 ok out of 27):  80%|███████████▉   | 493M/618M [00:15&lt;00:03, 32.0MB/s]





sub-07/func .. bold.nii.gz:  11%|█         | 3.12M/29.0M [00:00&lt;00:01, 15.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/anat .. _T1w.nii.gz:  78%|███████▊  | 8.38M/10.7M [00:00&lt;00:00, 6.82MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (19 ok out of 27):  81%|████████████   | 498M/618M [00:15&lt;00:03, 35.3MB/s]





sub-07/func .. bold.nii.gz:  16%|█▌        | 4.56M/29.0M [00:00&lt;00:01, 15.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/anat .. _T1w.nii.gz:  94%|█████████▎| 10.0M/10.7M [00:00&lt;00:00, 8.26MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  19%|█▉        | 5.62M/29.1M [00:00&lt;00:08, 2.71MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (19 ok out of 27):  81%|████████████▏  | 502M/618M [00:15&lt;00:03, 36.4MB/s]





sub-07/func .. bold.nii.gz:  20%|██        | 5.87M/29.0M [00:00&lt;00:01, 14.1MB/s]

sub-06/func .. bold.nii.gz: 100%|██████████| 29.4M/29.4M [00:03&lt;00:00, 4.64MB/s]
Total (20 ok out of 27):  81%|████████████▏  | 503M/618M [00:15&lt;00:03, 36.4MB/s]

                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  25%|██▌       | 7.38M/29.1M [00:00&lt;00:06, 3.61MB/s]




sub-07/func .. bold.nii.gz:  25%|██▌       | 7.25M/29.0M [00:00&lt;00:01, 14.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:   0%|                   | 0.00/29.1M [00:00&lt;?, ?B/s]
Total (20 ok out of 27):  82%|████████████▎  | 508M/618M [00:15&lt;00:03, 34.9MB/s]



sub-04/func .. bold.nii.gz:  31%|███       | 9.05M/29.1M [00:00&lt;00:04, 4.70MB/s]




sub-07/func .. bold.nii.gz:  31%|███       | 8.89M/29.0M [00:00&lt;00:01, 14.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (20 ok out of 27):  83%|████████████▍  | 512M/618M [00:15&lt;00:03, 35.3MB/s]




sub-07/func .. bold.nii.gz:  37%|███▋      | 10.6M/29.0M [00:00&lt;00:01, 15.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  10%|▉         | 2.90M/29.1M [00:00&lt;00:01, 14.6MB/s]



sub-04/func .. bold.nii.gz:  40%|███▉      | 11.5M/29.1M [00:00&lt;00:03, 5.77MB/s]
Total (20 ok out of 27):  84%|████████████▌  | 518M/618M [00:16&lt;00:02, 39.2MB/s]




sub-07/func .. bold.nii.gz:  42%|████▏     | 12.2M/29.0M [00:00&lt;00:01, 15.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  14%|█▍        | 4.09M/29.1M [00:00&lt;00:01, 13.7MB/s]



sub-04/func .. bold.nii.gz:  46%|████▌     | 13.4M/29.1M [00:01&lt;00:02, 7.24MB/s]
Total (20 ok out of 27):  84%|████████████▋  | 522M/618M [00:16&lt;00:02, 39.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  19%|█▉        | 5.47M/29.1M [00:00&lt;00:01, 13.5MB/s]



sub-04/func .. bold.nii.gz:  51%|█████▏    | 14.9M/29.1M [00:01&lt;00:01, 8.52MB/s]
Total (20 ok out of 27):  85%|████████████▊  | 527M/618M [00:16&lt;00:02, 40.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/func .. bold.nii.gz:  51%|█████     | 14.8M/29.0M [00:01&lt;00:00, 14.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  23%|██▎       | 6.67M/29.1M [00:00&lt;00:01, 13.0MB/s]



sub-04/func .. bold.nii.gz:  57%|█████▋    | 16.4M/29.1M [00:01&lt;00:01, 9.82MB/s]
Total (20 ok out of 27):  86%|████████████▉  | 531M/618M [00:16&lt;00:02, 40.9MB/s]




sub-07/func .. bold.nii.gz:  56%|█████▌    | 16.3M/29.0M [00:01&lt;00:00, 14.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  29%|██▉       | 8.40M/29.1M [00:00&lt;00:01, 13.8MB/s]
Total (20 ok out of 27):  87%|████████████▉  | 536M/618M [00:16&lt;00:01, 42.9MB/s]




sub-07/func .. bold.nii.gz:  62%|██████▏   | 18.0M/29.0M [00:01&lt;00:00, 15.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  66%|██████▌   | 19.2M/29.1M [00:01&lt;00:00, 10.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (20 ok out of 27):  87%|█████████████  | 540M/618M [00:16&lt;00:02, 38.9MB/s]




sub-07/func .. bold.nii.gz:  68%|██████▊   | 19.7M/29.0M [00:01&lt;00:00, 13.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  40%|███▉      | 11.6M/29.1M [00:00&lt;00:01, 14.4MB/s]



sub-04/func .. bold.nii.gz:  72%|███████▏  | 20.9M/29.1M [00:01&lt;00:00, 12.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (20 ok out of 27):  88%|█████████████▏ | 546M/618M [00:16&lt;00:01, 40.8MB/s]





sub-04/func .. bold.nii.gz:  45%|████▍     | 13.0M/29.1M [00:00&lt;00:01, 14.4MB/s]




sub-07/func .. bold.nii.gz:  75%|███████▌  | 21.8M/29.0M [00:01&lt;00:00, 13.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  80%|███████▉  | 23.2M/29.1M [00:01&lt;00:00, 12.4MB/s]
Total (20 ok out of 27):  89%|█████████████▎ | 551M/618M [00:16&lt;00:01, 42.8MB/s]





sub-04/func .. bold.nii.gz:  50%|████▉     | 14.4M/29.1M [00:01&lt;00:01, 14.1MB/s]




sub-07/func .. bold.nii.gz:  81%|████████▏ | 23.6M/29.0M [00:01&lt;00:00, 14.7MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (20 ok out of 27):  90%|█████████████▍ | 556M/618M [00:16&lt;00:01, 41.5MB/s]



sub-04/func .. bold.nii.gz:  87%|████████▋ | 25.3M/29.1M [00:01&lt;00:00, 13.1MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  58%|█████▊    | 16.8M/29.1M [00:01&lt;00:00, 13.2MB/s]




sub-07/func .. bold.nii.gz:  89%|████████▉ | 25.9M/29.0M [00:01&lt;00:00, 13.7MB/s]
Total (20 ok out of 27):  91%|█████████████▌ | 561M/618M [00:17&lt;00:01, 42.6MB/s]



sub-04/func .. bold.nii.gz:  92%|█████████▏| 26.8M/29.1M [00:01&lt;00:00, 13.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  64%|██████▍   | 18.5M/29.1M [00:01&lt;00:00, 14.2MB/s]




sub-07/func .. bold.nii.gz:  95%|█████████▌| 27.5M/29.0M [00:01&lt;00:00, 14.2MB/s]
Total (20 ok out of 27):  91%|█████████████▋ | 565M/618M [00:17&lt;00:01, 43.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  71%|███████   | 20.7M/29.1M [00:01&lt;00:00, 15.8MB/s]



sub-04/func .. bold.nii.gz: 100%|██████████| 29.1M/29.1M [00:02&lt;00:00, 13.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (20 ok out of 27):  92%|█████████████▊ | 570M/618M [00:17&lt;00:01, 42.1MB/s]




sub-07/func .. bold.nii.gz: 100%|██████████| 29.0M/29.0M [00:02&lt;00:00, 13.4MB/s]
Total (21 ok out of 27):  92%|█████████████▊ | 570M/618M [00:17&lt;00:01, 42.1MB/s]


                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/func .. bold.nii.gz:  81%|████████  | 23.5M/29.1M [00:01&lt;00:00, 15.1MB/s]





sub-04/anat .. _T1w.nii.gz:   0%|                   | 0.00/10.7M [00:00&lt;?, ?B/s]






sub-07/func .. bold.nii.gz:   0%|                   | 0.00/28.9M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (21 ok out of 27):  93%|█████████████▉ | 574M/618M [00:17&lt;00:01, 29.3MB/s]




sub-04/func .. bold.nii.gz:  86%|████████▌ | 25.0M/29.1M [00:01&lt;00:00, 15.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/func .. bold.nii.gz:   5%|▌         | 1.55M/28.9M [00:00&lt;00:01, 14.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (21 ok out of 27):  94%|██████████████ | 578M/618M [00:17&lt;00:01, 31.1MB/s]





sub-04/anat .. _T1w.nii.gz:  20%|█▉        | 2.13M/10.7M [00:00&lt;00:00, 10.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/func .. bold.nii.gz:  12%|█▏        | 3.33M/28.9M [00:00&lt;00:01, 15.1MB/s]




sub-04/func .. bold.nii.gz:  93%|█████████▎| 27.0M/29.1M [00:01&lt;00:00, 14.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (21 ok out of 27):  94%|██████████████▏| 583M/618M [00:17&lt;00:01, 34.5MB/s]





sub-04/anat .. _T1w.nii.gz:  32%|███▏      | 3.44M/10.7M [00:00&lt;00:00, 11.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/func .. bold.nii.gz:  16%|█▋        | 4.73M/28.9M [00:00&lt;00:01, 14.4MB/s]




sub-04/func .. bold.nii.gz: 100%|██████████| 29.1M/29.1M [00:01&lt;00:00, 15.1MB/s]
Total (22 ok out of 27):  95%|██████████████▎| 587M/618M [00:17&lt;00:00, 34.5MB/s]



                                                                                
Total (23 ok out of 27):  95%|██████████████▎| 587M/618M [00:17&lt;00:00, 34.5MB/s]


                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-06/func .. bold.nii.gz: 100%|██████████| 29.4M/29.4M [00:05&lt;00:00, 1.89MB/s]
Total (24 ok out of 27):  95%|██████████████▎| 587M/618M [00:17&lt;00:00, 34.5MB/s]

                                                                                
Total (24 ok out of 27):  95%|██████████████▎| 588M/618M [00:17&lt;00:00, 35.9MB/s]


sub-04/anat .. _T1w.nii.gz:  42%|████▏     | 4.52M/10.7M [00:00&lt;00:00, 10.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/anat .. _T1w.nii.gz:  54%|█████▍    | 5.85M/10.7M [00:00&lt;00:00, 11.3MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (24 ok out of 27):  96%|██████████████▎| 592M/618M [00:17&lt;00:00, 33.7MB/s]



sub-07/func .. bold.nii.gz:  25%|██▌       | 7.31M/28.9M [00:00&lt;00:01, 13.8MB/s]
Total (25 ok out of 27):  96%|██████████████▎| 592M/618M [00:17&lt;00:00, 33.7MB/s]

                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/anat .. _T1w.nii.gz:  68%|██████▊   | 7.35M/10.7M [00:00&lt;00:00, 12.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (25 ok out of 27):  96%|██████████████▍| 595M/618M [00:18&lt;00:00, 34.5MB/s]


sub-07/func .. bold.nii.gz:  33%|███▎      | 9.51M/28.9M [00:00&lt;00:01, 15.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/anat .. _T1w.nii.gz:  87%|████████▋ | 9.34M/10.7M [00:00&lt;00:00, 13.8MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (25 ok out of 27):  97%|██████████████▌| 599M/618M [00:18&lt;00:00, 35.9MB/s]


sub-07/func .. bold.nii.gz:  40%|███▉      | 11.5M/28.9M [00:00&lt;00:01, 16.6MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-04/anat .. _T1w.nii.gz: 100%|██████████| 10.7M/10.7M [00:00&lt;00:00, 13.8MB/s]
Total (26 ok out of 27):  97%|██████████████▌| 602M/618M [00:18&lt;00:00, 35.9MB/s]

                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/func .. bold.nii.gz:  47%|████▋     | 13.5M/28.9M [00:00&lt;00:00, 17.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (26 ok out of 27):  98%|██████████████▋| 605M/618M [00:18&lt;00:00, 32.8MB/s]

sub-07/func .. bold.nii.gz:  54%|█████▍    | 15.6M/28.9M [00:00&lt;00:00, 18.4MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/func .. bold.nii.gz:  63%|██████▎   | 18.1M/28.9M [00:01&lt;00:00, 20.0MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (26 ok out of 27):  99%|██████████████▊| 610M/618M [00:18&lt;00:00, 30.0MB/s]

sub-07/func .. bold.nii.gz:  71%|███████   | 20.6M/28.9M [00:01&lt;00:00, 21.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/func .. bold.nii.gz:  80%|███████▉  | 23.1M/28.9M [00:01&lt;00:00, 22.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (26 ok out of 27):  99%|██████████████▉| 614M/618M [00:18&lt;00:00, 28.2MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sub-07/func .. bold.nii.gz:  88%|████████▊ | 25.6M/28.9M [00:01&lt;00:00, 22.9MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (26 ok out of 27): 100%|██████████████▉| 617M/618M [00:18&lt;00:00, 27.1MB/s]

sub-07/func .. bold.nii.gz:  97%|█████████▋| 28.1M/28.9M [00:01&lt;00:00, 23.5MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total (27 ok out of 27): 618MB [00:18, 27.1MB/s]                                

                                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-08/anat/sub-08_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-08/func/sub-08_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-01/anat/sub-01_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-08/func/sub-08_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-09/func/sub-09_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-09/anat/sub-09_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-09/func/sub-09_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-03/anat/sub-03_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-01/func/sub-01_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-05/anat/sub-05_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-03/func/sub-03_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-02/anat/sub-02_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-02/func/sub-02_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-05/func/sub-05_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-01/func/sub-01_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-05/func/sub-05_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-03/func/sub-03_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-02/func/sub-02_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-06/anat/sub-06_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-06/func/sub-06_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-07/anat/sub-07_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-07/func/sub-07_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-04/func/sub-04_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-06/func/sub-06_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-04/func/sub-04_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-04/anat/sub-04_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-07/func/sub-07_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-08 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-09 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-01 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-03 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-02 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-05 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-06 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-07 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-04 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
action summary:
  get (ok: 36)

</pre></div>
</div>
</div>
</div>
</section>
<section id="start-the-workflow">
<h3>Start the workflow<a class="headerlink" href="#start-the-workflow" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wf_first</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;level1&#39;</span><span class="p">,</span> <span class="n">base_dir</span><span class="o">=</span><span class="n">exp_dir_first</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;execution&quot;</span><span class="p">][</span><span class="s2">&quot;crashfile_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;txt&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>The following two nodes (<code class="docutils literal notranslate"><span class="pre">infosource</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">dg</span></code>) together define all inputs required for the preprocessing workflow</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get subject_id list - we only do 9 subjects here so the notebook runs in a reasonable time</span>
<span class="n">subj_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">glob</span><span class="p">(</span><span class="n">data_dir_first</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">PATTERN</span><span class="p">)]</span>
<span class="n">subj_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subj_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infosource_first</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">IdentityInterface</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;subject_id&quot;</span><span class="p">]),</span>
                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;infosource&quot;</span><span class="p">)</span>
<span class="n">infosource_first</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;subject_id&quot;</span><span class="p">,</span> <span class="n">subj_list</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dg_first</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">nio</span><span class="o">.</span><span class="n">DataGrabber</span><span class="p">(</span>
        <span class="n">infields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;subject_id&quot;</span><span class="p">,</span><span class="s2">&quot;run_id&quot;</span><span class="p">],</span> <span class="n">outfields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;struct&quot;</span><span class="p">,</span> <span class="s2">&quot;func&quot;</span><span class="p">,</span> <span class="s2">&quot;events&quot;</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dg_first&quot;</span>
<span class="p">)</span>

<span class="c1"># Specify run_ids and return a sorted filelist to ensure we match files to correct runs/tasks</span>
<span class="n">dg_first</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">run_id</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">dg_first</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sort_filelist</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">dg_first</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
<span class="n">dg_first</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span> <span class="o">=</span> <span class="n">data_dir_first</span>

<span class="c1"># Define arguments fill the wildcards in the below paths </span>
<span class="n">dg_first</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">template_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">struct</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;subject_id&quot;</span><span class="p">,</span><span class="s2">&quot;subject_id&quot;</span><span class="p">]],</span>
    <span class="n">func</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;subject_id&quot;</span><span class="p">,</span><span class="s2">&quot;subject_id&quot;</span><span class="p">,</span><span class="s2">&quot;run_id&quot;</span><span class="p">]],</span>
    <span class="n">events</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;subject_id&quot;</span><span class="p">,</span><span class="s2">&quot;subject_id&quot;</span><span class="p">,</span><span class="s2">&quot;run_id&quot;</span><span class="p">]]</span>
<span class="p">)</span>

<span class="n">dg_first</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">field_template</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">struct</span> <span class="o">=</span> <span class="s2">&quot;sub-</span><span class="si">%s</span><span class="s2">/anat/sub-</span><span class="si">%s</span><span class="s2">_T1w.nii.gz&quot;</span><span class="p">,</span>
    <span class="n">func</span><span class="o">=</span><span class="s2">&quot;sub-</span><span class="si">%s</span><span class="s2">/func/sub-</span><span class="si">%s</span><span class="s2">_task-flanker_run-</span><span class="si">%d</span><span class="s2">_bold.nii.gz&quot;</span><span class="p">,</span>
    <span class="n">events</span><span class="o">=</span><span class="s2">&quot;sub-</span><span class="si">%s</span><span class="s2">/func/sub-</span><span class="si">%s</span><span class="s2">_task-flanker_run-</span><span class="si">%d</span><span class="s2">_events.tsv&quot;</span><span class="p">,</span> 
<span class="p">)</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
        <span class="p">(</span><span class="n">infosource_first</span><span class="p">,</span> <span class="n">dg_first</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;subject_id&quot;</span><span class="p">,</span> <span class="s2">&quot;subject_id&quot;</span><span class="p">)])</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="initialisation">
<h2>Initialisation<a class="headerlink" href="#initialisation" title="Permalink to this heading">#</a></h2>
<p>Convert functional images to float representation. Since there can be more than one functional run we use a MapNode to convert each run.</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="o">../</span><span class="n">sub</span><span class="o">-</span><span class="mi">11</span><span class="o">/</span><span class="n">func</span><span class="o">/</span><span class="n">sub</span><span class="o">-</span><span class="mi">11</span><span class="n">_task</span><span class="o">-</span><span class="n">flanker_run</span><span class="o">-</span><span class="mi">1</span><span class="n">_bold</span> <span class="n">prefiltered_func_data</span> <span class="o">-</span><span class="n">odt</span> <span class="nb">float</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img2float</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">out_data_type</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_dtype&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;img2float&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_first</span><span class="p">,</span> <span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="n">img2float</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Extract the middle volume of the first run as the reference</p>
<p>(Head movement, motion-correction)</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslroi</span> <span class="n">prefiltered_func_data</span> <span class="n">example_func</span> <span class="mi">73</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract one roi</span>
<span class="n">extract_ref</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ExtractROI</span><span class="p">(</span><span class="n">t_size</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> 
                         <span class="n">name</span><span class="o">=</span><span class="s1">&#39;extractref&#39;</span><span class="p">,</span>
                         <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">img2float</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">extract_ref</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>

<span class="c1"># Define a function to return the 1 based index of the middle volume</span>
<span class="k">def</span> <span class="nf">getmiddlevolume</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">nibabel</span> <span class="kn">import</span> <span class="n">load</span>
    <span class="n">funcfile</span> <span class="o">=</span> <span class="n">func</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">funcfile</span> <span class="o">=</span> <span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">timepoints</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">funcfile</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">timepoints</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> 

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">img2float</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">getmiddlevolume</span><span class="p">),</span> <span class="n">extract_ref</span><span class="p">,</span> <span class="s1">&#39;t_min&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this heading">#</a></h2>
<section id="motion-correction">
<h3>Motion Correction<a class="headerlink" href="#motion-correction" title="Permalink to this heading">#</a></h3>
<p>Realign the functional runs to the middle volume of each run</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mcflirt</span> <span class="o">-</span><span class="ow">in</span> <span class="n">prefiltered_func_data</span> <span class="o">-</span><span class="n">out</span> <span class="n">prefiltered_func_data_mcf</span> <span class="o">-</span><span class="n">mats</span> <span class="o">-</span><span class="n">plots</span> <span class="o">-</span><span class="n">reffile</span> <span class="n">example_func</span> <span class="o">-</span><span class="n">rmsrel</span> <span class="o">-</span><span class="n">rmsabs</span> <span class="o">-</span><span class="n">spline_final</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>save_mats (a boolean) – Save transformation matrices. Maps to a command-line argument: -mats.
save_plots (a boolean) – Save transformation parameters. Maps to a command-line argument: -plots.
save_rms (a boolean) – Save rms displacement parameters. Maps to a command-line argument: -rmsabs -rmsrel.
Interpolation (‘spline’ or ‘nn’ or ‘sinc’) – Interpolation method for transformation. Maps to a command-line argument: -%s_final.
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">motion_correct</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">MCFLIRT</span><span class="p">(</span><span class="n">save_mats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_rms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;spline&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;realign&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;ref_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">img2float</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">motion_correct</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">extract_ref</span><span class="p">,</span> <span class="s1">&#39;roi_file&#39;</span><span class="p">,</span> <span class="n">motion_correct</span><span class="p">,</span> <span class="s1">&#39;ref_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the estimated motion parameters</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fsl_tsplot</span> <span class="o">-</span><span class="n">i</span> <span class="n">prefiltered_func_data_mcf</span><span class="o">.</span><span class="n">par</span> <span class="o">-</span><span class="n">t</span> <span class="s1">&#39;MCFLIRT estimated rotations (radians)&#39;</span> <span class="o">-</span><span class="n">u</span> <span class="mi">1</span> <span class="o">--</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span> <span class="o">--</span><span class="n">finish</span><span class="o">=</span><span class="mi">3</span> <span class="o">-</span><span class="n">a</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">-</span><span class="n">w</span> <span class="mi">640</span> <span class="o">-</span><span class="n">h</span> <span class="mi">144</span> <span class="o">-</span><span class="n">o</span> <span class="n">rot</span><span class="o">.</span><span class="n">png</span> 

<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fsl_tsplot</span> <span class="o">-</span><span class="n">i</span> <span class="n">prefiltered_func_data_mcf</span><span class="o">.</span><span class="n">par</span> <span class="o">-</span><span class="n">t</span> <span class="s1">&#39;MCFLIRT estimated translations (mm)&#39;</span> <span class="o">-</span><span class="n">u</span> <span class="mi">1</span> <span class="o">--</span><span class="n">start</span><span class="o">=</span><span class="mi">4</span> <span class="o">--</span><span class="n">finish</span><span class="o">=</span><span class="mi">6</span> <span class="o">-</span><span class="n">a</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">-</span><span class="n">w</span> <span class="mi">640</span> <span class="o">-</span><span class="n">h</span> <span class="mi">144</span> <span class="o">-</span><span class="n">o</span> <span class="n">trans</span><span class="o">.</span><span class="n">png</span> 

<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fsl_tsplot</span> <span class="o">-</span><span class="n">i</span> <span class="n">prefiltered_func_data_mcf_abs</span><span class="o">.</span><span class="n">rms</span><span class="p">,</span><span class="n">prefiltered_func_data_mcf_rel</span><span class="o">.</span><span class="n">rms</span> <span class="o">-</span><span class="n">t</span> <span class="s1">&#39;MCFLIRT estimated mean displacement (mm)&#39;</span> <span class="o">-</span><span class="n">u</span> <span class="mi">1</span> <span class="o">-</span><span class="n">w</span> <span class="mi">640</span> <span class="o">-</span><span class="n">h</span> <span class="mi">144</span> <span class="o">-</span><span class="n">a</span> <span class="n">absolute</span><span class="p">,</span><span class="n">relative</span> <span class="o">-</span><span class="n">o</span> <span class="n">disp</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_motion</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">PlotMotionParams</span><span class="p">(</span><span class="n">in_source</span><span class="o">=</span><span class="s1">&#39;fsl&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;plot_motion&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">plot_motion</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;plot_type&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;rotations&#39;</span><span class="p">,</span> <span class="s1">&#39;translations&#39;</span><span class="p">,</span><span class="s1">&#39;displacement&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">motion_correct</span><span class="p">,</span> <span class="s1">&#39;par_file&#39;</span><span class="p">,</span> <span class="n">plot_motion</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="functionally-masking">
<h3>Functionally Masking<a class="headerlink" href="#functionally-masking" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Passing</span> <span class="n">the</span> <span class="n">reference</span> <span class="n">volume</span> <span class="n">to</span> <span class="n">the</span> <span class="n">FSL</span> <span class="n">command</span><span class="o">-</span><span class="n">line</span> <span class="n">tool</span> <span class="n">bet</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">a</span> <span class="n">binary</span> <span class="n">brain</span> <span class="n">mask</span> <span class="ow">and</span> <span class="n">afterward</span> <span class="n">multiplying</span> <span class="n">the</span> <span class="n">processed</span> <span class="n">functional</span> <span class="n">time</span> <span class="n">series</span> <span class="n">by</span> <span class="n">the</span> <span class="n">brain</span> <span class="n">mask</span> <span class="n">using</span> <span class="n">the</span> <span class="n">fslmaths</span> <span class="n">command</span> <span class="n">to</span> <span class="n">produce</span> <span class="n">a</span> <span class="n">skull</span><span class="o">-</span><span class="n">stripped</span> <span class="n">time</span> <span class="n">series</span><span class="o">.</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://www.nature.com/articles/s41596-018-0065-y#Sec24">Ciric et al.(2018)</a></p>
<p>Extract the mean volume of each functional run</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_mcf</span> <span class="o">-</span><span class="n">Tmean</span> <span class="n">mean_func</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meanfunc</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-Tmean&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_mean&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;meanfunc&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">motion_correct</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">meanfunc</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Strip the skull from the mean functional to generate a mask</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bet2</span> <span class="n">mean_func</span> <span class="n">mask</span> <span class="o">-</span><span class="n">f</span> <span class="mf">0.3</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">m</span><span class="p">;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">immv</span> <span class="n">mask_mask</span> <span class="n">mask</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meanfuncmask</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">BET</span><span class="p">(</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;meanfuncmask&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">meanfunc</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">meanfuncmask</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Mask the functional data with the extracted mask</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_mcf</span> <span class="o">-</span><span class="n">mas</span> <span class="n">mask</span> <span class="n">prefiltered_func_data_bet</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maskfunc</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_bet&#39;</span><span class="p">,</span> <span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-mas&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maskfunc&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;in_file2&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">motion_correct</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">maskfunc</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">meanfuncmask</span><span class="p">,</span> <span class="s1">&#39;mask_file&#39;</span><span class="p">,</span> <span class="n">maskfunc</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="grand-mean-scaling">
<h3>Grand Mean Scaling<a class="headerlink" href="#grand-mean-scaling" title="Permalink to this heading">#</a></h3>
<p>Determine the 2nd and 98th percentile intensities</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslstats</span> <span class="n">prefiltered_func_data_bet</span> <span class="o">-</span><span class="n">p</span> <span class="mi">2</span> <span class="o">-</span><span class="n">p</span> <span class="mi">98</span>
<span class="mf">0.000000</span> <span class="mf">873.492249</span> <span class="p">(</span><span class="n">these</span> <span class="n">numbers</span> <span class="n">are</span> <span class="k">for</span> <span class="n">subject</span><span class="o">-</span><span class="mi">11</span> <span class="n">run</span><span class="o">-</span><span class="mi">01</span><span class="p">)</span>
</pre></div>
</div>
<p>More info <a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Fslutils#fslstats">here</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">getthresh</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageStats</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-p 2 -p 98&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;getthreshold&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">maskfunc</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">getthresh</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Threshold the first TR of the functional data at 10% of the 98th percentile</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_bet</span> <span class="o">-</span><span class="n">thr</span> <span class="mf">87.3492249</span> <span class="o">-</span><span class="n">Tmin</span> <span class="o">-</span><span class="nb">bin</span> <span class="n">mask</span> <span class="o">-</span><span class="n">odt</span> <span class="n">char</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">out_data_type</span><span class="o">=</span><span class="s1">&#39;char&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_thresh&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;op_string&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">maskfunc</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>

<span class="c1"># Define a function to get 10% of the intensity</span>
<span class="k">def</span> <span class="nf">getthreshop</span><span class="p">(</span><span class="n">thresh</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;-thr </span><span class="si">%.10f</span><span class="s1"> -Tmin -bin&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">th</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">thresh</span><span class="p">]</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">getthresh</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;out_stat&#39;</span><span class="p">,</span> <span class="n">getthreshop</span><span class="p">),</span> <span class="n">threshold</span><span class="p">,</span> <span class="s1">&#39;op_string&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Determine the median value of the TRs using the mask</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslstats</span> <span class="n">prefiltered_func_data_mcf</span> <span class="o">-</span><span class="n">k</span> <span class="n">mask</span> <span class="o">-</span><span class="n">p</span> <span class="mi">50</span>
<span class="mf">728.800232</span> <span class="p">(</span><span class="n">this</span> <span class="n">number</span> <span class="ow">is</span> <span class="k">for</span> <span class="n">subject</span><span class="o">-</span><span class="mi">11</span> <span class="n">run</span><span class="o">-</span><span class="mi">01</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medianval</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageStats</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-k </span><span class="si">%s</span><span class="s1"> -p 50&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;medianval&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;mask_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">motion_correct</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">medianval</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">medianval</span><span class="p">,</span> <span class="s1">&#39;mask_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Dilate the mask</p>
<p>The brain mask is “dilated” slightly before being used. Because it is normally important that masking be liberal (ie that there be little risk of cutting out valid brain voxels)</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">mask</span> <span class="o">-</span><span class="n">dilF</span> <span class="n">mask</span>
</pre></div>
</div>
<p>The output of <code class="docutils literal notranslate"><span class="pre">dilatemask</span></code> (i.e., <code class="docutils literal notranslate"><span class="pre">/srv/scratch/yc/fsl/hw2/level1/_subject_id_26/dilatemask/mapflow/_dilatemask0/sub-26_task-flanker_run-1_bold_dtype_mcf_bet_thresh_dil.nii.gz</span></code>) is equivalent to <code class="docutils literal notranslate"><span class="pre">mask.nii.gz</span></code> from FSL GUI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dilatemask</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_dil&#39;</span><span class="p">,</span> <span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-dilF&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dilatemask&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">dilatemask</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Mask the motion corrected functional runs with the dilated mask</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_mcf</span> <span class="o">-</span><span class="n">mas</span> <span class="n">mask</span> <span class="n">prefiltered_func_data_thresh</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maskfunc2</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_thresh&#39;</span><span class="p">,</span> <span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-mas&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;in_file2&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maskfunc2&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">motion_correct</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">maskfunc2</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dilatemask</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">maskfunc2</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="susan-noise-reduction">
<h3>SUSAN Noise Reduction<a class="headerlink" href="#susan-noise-reduction" title="Permalink to this heading">#</a></h3>
<p>Determine the mean image from each TR</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_thresh</span> <span class="o">-</span><span class="n">Tmean</span> <span class="n">mean_func</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meanfunc2</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-Tmean&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_mean&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;meanfunc2&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">maskfunc2</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">meanfunc2</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Merge the median values with the mean functional images into a coupled list</p>
<p>The output of this <code class="docutils literal notranslate"><span class="pre">merge</span></code> node will go into <code class="docutils literal notranslate"><span class="pre">susan</span></code> as <code class="docutils literal notranslate"><span class="pre">usans</span></code>,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># why here use node not mapnode?</span>
<span class="n">mergenode</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">Merge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;hstack&#39;</span><span class="p">),</span> 
                       <span class="n">name</span><span class="o">=</span><span class="s1">&#39;merge&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">meanfunc2</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">mergenode</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">medianval</span><span class="p">,</span> <span class="s1">&#39;out_stat&#39;</span><span class="p">,</span> <span class="n">mergenode</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Smooth each run using SUSAN with the brightness threshold set to 75% of the median value for each run and a mask constituting the mean functional</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span> <span class="n">susan</span> <span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">bt</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dt</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">use_median</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">n_usans</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">usan1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">bt1</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">usan2</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">bt2</span><span class="o">&gt;</span><span class="p">]]</span> <span class="o">&lt;</span><span class="n">output</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">bt</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">brightness</span> <span class="n">threshold</span> <span class="ow">and</span> <span class="n">should</span> <span class="n">be</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">noise</span> <span class="n">level</span> <span class="ow">and</span> <span class="n">less</span> <span class="n">than</span> <span class="n">contrast</span> <span class="n">of</span> <span class="n">edges</span> <span class="n">to</span> <span class="n">be</span> <span class="n">preserved</span><span class="o">.</span>
<span class="o">&lt;</span><span class="n">dt</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">spatial</span> <span class="n">size</span> <span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">half</span><span class="o">-</span><span class="n">width</span><span class="p">)</span> <span class="n">of</span> <span class="n">smoothing</span><span class="p">,</span> <span class="ow">in</span> <span class="n">mm</span><span class="o">.</span>
<span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">dimensionality</span> <span class="p">(</span><span class="mi">2</span> <span class="ow">or</span> <span class="mi">3</span><span class="p">),</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">whether</span> <span class="n">smoothing</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">be</span> <span class="n">within</span><span class="o">-</span><span class="n">plane</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fully</span> <span class="mi">3</span><span class="n">D</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span>
<span class="o">&lt;</span><span class="n">use_median</span><span class="o">&gt;</span> <span class="n">determines</span> <span class="n">whether</span> <span class="n">to</span> <span class="n">use</span> <span class="n">a</span> <span class="n">local</span> <span class="n">median</span> <span class="nb">filter</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">cases</span> <span class="n">where</span> <span class="n">single</span><span class="o">-</span><span class="n">point</span> <span class="n">noise</span> <span class="ow">is</span> <span class="n">detected</span> <span class="p">(</span><span class="mi">0</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span>
<span class="o">&lt;</span><span class="n">n_usans</span><span class="o">&gt;</span> <span class="n">determines</span> <span class="n">whether</span> <span class="n">the</span> <span class="n">smoothing</span> <span class="n">area</span> <span class="p">(</span><span class="n">USAN</span><span class="p">)</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">be</span> <span class="n">found</span> <span class="kn">from</span> <span class="nn">secondary</span> <span class="n">images</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="ow">or</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span>
<span class="n">A</span> <span class="n">negative</span> <span class="n">value</span> <span class="k">for</span> <span class="nb">any</span> <span class="n">brightness</span> <span class="n">threshold</span> <span class="n">will</span> <span class="n">auto</span><span class="o">-</span><span class="nb">set</span> <span class="n">the</span> <span class="n">threshold</span> <span class="n">at</span> <span class="mi">10</span><span class="o">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">robust</span> <span class="nb">range</span>
</pre></div>
</div>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">susan</span> <span class="n">prefiltered_func_data_thresh</span> <span class="mf">546.600174</span> <span class="mf">2.12314225053</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">mean_func</span> <span class="mf">546.600174</span> <span class="n">prefiltered_func_data_smooth</span>
</pre></div>
</div>
<p><strong>Note:</strong></p>
<p>for <code class="docutils literal notranslate"><span class="pre">&lt;bt&gt;</span></code>, Nipype uses a different algorithm to calculate it -&gt; <code class="docutils literal notranslate"><span class="pre">float(fwhm)</span> <span class="pre">/</span> <span class="pre">np.sqrt(8</span> <span class="pre">*</span> <span class="pre">np.log(2))</span></code>. Therefore, to get <code class="docutils literal notranslate"><span class="pre">2.12314225053</span></code>, fwhm should be <code class="docutils literal notranslate"><span class="pre">4.9996179300001655</span></code> instead of <code class="docutils literal notranslate"><span class="pre">5</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fwhm_thr</span> <span class="o">=</span> <span class="mf">4.9996179300001655</span>

<span class="n">smooth</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">SUSAN</span><span class="p">(</span><span class="n">fwhm</span> <span class="o">=</span> <span class="n">fwhm_thr</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;smooth&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span> <span class="s1">&#39;brightness_threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;usans&#39;</span><span class="p">])</span>

<span class="c1"># Define a function to get the brightness threshold for SUSAN</span>
<span class="k">def</span> <span class="nf">getbtthresh</span><span class="p">(</span><span class="n">medianvals</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">medianvals</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">getusans</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[[</span><span class="nb">tuple</span><span class="p">([</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]])]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">maskfunc2</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">smooth</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">medianval</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;out_stat&#39;</span><span class="p">,</span> <span class="n">getbtthresh</span><span class="p">),</span> <span class="n">smooth</span><span class="p">,</span>
                <span class="s1">&#39;brightness_threshold&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">mergenode</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">getusans</span><span class="p">),</span> <span class="n">smooth</span><span class="p">,</span> <span class="s1">&#39;usans&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Mask the smoothed data with the dilated mask</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_smooth</span> <span class="o">-</span><span class="n">mas</span> <span class="n">mask</span> <span class="n">prefiltered_func_data_smooth</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maskfunc3</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-mas&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maskfunc3&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;in_file2&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">smooth</span><span class="p">,</span> <span class="s1">&#39;smoothed_file&#39;</span><span class="p">,</span> <span class="n">maskfunc3</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dilatemask</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">maskfunc3</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Scale each volume of the TR so that the median value of the TR is set to 10000</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_smooth</span> <span class="o">-</span><span class="n">mul</span> <span class="mf">13.7211811425</span> <span class="n">prefiltered_func_data_intnorm</span> 
<span class="p">(</span><span class="n">this</span> <span class="n">number</span> <span class="ow">is</span> <span class="k">for</span> <span class="n">subject</span><span class="o">-</span><span class="mi">11</span> <span class="n">run</span><span class="o">-</span><span class="mi">01</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intnorm</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_intnorm&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span> <span class="s1">&#39;op_string&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;intnorm&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">maskfunc3</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">intnorm</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>

<span class="c1"># Define a function to get the scaling factor for intensity normalization</span>
<span class="k">def</span> <span class="nf">getinormscale</span><span class="p">(</span><span class="n">medianvals</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;-mul </span><span class="si">%.10f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">10000.</span> <span class="o">/</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">medianvals</span><span class="p">]</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">medianval</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;out_stat&#39;</span><span class="p">,</span> <span class="n">getinormscale</span><span class="p">),</span> <span class="n">intnorm</span><span class="p">,</span> <span class="s1">&#39;op_string&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="temporal-filtering">
<h3>Temporal Filtering<a class="headerlink" href="#temporal-filtering" title="Permalink to this heading">#</a></h3>
<p>Perform temporal highpass filtering on the data</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_intnorm</span> <span class="o">-</span><span class="n">Tmean</span> <span class="n">tempMean</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_intnorm</span> <span class="o">-</span><span class="n">bptf</span> <span class="mf">25.0</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="n">add</span> <span class="n">tempMean</span> <span class="n">prefiltered_func_data_tempfilt</span>
</pre></div>
</div>
<p>The output of <code class="docutils literal notranslate"><span class="pre">highpass</span></code> (i.e., <code class="docutils literal notranslate"><span class="pre">sub-11_task-flanker_run-1_bold_dtype_mcf_mask_smooth_mask_intnorm_tempfilt.nii.gz</span></code>) is equivalent to <code class="docutils literal notranslate"><span class="pre">filtered_func_data.nii.gz</span></code> from FSL GUI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a mean functional image from the scaled data and this mean func will be used in performing temporal highpass filtering</span>
<span class="n">meanfunc3</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-Tmean&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;meanfunc3&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">intnorm</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">meanfunc3</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform temporal highpass filtering on the data</span>
<span class="n">hpcutoff</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">TR</span> <span class="o">=</span> <span class="mf">2.</span>  <span class="c1"># ensure float</span>

<span class="n">highpass</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_tempfilt&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;highpass&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;op_string&#39;</span><span class="p">])</span>

<span class="c1"># 25 = (hpcutoff / 2*TR) not (hpcutoff / TR)</span>
<span class="k">def</span> <span class="nf">gethpstring</span><span class="p">(</span><span class="n">tempMean</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;-bptf 25 -1 -add </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tm</span><span class="p">)</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">tempMean</span><span class="p">]</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">intnorm</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">highpass</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">meanfunc3</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span><span class="n">gethpstring</span><span class="p">),</span> <span class="n">highpass</span><span class="p">,</span> <span class="s1">&#39;op_string&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Generate a mean functional image from the functional run</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">prefiltered_func_data_tempfilt</span> <span class="n">filtered_func_data</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">filtered_func_data</span> <span class="o">-</span><span class="n">Tmean</span> <span class="n">mean_func</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meanfunc4</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-Tmean&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_mean&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;meanfunc4&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">highpass</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">meanfunc4</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="first-level-glm">
<h2>First-Level GLM<a class="headerlink" href="#first-level-glm" title="Permalink to this heading">#</a></h2>
<section id="get-events">
<h3>Get events<a class="headerlink" href="#get-events" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">subjinfo</span><span class="p">(</span><span class="n">events</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">nipype.interfaces.base</span> <span class="kn">import</span> <span class="n">Bunch</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

    <span class="n">subject_info</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">ev</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ev</span> <span class="o">=</span> <span class="n">ev</span><span class="p">[</span><span class="n">ev</span><span class="p">[</span><span class="s1">&#39;correctness&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;correct&#39;</span><span class="p">]</span>
    <span class="n">ev</span><span class="p">[</span><span class="s1">&#39;new_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ev</span><span class="p">[</span><span class="s1">&#39;trial_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">run_info</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">onsets</span><span class="o">=</span><span class="p">[],</span> 
                     <span class="n">durations</span><span class="o">=</span><span class="p">[])</span>

    <span class="n">run_info</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">ev</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;new_type&quot;</span><span class="p">)])</span>

    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">ev</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;new_type&quot;</span><span class="p">):</span>
        <span class="n">run_info</span><span class="o">.</span><span class="n">onsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="n">run_info</span><span class="o">.</span><span class="n">durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="n">subject_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run_info</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">subject_info</span>

<span class="n">get_sub_info</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">Function</span><span class="p">(</span>
        <span class="n">function</span><span class="o">=</span><span class="n">subjinfo</span><span class="p">,</span> <span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;events&quot;</span><span class="p">],</span> <span class="n">output_names</span><span class="o">=</span><span class="s2">&quot;subject_info&quot;</span>
    <span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;get_sub_info&quot;</span><span class="p">,</span> <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;events&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Connect to workflow</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_first</span><span class="p">,</span> <span class="s1">&#39;events&#39;</span><span class="p">,</span> <span class="n">get_sub_info</span><span class="p">,</span> <span class="s1">&#39;events&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-up-contrasts">
<h3>Set-up contrasts<a class="headerlink" href="#set-up-contrasts" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">condition_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;congruent&quot;</span><span class="p">,</span> <span class="s2">&quot;incongruent&quot;</span><span class="p">]</span>

<span class="c1"># Activation Contrasts (similar to https://direct.mit.edu/jocn/article/23/10/3162/5327/Is-Morality-Unified-Evidence-that-Distinct-Neural)</span>
<span class="c1">## From FEAT: &quot;The correct way to tell whether two conditions are significantly different is to run a differential contrast like [1 -1] between them&quot;</span>
<span class="n">cont01</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;congruent&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">cont02</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;incongruent&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">cont03</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;congruent-incongruent&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">cont04</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;incongruent-congruent&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span>  <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">contrast_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cont01</span><span class="p">,</span>
    <span class="n">cont02</span><span class="p">,</span>
    <span class="n">cont03</span><span class="p">,</span>
    <span class="n">cont04</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TR</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># Repetition Time</span>
<span class="n">hpcutoff</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># highpass filter cutoff in seconds! </span>

<span class="n">modelspec</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">SpecifyModel</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;modelspec&quot;</span><span class="p">,</span> <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;subject_info&quot;</span><span class="p">,</span><span class="s2">&quot;functional_runs&quot;</span><span class="p">])</span>
<span class="n">modelspec</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">input_units</span> <span class="o">=</span> <span class="s2">&quot;secs&quot;</span>
<span class="n">modelspec</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">high_pass_filter_cutoff</span> <span class="o">=</span> <span class="n">hpcutoff</span>
<span class="n">modelspec</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_repetition</span> <span class="o">=</span> <span class="n">TR</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">get_sub_info</span><span class="p">,</span> <span class="s1">&#39;subject_info&#39;</span><span class="p">,</span> <span class="n">modelspec</span><span class="p">,</span><span class="s1">&#39;subject_info&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">highpass</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span><span class="n">modelspec</span><span class="p">,</span><span class="s1">&#39;functional_runs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">level1design</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">Level1Design</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level1design&quot;</span><span class="p">,</span> <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;session_info&quot;</span><span class="p">])</span>
<span class="n">level1design</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">interscan_interval</span> <span class="o">=</span> <span class="n">TR</span>
<span class="c1"># Set HRF bases functions</span>
<span class="n">level1design</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">bases</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;derivs&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;gammasigma&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;gammadelay&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">}}</span>
<span class="n">level1design</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">model_serial_correlations</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">level1design</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">contrasts</span> <span class="o">=</span> <span class="n">contrast_list</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">modelspec</span><span class="p">,</span><span class="s1">&#39;session_info&#39;</span><span class="p">,</span> <span class="n">level1design</span><span class="p">,</span> <span class="s1">&#39;session_info&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelgen</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">FEATModel</span><span class="p">(),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;modelgen&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fsf_file&#39;</span><span class="p">,</span> <span class="s1">&#39;ev_files&#39;</span><span class="p">])</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">level1design</span><span class="p">,</span> <span class="n">modelgen</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;fsf_files&#39;</span><span class="p">,</span> <span class="s1">&#39;fsf_file&#39;</span><span class="p">),</span> 
                                    <span class="p">(</span><span class="s1">&#39;ev_files&#39;</span><span class="p">,</span><span class="s1">&#39;ev_files&#39;</span><span class="p">)])])</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Corresponding fsl command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">film_gls</span> <span class="o">--</span><span class="ow">in</span><span class="o">=</span><span class="n">filtered_func_data</span> <span class="o">--</span><span class="n">rn</span><span class="o">=</span><span class="n">stats</span> <span class="o">--</span><span class="n">pd</span><span class="o">=</span><span class="n">design</span><span class="o">.</span><span class="n">mat</span> <span class="o">--</span><span class="n">thr</span><span class="o">=</span><span class="mf">1000.0</span> <span class="o">--</span><span class="n">sa</span> <span class="o">--</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span> <span class="o">--</span><span class="n">con</span><span class="o">=</span><span class="n">design</span><span class="o">.</span><span class="n">con</span>  

<span class="o">--</span><span class="n">thr</span><span class="p">:</span> <span class="n">threshold</span>
<span class="o">--</span><span class="n">sa</span><span class="p">:</span> <span class="n">smooth_autocorr</span>
<span class="o">--</span><span class="n">ms</span><span class="p">:</span> <span class="n">mask_size</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">level1estimate</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">FILMGLS</span><span class="p">(</span><span class="n">smooth_autocorr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mask_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;level1estimate&#39;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;design_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">,</span> <span class="s1">&#39;tcon_file&#39;</span><span class="p">])</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
    <span class="p">(</span><span class="n">highpass</span><span class="p">,</span><span class="n">level1estimate</span><span class="p">,[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span><span class="s1">&#39;in_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">modelgen</span><span class="p">,</span><span class="n">level1estimate</span><span class="p">,[(</span><span class="s1">&#39;design_file&#39;</span><span class="p">,</span><span class="s1">&#39;design_file&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s1">&#39;con_file&#39;</span><span class="p">,</span><span class="s1">&#39;tcon_file&#39;</span><span class="p">)])</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>no need to use <code class="docutils literal notranslate"><span class="pre">ContrastMgr</span></code>,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="n">interface</span> <span class="n">mode</span> <span class="n">this</span> <span class="n">file</span> <span class="n">assumes</span> <span class="n">that</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">required</span> <span class="n">inputs</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">location</span><span class="o">.</span> <span class="n">This</span> <span class="n">has</span> <span class="n">deprecated</span> <span class="k">for</span> <span class="n">FSL</span> <span class="n">versions</span> <span class="mf">5.0.7</span><span class="o">+</span> <span class="k">as</span> <span class="n">the</span> <span class="n">necessary</span> <span class="n">corrections</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">longer</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">FILMGLS</span><span class="o">.</span>
</pre></div>
</div>
<p>see this <a class="reference external" href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.interfaces.fsl.model.html#contrastmgr">link</a></p>
</section>
</section>
<section id="registration">
<h2>Registration<a class="headerlink" href="#registration" title="Permalink to this heading">#</a></h2>
<p>According to <a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide#Higher-Level_FEAT_Output">FSL UserGuide</a>, the different sessions need to be <strong>registered</strong> to each other before any multi-session or multi-subject analyses can be carried out. Registration inside FEAT uses <code class="docutils literal notranslate"><span class="pre">FLIRT</span></code> and is a two-statge process:</p>
<ol class="arabic simple">
<li><p>An example FMRI low resolution image is registered to an example high resolution image (normally the same subject’s T1-weighted structural). The transformation for this is saved into the FEAT directory. Then the high res image is registered to a standard image (normally a T1-weighted image in standard space, such as the MNI 152 average image).</p></li>
<li><p>The two transformations are combined into a third, which will take the low resolution FMRI images (and the statistic images derived from the first-level analyses) straight into standard space, when applied later, during group analysis.</p></li>
</ol>
<section id="step-1">
<h3>Step 1<a class="headerlink" href="#step-1" title="Permalink to this heading">#</a></h3>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">flirt</span> <span class="o">-</span><span class="ow">in</span> <span class="n">example_func</span> <span class="o">-</span><span class="n">ref</span> <span class="n">standard</span> <span class="o">-</span><span class="n">out</span> <span class="n">example_func2standard</span> <span class="o">-</span><span class="n">omat</span> <span class="n">example_func2standard</span><span class="o">.</span><span class="n">mat</span> <span class="o">-</span><span class="n">cost</span> <span class="n">corratio</span> <span class="o">-</span><span class="n">dof</span> <span class="mi">12</span> <span class="o">-</span><span class="n">searchrx</span> <span class="o">-</span><span class="mi">90</span> <span class="mi">90</span> <span class="o">-</span><span class="n">searchry</span> <span class="o">-</span><span class="mi">90</span> <span class="mi">90</span> <span class="o">-</span><span class="n">searchrz</span> <span class="o">-</span><span class="mi">90</span> <span class="mi">90</span> <span class="o">-</span><span class="n">interp</span> <span class="n">trilinear</span> 

<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">convert_xfm</span> <span class="o">-</span><span class="n">inverse</span> <span class="o">-</span><span class="n">omat</span> <span class="n">standard2example_func</span><span class="o">.</span><span class="n">mat</span> <span class="n">example_func2standard</span><span class="o">.</span><span class="n">mat</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flt</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">FLIRT</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="s1">&#39;corratio&#39;</span><span class="p">,</span> <span class="n">dof</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                    <span class="n">searchr_x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span>
                                    <span class="n">searchr_y</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span>
                                    <span class="n">searchr_z</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span>
                                    <span class="n">interp</span> <span class="o">=</span> <span class="s1">&#39;trilinear&#39;</span><span class="p">),</span> 
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;example_func2standard&#39;</span><span class="p">,</span>
               <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>

<span class="n">flt</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">fsl</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">standard_image</span><span class="p">(</span><span class="s1">&#39;MNI152_T1_2mm_brain.nii.gz&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">extract_ref</span><span class="p">,</span> <span class="s1">&#39;roi_file&#39;</span><span class="p">,</span> <span class="n">flt</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>

<span class="n">convertxfm</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ConvertXFM</span><span class="p">(</span><span class="n">invert_xfm</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> 
                         <span class="n">name</span><span class="o">=</span><span class="s1">&#39;convertxfm&#39;</span><span class="p">,</span>
                         <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">flt</span><span class="p">,</span> <span class="s1">&#39;out_matrix_file&#39;</span><span class="p">,</span> <span class="n">convertxfm</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2">
<h3>Step 2<a class="headerlink" href="#step-2" title="Permalink to this heading">#</a></h3>
<p><strong>Corresponding fsl command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">flirt</span> <span class="o">-</span><span class="n">ref</span> <span class="n">reg</span><span class="o">/</span><span class="n">standard</span> <span class="o">-</span><span class="ow">in</span> <span class="n">stats</span><span class="o">/</span><span class="n">cope1</span> <span class="o">-</span><span class="n">out</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">scratch</span><span class="o">/</span><span class="n">yc</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="n">nipype_fsl_comp</span><span class="o">/</span><span class="n">gui</span><span class="o">/</span><span class="n">sub</span><span class="o">-</span><span class="mi">01</span><span class="o">/</span><span class="n">run1</span><span class="o">.</span><span class="n">feat</span><span class="o">/</span><span class="n">frgrot_chksugax</span> <span class="o">-</span><span class="n">applyxfm</span> <span class="o">-</span><span class="n">init</span> <span class="n">reg</span><span class="o">/</span><span class="n">example_func2standard</span><span class="o">.</span><span class="n">mat</span> <span class="o">-</span><span class="n">interp</span> <span class="n">trilinear</span> <span class="o">-</span><span class="n">datatype</span> <span class="nb">float</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">warp_files</span><span class="p">(</span><span class="n">copes</span><span class="p">,</span> <span class="n">varcopes</span><span class="p">,</span> <span class="n">masks</span><span class="p">,</span> <span class="n">mat</span><span class="p">):</span>
    <span class="c1"># need to reimport here, otherwise errors come out</span>
    <span class="kn">import</span> <span class="nn">nipype.interfaces.fsl</span> <span class="k">as</span> <span class="nn">fsl</span> 
    
    <span class="n">out_copes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">out_varcopes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">out_masks</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># register mask, same function, different parameters</span>
    <span class="n">warp_mask</span> <span class="o">=</span> <span class="n">fsl</span><span class="o">.</span><span class="n">FLIRT</span><span class="p">(</span><span class="n">apply_xfm</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
                     <span class="n">interp</span> <span class="o">=</span> <span class="s1">&#39;nearestneighbour&#39;</span><span class="p">)</span>
    <span class="n">warp_mask</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">fsl</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">standard_image</span><span class="p">(</span><span class="s1">&#39;MNI152_T1_2mm_brain.nii.gz&#39;</span><span class="p">)</span>
    <span class="n">warp_mask</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_matrix_file</span> <span class="o">=</span> <span class="n">mat</span>
    <span class="n">warp_mask</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">output_type</span> <span class="o">=</span> <span class="s2">&quot;NIFTI_GZ&quot;</span>
    <span class="n">warp_mask</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="n">masks</span>
    <span class="n">res_mask</span> <span class="o">=</span> <span class="n">warp_mask</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">out_masks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res_mask</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">out_file</span><span class="p">))</span>
    
    <span class="c1"># register copes &amp; varcopes using same function, different parameters</span>
    <span class="n">warp</span> <span class="o">=</span> <span class="n">fsl</span><span class="o">.</span><span class="n">FLIRT</span><span class="p">(</span><span class="n">apply_xfm</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
                     <span class="n">interp</span> <span class="o">=</span> <span class="s1">&#39;trilinear&#39;</span><span class="p">)</span>
    <span class="n">warp</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">fsl</span><span class="o">.</span><span class="n">Info</span><span class="o">.</span><span class="n">standard_image</span><span class="p">(</span><span class="s1">&#39;MNI152_T1_2mm_brain.nii.gz&#39;</span><span class="p">)</span>
    <span class="n">warp</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_matrix_file</span> <span class="o">=</span> <span class="n">mat</span>
    <span class="n">warp</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">output_type</span> <span class="o">=</span> <span class="s2">&quot;NIFTI_GZ&quot;</span>
    
    <span class="c1"># register copes</span>
    <span class="k">for</span> <span class="n">cope</span> <span class="ow">in</span> <span class="n">copes</span><span class="p">:</span>
        <span class="n">warp</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="n">cope</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">warp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">out_copes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">out_file</span><span class="p">))</span>
        
     <span class="c1"># register varcopes</span>
    <span class="k">for</span> <span class="n">varcope</span> <span class="ow">in</span> <span class="n">varcopes</span><span class="p">:</span>
        <span class="n">warp</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="n">varcope</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">warp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">out_varcopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">out_file</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">out_copes</span><span class="p">,</span> <span class="n">out_varcopes</span><span class="p">,</span> <span class="n">out_masks</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warpfunc</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">MapNode</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;copes&#39;</span><span class="p">,</span> <span class="s1">&#39;varcopes&#39;</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">,</span> <span class="s1">&#39;mat&#39;</span><span class="p">],</span>
                                    <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out_copes&#39;</span><span class="p">,</span> <span class="s1">&#39;out_varcopes&#39;</span><span class="p">,</span> <span class="s1">&#39;out_masks&#39;</span><span class="p">],</span>
                                    <span class="n">function</span><span class="o">=</span><span class="n">warp_files</span><span class="p">),</span>
                      <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;copes&#39;</span><span class="p">,</span> <span class="s1">&#39;varcopes&#39;</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">,</span><span class="s1">&#39;mat&#39;</span><span class="p">],</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;warpfunc&#39;</span><span class="p">)</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">level1estimate</span><span class="p">,</span> <span class="s1">&#39;copes&#39;</span><span class="p">,</span> <span class="n">warpfunc</span><span class="p">,</span> <span class="s1">&#39;copes&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">level1estimate</span><span class="p">,</span> <span class="s1">&#39;varcopes&#39;</span><span class="p">,</span> <span class="n">warpfunc</span><span class="p">,</span> <span class="s1">&#39;varcopes&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dilatemask</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">warpfunc</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">flt</span><span class="p">,</span> <span class="s1">&#39;out_matrix_file&#39;</span><span class="p">,</span> <span class="n">warpfunc</span><span class="p">,</span> <span class="s1">&#39;mat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save all results into single/separate folder for further analysis use</span>
<span class="n">datasink_first</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">nio</span><span class="o">.</span><span class="n">DataSink</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sinker&#39;</span><span class="p">)</span>
<span class="n">datasink_first</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exp_dir_first</span><span class="p">,</span> <span class="s2">&quot;level1_results&quot;</span><span class="p">)</span>

<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">infosource_first</span><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="n">datasink_first</span><span class="p">,</span> <span class="s1">&#39;container&#39;</span><span class="p">)</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">level1estimate</span><span class="p">,</span> <span class="n">datasink_first</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;results_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;results_dir&#39;</span><span class="p">)])])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">warpfunc</span><span class="p">,</span> <span class="n">datasink_first</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_copes&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_copes&#39;</span><span class="p">)])])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">warpfunc</span><span class="p">,</span> <span class="n">datasink_first</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_varcopes&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_varcopes&#39;</span><span class="p">)])])</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">warpfunc</span><span class="p">,</span> <span class="n">datasink_first</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_masks&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_masks&#39;</span><span class="p">)])])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create 1st-level analysis output graph</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Visualize the graph</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wf_first</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">wf_first</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;graph.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">44</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Create 1st-level analysis output graph</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">wf_first</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Visualize the graph</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/workflows.py:465,</span> in <span class="ni">Workflow.write_graph</span><span class="nt">(self, dotfilename, graph2use, format, simple_form)</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>     <span class="n">dotfilename</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">dotfilename</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span>     <span class="bp">self</span><span class="o">.</span><span class="n">write_hierarchical_dotfile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span>         <span class="n">dotfilename</span><span class="o">=</span><span class="n">dotfilename</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span>         <span class="n">colored</span><span class="o">=</span><span class="n">graph2use</span> <span class="o">==</span> <span class="s2">&quot;colored&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>         <span class="n">simple_form</span><span class="o">=</span><span class="n">simple_form</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">465</span>     <span class="n">outfname</span> <span class="o">=</span> <span class="n">format_dot</span><span class="p">(</span><span class="n">dotfilename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">466</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span>     <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1405,</span> in <span class="ni">format_dot</span><span class="nt">(dotfilename, format)</span>
<span class="g g-Whitespace">   </span><span class="mi">1403</span>         <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Cannot draw directed graph; executable &#39;dot&#39; is unavailable&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1404</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1405</span>         <span class="k">raise</span> <span class="n">ioe</span>
<span class="g g-Whitespace">   </span><span class="mi">1406</span> <span class="k">return</span> <span class="n">formatted_dot</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1400,</span> in <span class="ni">format_dot</span><span class="nt">(dotfilename, format)</span>
<span class="g g-Whitespace">   </span><span class="mi">1398</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Dump a directed graph (Linux only; install via `brew` on OSX)&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1399</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1400</span>     <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_run_dot</span><span class="p">(</span><span class="n">dotfilename</span><span class="p">,</span> <span class="n">format_ext</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1401</span> <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">ioe</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1402</span>     <span class="k">if</span> <span class="s2">&quot;could not be found&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">):</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1416,</span> in <span class="ni">_run_dot</span><span class="nt">(dotfilename, format_ext)</span>
<span class="g g-Whitespace">   </span><span class="mi">1414</span> <span class="n">formatted_dot</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dot_base</span><span class="p">,</span> <span class="n">format_ext</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1415</span> <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;dot -T</span><span class="si">{}</span><span class="s1"> -o&quot;</span><span class="si">{}</span><span class="s1">&quot; &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">format_ext</span><span class="p">,</span> <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">dotfilename</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1416</span> <span class="n">res</span> <span class="o">=</span> <span class="n">CommandLine</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">terminal_output</span><span class="o">=</span><span class="s2">&quot;allatonce&quot;</span><span class="p">,</span> <span class="n">resource_monitor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1417</span> <span class="k">return</span> <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">res</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py:397,</span> in <span class="ni">BaseInterface.run</span><span class="nt">(self, cwd, ignore_exception, **inputs)</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span> <span class="c1"># Run interface</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_run_hook</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">397</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_interface</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_run_hook</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span> <span class="c1"># Collect outputs</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py:752,</span> in <span class="ni">CommandLine._run_interface</span><span class="nt">(self, runtime, correct_return_codes)</span>
<span class="g g-Whitespace">    </span><span class="mi">749</span> <span class="n">cmd_path</span> <span class="o">=</span> <span class="n">which</span><span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">runtime</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">751</span> <span class="k">if</span> <span class="n">cmd_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">752</span>     <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">753</span>         <span class="s1">&#39;No command &quot;</span><span class="si">%s</span><span class="s1">&quot; found on host </span><span class="si">%s</span><span class="s1">. Please check that the &#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">754</span>         <span class="s2">&quot;corresponding package is installed.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">755</span>         <span class="o">%</span> <span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">runtime</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">756</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">758</span> <span class="n">runtime</span><span class="o">.</span><span class="n">command_path</span> <span class="o">=</span> <span class="n">cmd_path</span>
<span class="g g-Whitespace">    </span><span class="mi">759</span> <span class="n">runtime</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">760</span>     <span class="n">get_dependencies</span><span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">runtime</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">761</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ldd</span>
<span class="g g-Whitespace">    </span><span class="mi">762</span>     <span class="k">else</span> <span class="s2">&quot;&lt;skipped&gt;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">763</span> <span class="p">)</span>

<span class="ne">OSError</span>: No command &quot;dot&quot; found on host fv-az96-114. Please check that the corresponding package is installed.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;nipype.workflow&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#set to 1 if nipype output is wanted</span>
<span class="c1"># Run Workflow</span>
<span class="n">wf_first</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plugin</span><span class="o">=</span><span class="s2">&quot;MultiProc&quot;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_procs&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:26,627 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:26,633 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:26,646 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:26,644 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:27,358 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:27,361 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011427-runner-_example_func2standard0-ef047ce6-987d-4639-917e-c751fb859d5c.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/extractref/mapflow/_extractref0/sub-01_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-01_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-01_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/example_func2standard/mapflow/_example_func2standard0/sub-01_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/example_func2standard/mapflow/_example_func2standard0/sub-01_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:27,363 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:27,365 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011427-runner-_example_func2standard1-55f8d946-1133-42c3-a78b-d1cfbb78b623.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/extractref/mapflow/_extractref1/sub-01_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-01_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-01_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/example_func2standard/mapflow/_example_func2standard1/sub-01_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/example_func2standard/mapflow/_example_func2standard1/sub-01_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:30,639 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:30,655 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_02/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:30,724 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:30,734 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_02/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:31,361 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:31,363 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011431-runner-_example_func2standard0-b4852998-39a1-40c3-881a-183f7b79ee5f.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_02/extractref/mapflow/_extractref0/sub-02_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-02_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-02_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_02/example_func2standard/mapflow/_example_func2standard0/sub-02_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_02/example_func2standard/mapflow/_example_func2standard0/sub-02_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:31,364 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:31,367 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011431-runner-_example_func2standard1-955f17a5-cf6b-400a-9c6e-5ab4f308162c.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_02/extractref/mapflow/_extractref1/sub-02_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-02_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-02_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_02/example_func2standard/mapflow/_example_func2standard1/sub-02_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_02/example_func2standard/mapflow/_example_func2standard1/sub-02_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:32,603 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:32,618 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_03/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:33,361 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:33,362 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011433-runner-_example_func2standard0-ee519602-bc99-49d6-b002-5479750c0216.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_03/extractref/mapflow/_extractref0/sub-03_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-03_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-03_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_03/example_func2standard/mapflow/_example_func2standard0/sub-03_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_03/example_func2standard/mapflow/_example_func2standard0/sub-03_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:34,780 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:34,801 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_03/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:35,362 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:14:35,363 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011435-runner-_example_func2standard1-7f400f0c-1c64-41fb-bae1-a2846fdbb08d.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_03/extractref/mapflow/_extractref1/sub-03_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-03_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-03_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_03/example_func2standard/mapflow/_example_func2standard1/sub-03_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_03/example_func2standard/mapflow/_example_func2standard1/sub-03_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:36,798 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:36,824 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_04/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:37,481 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:37,482 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011637-runner-_example_func2standard0-9bcbe9b8-07a2-486a-a7c6-5cec23222c39.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_04/extractref/mapflow/_extractref0/sub-04_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-04_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-04_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_04/example_func2standard/mapflow/_example_func2standard0/sub-04_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_04/example_func2standard/mapflow/_example_func2standard0/sub-04_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:38,710 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:38,722 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_04/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:39,481 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:39,484 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011639-runner-_example_func2standard1-5d0d98b7-daf5-40ad-90f1-8725b6084ca1.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_04/extractref/mapflow/_extractref1/sub-04_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-04_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-04_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_04/example_func2standard/mapflow/_example_func2standard1/sub-04_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_04/example_func2standard/mapflow/_example_func2standard1/sub-04_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:46,617 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:46,632 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_05/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:47,488 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:47,490 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011647-runner-_example_func2standard0-ef0780a4-2e61-4bcd-9129-4f37b9c9d09e.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_05/extractref/mapflow/_extractref0/sub-05_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-05_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-05_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_05/example_func2standard/mapflow/_example_func2standard0/sub-05_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_05/example_func2standard/mapflow/_example_func2standard0/sub-05_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:48,578 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:48,606 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_05/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:49,489 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:49,491 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011649-runner-_example_func2standard1-83a223ff-7f07-4525-b59b-f9e92e8feaf5.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_05/extractref/mapflow/_extractref1/sub-05_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-05_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-05_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_05/example_func2standard/mapflow/_example_func2standard1/sub-05_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_05/example_func2standard/mapflow/_example_func2standard1/sub-05_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:50,865 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:50,880 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_06/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:50,876 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:50,893 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_06/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:51,489 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:51,490 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011651-runner-_example_func2standard0-63ad307d-b919-4778-ab00-4802e8e68855.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_06/extractref/mapflow/_extractref0/sub-06_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-06_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-06_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_06/example_func2standard/mapflow/_example_func2standard0/sub-06_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_06/example_func2standard/mapflow/_example_func2standard0/sub-06_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:51,494 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:51,495 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011651-runner-_example_func2standard1-78fe577a-cc1f-4e84-8bbd-15f93905d59e.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_06/extractref/mapflow/_extractref1/sub-06_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-06_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-06_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_06/example_func2standard/mapflow/_example_func2standard1/sub-06_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_06/example_func2standard/mapflow/_example_func2standard1/sub-06_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:56,718 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:56,729 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_07/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:57,493 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:57,494 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011657-runner-_example_func2standard0-55bbf259-f41f-49bd-abd8-8abdcf457ec4.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_07/extractref/mapflow/_extractref0/sub-07_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-07_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-07_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_07/example_func2standard/mapflow/_example_func2standard0/sub-07_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_07/example_func2standard/mapflow/_example_func2standard0/sub-07_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:58,932 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:58,949 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_07/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:59,494 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:16:59,495 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011659-runner-_example_func2standard1-e827bc60-20d5-4042-9f22-a5dc7d804912.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_07/extractref/mapflow/_extractref1/sub-07_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-07_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-07_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_07/example_func2standard/mapflow/_example_func2standard1/sub-07_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_07/example_func2standard/mapflow/_example_func2standard1/sub-07_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:18:56,747 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:18:56,755 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_08/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:18:57,599 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:18:57,600 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011857-runner-_example_func2standard0-8d9240ae-d3eb-4f91-8351-3aba3817bc3e.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_08/extractref/mapflow/_extractref0/sub-08_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-08_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-08_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_08/example_func2standard/mapflow/_example_func2standard0/sub-08_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_08/example_func2standard/mapflow/_example_func2standard0/sub-08_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:18:58,988 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:18:59,0 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_08/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:18:59,600 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:18:59,602 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011859-runner-_example_func2standard1-d4e9fe1e-43af-42b4-b3e9-4f5931cd2cd1.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_08/extractref/mapflow/_extractref1/sub-08_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-08_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-08_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_08/example_func2standard/mapflow/_example_func2standard1/sub-08_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_08/example_func2standard/mapflow/_example_func2standard1/sub-08_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:19:22,205 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:19:22,220 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard1&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_09/example_func2standard/mapflow/_example_func2standard1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:19:22,236 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:19:22,250 nipype.workflow WARNING:
	 [Node] Error on &quot;_example_func2standard0&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_09/example_func2standard/mapflow/_example_func2standard0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:19:23,621 nipype.workflow ERROR:
	 Node _example_func2standard0 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:19:23,623 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011923-runner-_example_func2standard0-11e9e925-8112-4c3d-a721-702bcc2184aa.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_09/extractref/mapflow/_extractref0/sub-09_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-09_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-09_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_09/example_func2standard/mapflow/_example_func2standard0/sub-09_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_09/example_func2standard/mapflow/_example_func2standard0/sub-09_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:19:23,626 nipype.workflow ERROR:
	 Node _example_func2standard1 failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:19:23,627 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-011923-runner-_example_func2standard1-9c8a3bbd-2796-4ef1-9249-213331ca8c23.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard1.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_09/extractref/mapflow/_extractref1/sub-09_task-flanker_run-2_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-09_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz -omat sub-09_task-flanker_run-2_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_09/example_func2standard/mapflow/_example_func2standard1/sub-09_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_09/example_func2standard/mapflow/_example_func2standard1/sub-09_task-flanker_run-2_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,233 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,234 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,235 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,235 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,236 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,237 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,237 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,238 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,238 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b4
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,239 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b4
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,239 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,240 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,240 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b6
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,241 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b6
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,242 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,242 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,243 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,243 nipype.workflow ERROR:
	 could not run node: level1.example_func2standard.b8
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
RuntimeError: Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node _example_func2standard0.

Cmdline:
	flirt -in /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/extractref/mapflow/_extractref0/sub-01_task-flanker_run-1_bold_dtype_roi.nii.gz -ref /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz -out sub-01_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz -omat sub-01_task-flanker_run-1_bold_dtype_roi_flirt.mat -cost corratio -dof 12 -interp trilinear -searchrx -90 90 -searchry -90 90 -searchrz -90 90
Stdout:

Stderr:
	Image Exception : #63 :: No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Image Exception : #22 :: Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
	Failed to read volume /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain.nii.gz
	Error : No image files match: /cvmfs/neurodesk.ardc.edu.au/containers/fsl_6.0.5.1_20221016/fsl_6.0.5.1_20221016.simg/opt/fsl-6.0.5.1/data/standard/MNI152_T1_2mm_brain
Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;out_file&#39; trait of a FLIRTOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/example_func2standard/mapflow/_example_func2standard0/sub-01_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/fsl/preprocess.py&quot;, line 742, in aggregate_outputs
	    outputs = super(FLIRT, self).aggregate_outputs(
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1/_subject_id_01/example_func2standard/mapflow/_example_func2standard0/sub-01_task-flanker_run-1_bold_dtype_roi_flirt.nii.gz&#39; for output &#39;out_file&#39; of a FLIRT interface



The above exception was the direct cause of the following exception:

RuntimeError                              Traceback (most recent call last)
Cell In[45], line 4
      2 logging.getLogger(&#39;nipype.workflow&#39;).setLevel(0) #set to 1 if nipype output is wanted
      3 # Run Workflow
----&gt; 4 wf_first.run(plugin=&quot;MultiProc&quot;, plugin_args={&quot;n_procs&quot;: 8})

File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/workflows.py:638, in Workflow.run(self, plugin, plugin_args, updatehash)
    636 if str2bool(self.config[&quot;execution&quot;][&quot;create_report&quot;]):
    637     self._write_report_info(self.base_dir, self.name, execgraph)
--&gt; 638 runner.run(execgraph, updatehash=updatehash, config=self.config)
    639 datestr = datetime.utcnow().strftime(&quot;%Y%m%dT%H%M%S&quot;)
    640 if str2bool(self.config[&quot;execution&quot;][&quot;write_provenance&quot;]):

File ~/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/base.py:224, in DistributedPluginBase.run(self, graph, config, updatehash)
    218 if len(errors) &gt; 1:
    219     error, cause = (
    220         RuntimeError(f&quot;{len(errors)} raised. Re-raising first.&quot;),
    221         error,
    222     )
--&gt; 224 raise error from cause

RuntimeError: 18 raised. Re-raising first.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="the-first-level-glm">
<h2>The first-level GLM<a class="headerlink" href="#the-first-level-glm" title="Permalink to this heading">#</a></h2>
<p>Here we randomly choose the four copes from subject-09 run-1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fsaverage</span> <span class="o">=</span> <span class="n">nilearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fetch_surf_fsaverage</span><span class="p">()</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nipype_cope1</span> <span class="o">=</span> <span class="s1">&#39;./output_level1/level1_results/09/results_dir/_subject_id_09/_level1estimate0/results/cope1.nii.gz&#39;</span>
<span class="n">nipype_cope2</span> <span class="o">=</span> <span class="s1">&#39;./output_level1/level1_results/09/results_dir/_subject_id_09/_level1estimate0/results/cope2.nii.gz&#39;</span>
<span class="n">nipype_cope3</span> <span class="o">=</span> <span class="s1">&#39;./output_level1/level1_results/09/results_dir/_subject_id_09/_level1estimate0/results/cope3.nii.gz&#39;</span>
<span class="n">nipype_cope4</span> <span class="o">=</span> <span class="s1">&#39;./output_level1/level1_results/09/results_dir/_subject_id_09/_level1estimate0/results/cope4.nii.gz&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE1&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE2&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE3&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope4</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE4&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">48</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE1&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE2&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/plotting/img_plotting.py:928,</span> in <span class="ni">plot_stat_map</span><span class="nt">(stat_map_img, bg_img, cut_coords, output_file, display_mode, colorbar, cbar_tick_format, figure, axes, title, threshold, annotate, draw_cross, black_bg, cmap, symmetric_cbar, dim, vmax, resampling_interpolation, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Plot cuts of an ROI/mask image (by default 3 cuts: Frontal, Axial, and</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span><span class="sd"> Lateral)</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">925</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">926</span><span class="sd"> &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
<span class="g g-Whitespace">    </span><span class="mi">927</span> <span class="c1"># dim the background</span>
<span class="ne">--&gt; </span><span class="mi">928</span> <span class="n">bg_img</span><span class="p">,</span> <span class="n">black_bg</span><span class="p">,</span> <span class="n">bg_vmin</span><span class="p">,</span> <span class="n">bg_vmax</span> <span class="o">=</span> <span class="n">_load_anat</span><span class="p">(</span><span class="n">bg_img</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">929</span>                                                 <span class="n">black_bg</span><span class="o">=</span><span class="n">black_bg</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">931</span> <span class="n">stat_map_img</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">check_niimg_3d</span><span class="p">(</span><span class="n">stat_map_img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">933</span> <span class="n">cbar_vmin</span><span class="p">,</span> <span class="n">cbar_vmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_get_colorbar_and_data_ranges</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">934</span>     <span class="n">_safe_get_data</span><span class="p">(</span><span class="n">stat_map_img</span><span class="p">,</span> <span class="n">ensure_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">935</span>     <span class="n">vmax</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="n">symmetric_cbar</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/plotting/img_plotting.py:374,</span> in <span class="ni">_load_anat</span><span class="nt">(anat_img, dim, black_bg)</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span>         <span class="n">black_bg</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">374</span>     <span class="n">anat_img</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">check_niimg_3d</span><span class="p">(</span><span class="n">anat_img</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span>     <span class="c1"># Clean anat_img for non-finite values to avoid computing unnecessary</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span>     <span class="c1"># border data values.</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">_safe_get_data</span><span class="p">(</span><span class="n">anat_img</span><span class="p">,</span> <span class="n">ensure_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:371,</span> in <span class="ni">check_niimg_3d</span><span class="nt">(niimg, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span> <span class="k">def</span> <span class="nf">check_niimg_3d</span><span class="p">(</span><span class="n">niimg</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Check that niimg is a proper 3D niimg-like object and load it.</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">340</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">370</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">371</span>     <span class="k">return</span> <span class="n">check_niimg</span><span class="p">(</span><span class="n">niimg</span><span class="p">,</span> <span class="n">ensure_ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:303,</span> in <span class="ni">check_niimg</span><span class="nt">(niimg, ensure_ndim, atleast_4d, dtype, return_iterator, wildcards)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">303</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span> <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">niimg</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: File not found: &#39;./output_level1/level1_results/09/results_dir/_subject_id_09/_level1estimate0/results/cope1.nii.gz&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="second-level-glm-using-nipype-fsl">
<h1>Second level GLM using Nipype FSL<a class="headerlink" href="#second-level-glm-using-nipype-fsl" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wf_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;level2&#39;</span><span class="p">,</span> <span class="n">base_dir</span><span class="o">=</span><span class="n">exp_dir_second</span><span class="p">)</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;execution&quot;</span><span class="p">][</span><span class="s2">&quot;crashfile_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;txt&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>The following two nodes (<code class="docutils literal notranslate"><span class="pre">infosource</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">dg</span></code>) together define all inputs required for the preprocessing workflow</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we want to group the outcome by contrast not subject</span>
<span class="n">contr_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">infosource_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">IdentityInterface</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contr_id&quot;</span><span class="p">]),</span>
                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;infosource_second&quot;</span><span class="p">)</span>
<span class="n">infosource_second</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;contr_id&quot;</span><span class="p">,</span> <span class="n">contr_list</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we use SelectFiles, instead of DataGrabber, because the former is more flexible with formatting syntax</span>
<span class="n">templates_second</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;reg_copes&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_copes/*/*/cope</span><span class="si">{contr_id}</span><span class="s2">_flirt.nii.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg_varcopes&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_varcopes/*/*/varcope</span><span class="si">{contr_id}</span><span class="s2">_flirt.nii.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg_masks&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_masks/*/*/*.nii.gz&quot;</span>
<span class="p">}</span>
<span class="n">dg_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">nio</span><span class="o">.</span><span class="n">SelectFiles</span><span class="p">(</span><span class="n">templates_second</span><span class="p">),</span>
             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;selectfiles_second&quot;</span><span class="p">)</span>
<span class="n">dg_second</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span> <span class="o">=</span> <span class="n">data_dir_second</span>

<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
        <span class="p">(</span><span class="n">infosource_second</span><span class="p">,</span> <span class="n">dg_second</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;contr_id&quot;</span><span class="p">,</span> <span class="s2">&quot;contr_id&quot;</span><span class="p">)])</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TraitError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">51</span><span class="p">],</span> <span class="n">line</span> <span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">templates_second</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="s2">&quot;reg_copes&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_copes/*/*/cope</span><span class="si">{contr_id}</span><span class="s2">_flirt.nii.gz&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="s2">&quot;reg_varcopes&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_varcopes/*/*/varcope</span><span class="si">{contr_id}</span><span class="s2">_flirt.nii.gz&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="s2">&quot;reg_masks&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_masks/*/*/*.nii.gz&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="p">}</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">dg_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">nio</span><span class="o">.</span><span class="n">SelectFiles</span><span class="p">(</span><span class="n">templates_second</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>              <span class="n">name</span><span class="o">=</span><span class="s2">&quot;selectfiles_second&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="n">dg_second</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span> <span class="o">=</span> <span class="n">data_dir_second</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>         <span class="p">(</span><span class="n">infosource_second</span><span class="p">,</span> <span class="n">dg_second</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;contr_id&quot;</span><span class="p">,</span> <span class="s2">&quot;contr_id&quot;</span><span class="p">)])</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="p">])</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py:135,</span> in <span class="ni">BasePath.validate</span><span class="nt">(self, objekt, name, value, return_pathlike)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">135</span>         <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">objekt</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_file</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>         <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">objekt</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/traits/base_trait_handler.py:74,</span> in <span class="ni">BaseTraitHandler.error</span><span class="nt">(self, object, name, value)</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Raises a TraitError exception.</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">60</span><span class="sd">     This method is called by the validate() method when an assigned value</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span><span class="sd">         The proposed new value for the attribute.</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">74</span>     <span class="k">raise</span> <span class="n">TraitError</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span>         <span class="nb">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_info</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">value</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span>     <span class="p">)</span>

<span class="ne">TraitError</span>: The &#39;base_directory&#39; trait of a SelectFilesInputSpec instance must be a pathlike object or string representing an existing directory, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level1/level1_results&#39; &lt;class &#39;str&#39;&gt; was specified.
</pre></div>
</div>
</div>
</div>
<section id="second-level-glm">
<h2>Second-level GLM<a class="headerlink" href="#second-level-glm" title="Permalink to this heading">#</a></h2>
<p>Combining results from multiple runs of one subject into one</p>
<section id="higher-level-input-files-preparation">
<h3>Higher-level input files preparation<a class="headerlink" href="#higher-level-input-files-preparation" title="Permalink to this heading">#</a></h3>
<section id="step-1-merge-registered-copes-varcopes-masks">
<h4>Step 1: Merge registered copes &amp; varcopes &amp; masks<a class="headerlink" href="#step-1-merge-registered-copes-varcopes-masks" title="Permalink to this heading">#</a></h4>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmerge</span> <span class="o">-</span><span class="n">t</span> <span class="n">mask</span> <span class="p">(</span><span class="n">masks</span> <span class="kn">from</span> <span class="nn">all</span> <span class="mi">52</span> <span class="n">inputs</span><span class="p">)</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmerge</span> <span class="o">-</span><span class="n">t</span> <span class="n">cope</span> <span class="p">(</span><span class="n">copes</span> <span class="kn">from</span> <span class="nn">all</span> <span class="mi">52</span> <span class="n">inputs</span><span class="p">)</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmerge</span> <span class="o">-</span><span class="n">t</span> <span class="n">varcop</span> <span class="p">(</span><span class="n">varcopes</span> <span class="kn">from</span> <span class="nn">all</span> <span class="mi">52</span> <span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">copemerge_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_files&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;copemerge_second&quot;</span><span class="p">)</span>

<span class="n">varcopemerge_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_files&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;varcopemerge_second&quot;</span><span class="p">)</span>

<span class="n">maskmerge_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_files&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maskmerge_second&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">sort_copes</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
    <span class="n">numelements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">outfiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numelements</span><span class="p">):</span>
        <span class="n">outfiles</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">elements</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
            <span class="n">outfiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">outfiles</span>

<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_second</span><span class="p">,</span> <span class="s1">&#39;reg_varcopes&#39;</span><span class="p">,</span> <span class="n">varcopemerge_second</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_second</span><span class="p">,</span> <span class="s1">&#39;reg_copes&#39;</span><span class="p">,</span> <span class="n">copemerge_second</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_second</span><span class="p">,</span> <span class="s1">&#39;reg_masks&#39;</span><span class="p">,</span> <span class="n">maskmerge_second</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-making-mask">
<h4>Step 2: Making mask<a class="headerlink" href="#step-2-making-mask" title="Permalink to this heading">#</a></h4>
<p>In FSL, there are many commands about <code class="docutils literal notranslate"><span class="pre">maskunique</span></code>, which is unless for the second level. We can ignore it.</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">mask</span> <span class="o">-</span><span class="n">Tmin</span> <span class="n">mask</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">minmask_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-Tmin&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;minmask_second&#39;</span><span class="p">)</span>

<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">maskmerge_second</span><span class="p">,</span> <span class="s1">&#39;merged_file&#39;</span><span class="p">,</span> <span class="n">minmask_second</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-masking-copes-varcopes">
<h4>Step 3: Masking copes &amp; varcopes<a class="headerlink" href="#step-3-masking-copes-varcopes" title="Permalink to this heading">#</a></h4>
<p><strong>Corresponding FSL command:</strong></p>
<p>we have four contrasts so the following commands repeat four times</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">cope1</span> <span class="o">-</span><span class="n">mas</span> <span class="n">mask</span> <span class="n">cope1</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">varcope1</span> <span class="o">-</span><span class="n">mas</span> <span class="n">mask</span> <span class="n">varcope1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maskcope_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-mas&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maskcope_second&#39;</span><span class="p">)</span>

<span class="n">maskvarcope_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-mas&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maskvarcope_second&#39;</span><span class="p">)</span>

<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">copemerge_second</span><span class="p">,</span> <span class="s1">&#39;merged_file&#39;</span><span class="p">,</span> <span class="n">maskcope_second</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">minmask_second</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">maskcope_second</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">)</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">varcopemerge_second</span><span class="p">,</span> <span class="s1">&#39;merged_file&#39;</span><span class="p">,</span> <span class="n">maskvarcope_second</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">minmask_second</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">maskvarcope_second</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="set-up-second-level-contrasts-and-fixed-effects">
<h3>Set up second-level contrasts and fixed-effects<a class="headerlink" href="#set-up-second-level-contrasts-and-fixed-effects" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_contrasts_l2</span><span class="p">(</span><span class="n">in_files</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_files</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">in_files</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
    <span class="n">n_sub</span> <span class="o">=</span> <span class="mi">9</span>  
    <span class="c1"># n_sub = 26</span>
    <span class="n">ev_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ev&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_sub</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">weight_mtx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sub</span><span class="p">,</span><span class="n">n_sub</span><span class="p">))</span>
    <span class="n">weight_mtx</span> <span class="o">=</span> <span class="n">weight_mtx</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">weight_mtx</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
    <span class="c1">#contr = [&#39;&#39;,&#39;T&#39;,ev_list,list(weight_mtx[0])] --&gt; original paper</span>
    <span class="n">contr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">ev_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">weight_mtx</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span> <span class="c1">#adaptation so the construction of the array works</span>
    <span class="n">contr_lst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">contr</span><span class="p">,</span> <span class="p">(</span><span class="n">n_sub</span><span class="p">,</span><span class="n">n_sub</span><span class="p">))</span>
    <span class="n">contr_lst</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">contr_lst</span><span class="p">]</span> 
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sub</span><span class="p">):</span>
        <span class="c1"># Instead of trying to change the tuple, create a new tuple with the changed value.</span>
        <span class="n">contr_lst</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">contr_lst</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">contr_lst</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">contr_lst</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="nb">list</span><span class="p">(</span><span class="n">weight_mtx</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="n">reg_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="kc">None</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ev_list</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">reg_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">start_lst</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">total</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">ev_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">start_idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">start_lst</span><span class="p">[</span><span class="n">start_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">start_lst</span><span class="p">[</span><span class="n">end_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">reg_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_lst</span>    
    <span class="k">return</span> <span class="n">contr_lst</span><span class="p">,</span> <span class="n">reg_dict</span>

<span class="n">contrastgen_l2</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_files&#39;</span><span class="p">],</span>
                                    <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;contr_lst&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_dict&#39;</span><span class="p">],</span>
                                    <span class="n">function</span><span class="o">=</span><span class="n">get_contrasts_l2</span><span class="p">),</span>
                      <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_files&#39;</span><span class="p">],</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contrastgen_l2&#39;</span><span class="p">)</span>

<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_second</span><span class="p">,</span><span class="s1">&#39;reg_copes&#39;</span><span class="p">,</span> <span class="n">contrastgen_l2</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nipype recommends using <a class="reference external" href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.interfaces.fsl.model.html#l2model">L2Model</a>, which only works for the single subject. It takes the number of runs (copes at the first level) as input and does estimations for subject one by one.
Instead, we use <a class="reference external" href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.interfaces.fsl.model.html#multipleregressdesign">MultipleRegressDesign</a>. As it’s name indicates, this one can deal with multiple predictors (subjects) at the same time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">level2model</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">MultipleRegressDesign</span><span class="p">(),</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;l2model&#39;</span><span class="p">)</span>

<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">contrastgen_l2</span><span class="p">,</span> <span class="n">level2model</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;contr_lst&#39;</span><span class="p">,</span><span class="s1">&#39;contrasts&#39;</span><span class="p">),</span>
                                        <span class="p">(</span><span class="s1">&#39;reg_dict&#39;</span><span class="p">,</span><span class="s1">&#39;regressors&#39;</span><span class="p">)])])</span>

<span class="n">level2estimate</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">FLAMEO</span><span class="p">(</span><span class="n">run_mode</span><span class="o">=</span><span class="s1">&#39;fe&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level2estimate&quot;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cope_file&#39;</span><span class="p">,</span> <span class="s1">&#39;var_cope_file&#39;</span><span class="p">])</span>

<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
    <span class="p">(</span><span class="n">maskcope_second</span><span class="p">,</span> <span class="n">level2estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;cope_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">maskvarcope_second</span><span class="p">,</span> <span class="n">level2estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;var_cope_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">minmask_second</span><span class="p">,</span> <span class="n">level2estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;mask_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">level2model</span><span class="p">,</span> <span class="n">level2estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;design_mat&#39;</span><span class="p">,</span> <span class="s1">&#39;design_file&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;design_con&#39;</span><span class="p">,</span> <span class="s1">&#39;t_con_file&#39;</span><span class="p">),</span> 
                                   <span class="p">(</span><span class="s1">&#39;design_grp&#39;</span><span class="p">,</span> <span class="s1">&#39;cov_split_file&#39;</span><span class="p">)]),</span>
<span class="p">])</span>

<span class="n">datasink_second</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">nio</span><span class="o">.</span><span class="n">DataSink</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sinker&#39;</span><span class="p">)</span>
<span class="n">datasink_second</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exp_dir_second</span><span class="p">,</span> <span class="s2">&quot;level2_results&quot;</span><span class="p">)</span>

<span class="n">int2string</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;contrast_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">infosource_second</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;contr_id&#39;</span><span class="p">,</span><span class="n">int2string</span><span class="p">),</span> <span class="n">datasink_second</span><span class="p">,</span> <span class="s1">&#39;container&#39;</span><span class="p">)</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">level2estimate</span><span class="p">,</span> <span class="n">datasink_second</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;stats_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;stats_dir&#39;</span><span class="p">)])])</span>

<span class="c1"># Create 1st-level analysis output graph</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Visualize the graph</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wf_second</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">wf_second</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;graph.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">56</span><span class="p">],</span> <span class="n">line</span> <span class="mi">30</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="n">wf_second</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">level2estimate</span><span class="p">,</span> <span class="n">datasink_second</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;stats_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;stats_dir&#39;</span><span class="p">)])])</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> <span class="c1"># Create 1st-level analysis output graph</span>
<span class="ne">---&gt; </span><span class="mi">30</span> <span class="n">wf_second</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span> <span class="c1"># Visualize the graph</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span> <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/workflows.py:465,</span> in <span class="ni">Workflow.write_graph</span><span class="nt">(self, dotfilename, graph2use, format, simple_form)</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>     <span class="n">dotfilename</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">dotfilename</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span>     <span class="bp">self</span><span class="o">.</span><span class="n">write_hierarchical_dotfile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span>         <span class="n">dotfilename</span><span class="o">=</span><span class="n">dotfilename</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span>         <span class="n">colored</span><span class="o">=</span><span class="n">graph2use</span> <span class="o">==</span> <span class="s2">&quot;colored&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>         <span class="n">simple_form</span><span class="o">=</span><span class="n">simple_form</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">465</span>     <span class="n">outfname</span> <span class="o">=</span> <span class="n">format_dot</span><span class="p">(</span><span class="n">dotfilename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">466</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span>     <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1405,</span> in <span class="ni">format_dot</span><span class="nt">(dotfilename, format)</span>
<span class="g g-Whitespace">   </span><span class="mi">1403</span>         <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Cannot draw directed graph; executable &#39;dot&#39; is unavailable&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1404</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1405</span>         <span class="k">raise</span> <span class="n">ioe</span>
<span class="g g-Whitespace">   </span><span class="mi">1406</span> <span class="k">return</span> <span class="n">formatted_dot</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1400,</span> in <span class="ni">format_dot</span><span class="nt">(dotfilename, format)</span>
<span class="g g-Whitespace">   </span><span class="mi">1398</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Dump a directed graph (Linux only; install via `brew` on OSX)&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1399</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1400</span>     <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_run_dot</span><span class="p">(</span><span class="n">dotfilename</span><span class="p">,</span> <span class="n">format_ext</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1401</span> <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">ioe</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1402</span>     <span class="k">if</span> <span class="s2">&quot;could not be found&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">):</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1416,</span> in <span class="ni">_run_dot</span><span class="nt">(dotfilename, format_ext)</span>
<span class="g g-Whitespace">   </span><span class="mi">1414</span> <span class="n">formatted_dot</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dot_base</span><span class="p">,</span> <span class="n">format_ext</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1415</span> <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;dot -T</span><span class="si">{}</span><span class="s1"> -o&quot;</span><span class="si">{}</span><span class="s1">&quot; &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">format_ext</span><span class="p">,</span> <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">dotfilename</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1416</span> <span class="n">res</span> <span class="o">=</span> <span class="n">CommandLine</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">terminal_output</span><span class="o">=</span><span class="s2">&quot;allatonce&quot;</span><span class="p">,</span> <span class="n">resource_monitor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1417</span> <span class="k">return</span> <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">res</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py:397,</span> in <span class="ni">BaseInterface.run</span><span class="nt">(self, cwd, ignore_exception, **inputs)</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span> <span class="c1"># Run interface</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_run_hook</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">397</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_interface</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_run_hook</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span> <span class="c1"># Collect outputs</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py:752,</span> in <span class="ni">CommandLine._run_interface</span><span class="nt">(self, runtime, correct_return_codes)</span>
<span class="g g-Whitespace">    </span><span class="mi">749</span> <span class="n">cmd_path</span> <span class="o">=</span> <span class="n">which</span><span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">runtime</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">751</span> <span class="k">if</span> <span class="n">cmd_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">752</span>     <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">753</span>         <span class="s1">&#39;No command &quot;</span><span class="si">%s</span><span class="s1">&quot; found on host </span><span class="si">%s</span><span class="s1">. Please check that the &#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">754</span>         <span class="s2">&quot;corresponding package is installed.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">755</span>         <span class="o">%</span> <span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">runtime</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">756</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">758</span> <span class="n">runtime</span><span class="o">.</span><span class="n">command_path</span> <span class="o">=</span> <span class="n">cmd_path</span>
<span class="g g-Whitespace">    </span><span class="mi">759</span> <span class="n">runtime</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">760</span>     <span class="n">get_dependencies</span><span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">runtime</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">761</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ldd</span>
<span class="g g-Whitespace">    </span><span class="mi">762</span>     <span class="k">else</span> <span class="s2">&quot;&lt;skipped&gt;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">763</span> <span class="p">)</span>

<span class="ne">OSError</span>: No command &quot;dot&quot; found on host fv-az96-114. Please check that the corresponding package is installed.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Workflow</span>
<span class="n">wf_second</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plugin</span><span class="o">=</span><span class="s2">&quot;MultiProc&quot;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_procs&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,952 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:31:58,960 nipype.workflow WARNING:
	 [Node] Error on &quot;level2.selectfiles_second&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level2/level2/selectfiles_second)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:32:00,762 nipype.workflow ERROR:
	 Node selectfiles_second failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:32:00,765 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-013200-runner-selectfiles_second-4e8feae1-3f57-41f9-8f96-3a1e14e6d3f1.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node selectfiles_second.

Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 429, in aggregate_outputs
	    predicted_outputs = self._list_outputs()  # Predictions from _list_outputs
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/io.py&quot;, line 1469, in _list_outputs
	    raise IOError(msg)
	OSError: No files were found matching reg_copes template: /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level2/level2/selectfiles_second/*/reg_copes/*/*/cope&lt;undefined&gt;_flirt.nii.gz
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:32:02,759 nipype.workflow ERROR:
	 could not run node: level2.selectfiles_second
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">57</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Run Workflow</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">wf_second</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plugin</span><span class="o">=</span><span class="s2">&quot;MultiProc&quot;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_procs&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/workflows.py:638,</span> in <span class="ni">Workflow.run</span><span class="nt">(self, plugin, plugin_args, updatehash)</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span> <span class="k">if</span> <span class="n">str2bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;execution&quot;</span><span class="p">][</span><span class="s2">&quot;create_report&quot;</span><span class="p">]):</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_write_report_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">execgraph</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">638</span> <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">execgraph</span><span class="p">,</span> <span class="n">updatehash</span><span class="o">=</span><span class="n">updatehash</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span> <span class="n">datestr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">T%H%M%S&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">640</span> <span class="k">if</span> <span class="n">str2bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;execution&quot;</span><span class="p">][</span><span class="s2">&quot;write_provenance&quot;</span><span class="p">]):</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/base.py:224,</span> in <span class="ni">DistributedPluginBase.run</span><span class="nt">(self, graph, config, updatehash)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="n">error</span><span class="p">,</span> <span class="n">cause</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>         <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2"> raised. Re-raising first.&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="n">error</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">224</span> <span class="k">raise</span> <span class="n">error</span> <span class="kn">from</span> <span class="nn">cause</span>

<span class="ne">RuntimeError</span>: Traceback (most recent call last):
  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">67</span><span class="p">,</span> <span class="ow">in</span> <span class="n">run_node</span>
    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">updatehash</span><span class="o">=</span><span class="n">updatehash</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">527</span><span class="p">,</span> <span class="ow">in</span> <span class="n">run</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_interface</span><span class="p">(</span><span class="n">execute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">645</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_run_interface</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_command</span><span class="p">(</span><span class="n">execute</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">771</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_run_command</span>
    <span class="k">raise</span> <span class="n">NodeExecutionError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="n">nipype</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">NodeExecutionError</span><span class="p">:</span> <span class="ne">Exception</span> <span class="n">raised</span> <span class="k">while</span> <span class="n">executing</span> <span class="n">Node</span> <span class="n">selectfiles_second</span><span class="o">.</span>

<span class="ne">Traceback</span>:
	<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
	  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">400</span><span class="p">,</span> <span class="ow">in</span> <span class="n">run</span>
	    <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregate_outputs</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
	  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">429</span><span class="p">,</span> <span class="ow">in</span> <span class="n">aggregate_outputs</span>
	    <span class="n">predicted_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_outputs</span><span class="p">()</span>  <span class="c1"># Predictions from _list_outputs</span>
	  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/io.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1469</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_list_outputs</span>
	    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
	<span class="ne">OSError</span><span class="p">:</span> <span class="n">No</span> <span class="n">files</span> <span class="n">were</span> <span class="n">found</span> <span class="n">matching</span> <span class="n">reg_copes</span> <span class="n">template</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runner</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">notebooks</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">notebooks</span><span class="o">/</span><span class="n">functional_imaging</span><span class="o">/</span><span class="n">output_level2</span><span class="o">/</span><span class="n">level2</span><span class="o">/</span><span class="n">selectfiles_second</span><span class="o">/*/</span><span class="n">reg_copes</span><span class="o">/*/*/</span><span class="n">cope</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;</span><span class="n">_flirt</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="the-second-level-glm">
<h2>The second-level GLM<a class="headerlink" href="#the-second-level-glm" title="Permalink to this heading">#</a></h2>
<p>Here we choose the four copes from subject-01</p>
<section id="regapply">
<h3>Regapply<a class="headerlink" href="#regapply" title="Permalink to this heading">#</a></h3>
<p>This happens before the second-level GLM, all results from the first level are needed to be registered into the standard space</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nipype_cope1</span> <span class="o">=</span> <span class="s1">&#39;./output_level1/level1_results/01/reg_copes/_subject_id_01/_warpfunc1/cope1_flirt.nii.gz&#39;</span>
<span class="n">nipype_cope2</span> <span class="o">=</span> <span class="s1">&#39;./output_level1/level1_results/01/reg_copes/_subject_id_01/_warpfunc1/cope2_flirt.nii.gz&#39;</span>
<span class="n">nipype_cope3</span> <span class="o">=</span> <span class="s1">&#39;./output_level1/level1_results/01/reg_copes/_subject_id_01/_warpfunc1/cope3_flirt.nii.gz&#39;</span>
<span class="n">nipype_cope4</span> <span class="o">=</span> <span class="s1">&#39;./output_level1/level1_results/01/reg_copes/_subject_id_01/_warpfunc1/cope4_flirt.nii.gz&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE1&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE2&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE3&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope4</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope4</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE4&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">59</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE1&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE2&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE3&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/plotting/img_plotting.py:928,</span> in <span class="ni">plot_stat_map</span><span class="nt">(stat_map_img, bg_img, cut_coords, output_file, display_mode, colorbar, cbar_tick_format, figure, axes, title, threshold, annotate, draw_cross, black_bg, cmap, symmetric_cbar, dim, vmax, resampling_interpolation, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Plot cuts of an ROI/mask image (by default 3 cuts: Frontal, Axial, and</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span><span class="sd"> Lateral)</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">925</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">926</span><span class="sd"> &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
<span class="g g-Whitespace">    </span><span class="mi">927</span> <span class="c1"># dim the background</span>
<span class="ne">--&gt; </span><span class="mi">928</span> <span class="n">bg_img</span><span class="p">,</span> <span class="n">black_bg</span><span class="p">,</span> <span class="n">bg_vmin</span><span class="p">,</span> <span class="n">bg_vmax</span> <span class="o">=</span> <span class="n">_load_anat</span><span class="p">(</span><span class="n">bg_img</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">929</span>                                                 <span class="n">black_bg</span><span class="o">=</span><span class="n">black_bg</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">931</span> <span class="n">stat_map_img</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">check_niimg_3d</span><span class="p">(</span><span class="n">stat_map_img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">933</span> <span class="n">cbar_vmin</span><span class="p">,</span> <span class="n">cbar_vmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_get_colorbar_and_data_ranges</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">934</span>     <span class="n">_safe_get_data</span><span class="p">(</span><span class="n">stat_map_img</span><span class="p">,</span> <span class="n">ensure_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">935</span>     <span class="n">vmax</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="n">symmetric_cbar</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/plotting/img_plotting.py:374,</span> in <span class="ni">_load_anat</span><span class="nt">(anat_img, dim, black_bg)</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span>         <span class="n">black_bg</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">374</span>     <span class="n">anat_img</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">check_niimg_3d</span><span class="p">(</span><span class="n">anat_img</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span>     <span class="c1"># Clean anat_img for non-finite values to avoid computing unnecessary</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span>     <span class="c1"># border data values.</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">_safe_get_data</span><span class="p">(</span><span class="n">anat_img</span><span class="p">,</span> <span class="n">ensure_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:371,</span> in <span class="ni">check_niimg_3d</span><span class="nt">(niimg, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span> <span class="k">def</span> <span class="nf">check_niimg_3d</span><span class="p">(</span><span class="n">niimg</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Check that niimg is a proper 3D niimg-like object and load it.</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">340</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">370</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">371</span>     <span class="k">return</span> <span class="n">check_niimg</span><span class="p">(</span><span class="n">niimg</span><span class="p">,</span> <span class="n">ensure_ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:303,</span> in <span class="ni">check_niimg</span><span class="nt">(niimg, ensure_ndim, atleast_4d, dtype, return_iterator, wildcards)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">303</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span> <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">niimg</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: File not found: &#39;./output_level1/level1_results/01/reg_copes/_subject_id_01/_warpfunc1/cope1_flirt.nii.gz&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="copes-from-the-second-level-glm">
<h3>Copes from the second-level GLM<a class="headerlink" href="#copes-from-the-second-level-glm" title="Permalink to this heading">#</a></h3>
<p>copes from subject-01</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nipype_cope1</span> <span class="o">=</span> <span class="s1">&#39;./output_level2/level2_results/contrast_1/stats_dir/_contr_id_1/stats/cope1.nii.gz&#39;</span>
<span class="n">nipype_cope2</span> <span class="o">=</span> <span class="s1">&#39;./output_level2/level2_results/contrast_2/stats_dir/_contr_id_2/stats/cope1.nii.gz&#39;</span>
<span class="n">nipype_cope3</span> <span class="o">=</span> <span class="s1">&#39;./output_level2/level2_results/contrast_3/stats_dir/_contr_id_3/stats/cope1.nii.gz&#39;</span>
<span class="n">nipype_cope4</span> <span class="o">=</span> <span class="s1">&#39;./output_level2/level2_results/contrast_4/stats_dir/_contr_id_4/stats/cope1.nii.gz&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE1&#39;</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE2&#39;</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span><span class="p">(</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE3&#39;</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span><span class="p">(</span><span class="n">nipype_cope4</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope4</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">61</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE1&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE2&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span><span class="p">(</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Nipype - COPE3&#39;</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/plotting/img_plotting.py:1030,</span> in <span class="ni">plot_glass_brain</span><span class="nt">(stat_map_img, output_file, display_mode, colorbar, cbar_tick_format, figure, axes, title, threshold, annotate, black_bg, cmap, alpha, vmin, vmax, plot_abs, symmetric_cbar, resampling_interpolation, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1027</span>     <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">cold_hot</span> <span class="k">if</span> <span class="n">black_bg</span> <span class="k">else</span> <span class="n">cm</span><span class="o">.</span><span class="n">cold_white_hot</span>
<span class="g g-Whitespace">   </span><span class="mi">1029</span> <span class="k">if</span> <span class="n">stat_map_img</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1030</span>     <span class="n">stat_map_img</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">check_niimg_3d</span><span class="p">(</span><span class="n">stat_map_img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1031</span>     <span class="k">if</span> <span class="n">plot_abs</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1032</span>         <span class="n">cbar_vmin</span><span class="p">,</span> <span class="n">cbar_vmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_get_colorbar_and_data_ranges</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1033</span>             <span class="n">_safe_get_data</span><span class="p">(</span><span class="n">stat_map_img</span><span class="p">,</span> <span class="n">ensure_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1034</span>             <span class="n">vmax</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1035</span>             <span class="n">symmetric_cbar</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1036</span>             <span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1037</span>             <span class="mi">0</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:371,</span> in <span class="ni">check_niimg_3d</span><span class="nt">(niimg, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span> <span class="k">def</span> <span class="nf">check_niimg_3d</span><span class="p">(</span><span class="n">niimg</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Check that niimg is a proper 3D niimg-like object and load it.</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">340</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">370</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">371</span>     <span class="k">return</span> <span class="n">check_niimg</span><span class="p">(</span><span class="n">niimg</span><span class="p">,</span> <span class="n">ensure_ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:303,</span> in <span class="ni">check_niimg</span><span class="nt">(niimg, ensure_ndim, atleast_4d, dtype, return_iterator, wildcards)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">303</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span> <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">niimg</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: File not found: &#39;./output_level2/level2_results/contrast_1/stats_dir/_contr_id_1/stats/cope1.nii.gz&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="third-level-glm-using-nipype-fsl">
<h1>Third-level GLM using Nipype FSL<a class="headerlink" href="#third-level-glm-using-nipype-fsl" title="Permalink to this heading">#</a></h1>
<p>Start the workflow</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wf_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;level3&#39;</span><span class="p">,</span> <span class="n">base_dir</span><span class="o">=</span><span class="n">exp_dir_third</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;execution&quot;</span><span class="p">][</span><span class="s2">&quot;crashfile_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;txt&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>The following two nodes (<code class="docutils literal notranslate"><span class="pre">infosource</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">dg</span></code>) together define all inputs required for the preprocessing workflow</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we want to group the outcome by contrast not subject</span>
<span class="n">contr_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">infosource_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">IdentityInterface</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contr_id&quot;</span><span class="p">]),</span>
                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;infosource_third&quot;</span><span class="p">)</span>
<span class="n">infosource_third</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;contr_id&quot;</span><span class="p">,</span> <span class="n">contr_list</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we use SelectFiles, instead of DataGrabber, because the former is more flexible with formatting syntax</span>
<span class="n">templates_third</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;copes&quot;</span><span class="p">:</span><span class="s2">&quot;contrast_</span><span class="si">{contr_id}</span><span class="s2">/*/_contr_id_</span><span class="si">{contr_id}</span><span class="s2">/*/cope*.nii.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;varcopes&quot;</span><span class="p">:</span><span class="s2">&quot;contrast_</span><span class="si">{contr_id}</span><span class="s2">/*/_contr_id_</span><span class="si">{contr_id}</span><span class="s2">/*/varcope*.nii.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;masks&quot;</span><span class="p">:</span><span class="s2">&quot;contrast_</span><span class="si">{contr_id}</span><span class="s2">/*/_contr_id_</span><span class="si">{contr_id}</span><span class="s2">/*/mask.nii.gz&quot;</span>
<span class="p">}</span>
<span class="n">templates</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;reg_copes&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_copes/*/*/cope</span><span class="si">{contr_id}</span><span class="s2">_flirt.nii.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg_varcopes&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_varcopes/*/*/varcope</span><span class="si">{contr_id}</span><span class="s2">_flirt.nii.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reg_masks&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_masks/*/*/*.nii.gz&quot;</span>
<span class="p">}</span>

<span class="n">dg_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">nio</span><span class="o">.</span><span class="n">SelectFiles</span><span class="p">(</span><span class="n">templates_third</span><span class="p">),</span>
             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;selectfiles_third&quot;</span><span class="p">)</span>
<span class="n">dg_third</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span> <span class="o">=</span> <span class="n">data_dir_third</span>

<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
        <span class="p">(</span><span class="n">infosource_third</span><span class="p">,</span> <span class="n">dg_third</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;contr_id&quot;</span><span class="p">,</span> <span class="s2">&quot;contr_id&quot;</span><span class="p">)])</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TraitError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">64</span><span class="p">],</span> <span class="n">line</span> <span class="mi">15</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">templates</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="s2">&quot;reg_copes&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_copes/*/*/cope</span><span class="si">{contr_id}</span><span class="s2">_flirt.nii.gz&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="s2">&quot;reg_varcopes&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_varcopes/*/*/varcope</span><span class="si">{contr_id}</span><span class="s2">_flirt.nii.gz&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="s2">&quot;reg_masks&quot;</span><span class="p">:</span><span class="s2">&quot;*/reg_masks/*/*/*.nii.gz&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="p">}</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">dg_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">nio</span><span class="o">.</span><span class="n">SelectFiles</span><span class="p">(</span><span class="n">templates_third</span><span class="p">),</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>              <span class="n">name</span><span class="o">=</span><span class="s2">&quot;selectfiles_third&quot;</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">15</span> <span class="n">dg_third</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span> <span class="o">=</span> <span class="n">data_dir_third</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>         <span class="p">(</span><span class="n">infosource_third</span><span class="p">,</span> <span class="n">dg_third</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;contr_id&quot;</span><span class="p">,</span> <span class="s2">&quot;contr_id&quot;</span><span class="p">)])</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="p">])</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py:135,</span> in <span class="ni">BasePath.validate</span><span class="nt">(self, objekt, name, value, return_pathlike)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">135</span>         <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">objekt</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_file</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>         <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">objekt</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/traits/base_trait_handler.py:74,</span> in <span class="ni">BaseTraitHandler.error</span><span class="nt">(self, object, name, value)</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Raises a TraitError exception.</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">60</span><span class="sd">     This method is called by the validate() method when an assigned value</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span><span class="sd">         The proposed new value for the attribute.</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">74</span>     <span class="k">raise</span> <span class="n">TraitError</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span>         <span class="nb">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_info</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">value</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span>     <span class="p">)</span>

<span class="ne">TraitError</span>: The &#39;base_directory&#39; trait of a SelectFilesInputSpec instance must be a pathlike object or string representing an existing directory, but a value of &#39;/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level2/level2_results&#39; &lt;class &#39;str&#39;&gt; was specified.
</pre></div>
</div>
</div>
</div>
<section id="third-level-glm">
<h2>Third-level GLM<a class="headerlink" href="#third-level-glm" title="Permalink to this heading">#</a></h2>
<p>Combining results from multiple runs of one subject into one</p>
<section id="id1">
<h3>Higher-level input files preparation<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<section id="id2">
<h4>Step 1: Merge registered copes &amp; varcopes &amp; masks<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmerge</span> <span class="o">-</span><span class="n">t</span> <span class="n">mask</span> <span class="p">(</span><span class="n">masks</span> <span class="kn">from</span> <span class="nn">all</span> <span class="mi">26</span> <span class="n">inputs</span><span class="p">)</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmerge</span> <span class="o">-</span><span class="n">t</span> <span class="n">cope</span> <span class="p">(</span><span class="n">copes</span> <span class="kn">from</span> <span class="nn">all</span> <span class="mi">26</span> <span class="n">inputs</span><span class="p">)</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmerge</span> <span class="o">-</span><span class="n">t</span> <span class="n">varcop</span> <span class="p">(</span><span class="n">varcopes</span> <span class="kn">from</span> <span class="nn">all</span> <span class="mi">26</span> <span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">copemerge_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_files&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;copemerge_third&quot;</span><span class="p">)</span>

<span class="n">varcopemerge_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_files&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;varcopemerge_third&quot;</span><span class="p">)</span>

<span class="n">maskmerge_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_files&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maskmerge_third&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">repeat_mask</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="c1"># n_sub = len(glob.glob(os.path.join(os.getcwd(), &#39;ds000102&#39;)+&quot;/sub-0*&quot;))    </span>
    <span class="n">n_sub</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">mask_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="p">]</span>
    <span class="n">repeated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">mask_lst</span><span class="p">,</span><span class="n">n_sub</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">repeated</span><span class="p">)</span>

<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_third</span><span class="p">,</span> <span class="s1">&#39;copes&#39;</span><span class="p">,</span> <span class="n">copemerge_third</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_third</span><span class="p">,</span> <span class="s1">&#39;varcopes&#39;</span><span class="p">,</span> <span class="n">varcopemerge_third</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_third</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;masks&#39;</span><span class="p">,</span> <span class="n">repeat_mask</span><span class="p">),</span> <span class="n">maskmerge_third</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h4>Step 2: Making mask<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<p>In FSL, there are many commands about <code class="docutils literal notranslate"><span class="pre">maskunique</span></code>, which is unless for the second level. We can ignore it.</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">mask</span> <span class="o">-</span><span class="n">Tmin</span> <span class="n">mask</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># /usr/local/fsl/bin/fslmaths mask -Tmin mask</span>
<span class="n">minmask_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-Tmin&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;minmask_third&#39;</span><span class="p">)</span>

<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">maskmerge_third</span><span class="p">,</span> <span class="s1">&#39;merged_file&#39;</span><span class="p">,</span> <span class="n">minmask_third</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h4>Step 3: Masking copes &amp; varcopes<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h4>
<p><strong>Corresponding FSL command:</strong></p>
<p>we have four contrasts so the following commands repeat four times</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">cope1</span> <span class="o">-</span><span class="n">mas</span> <span class="n">mask</span> <span class="n">cope1</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">varcope1</span> <span class="o">-</span><span class="n">mas</span> <span class="n">mask</span> <span class="n">varcope1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maskcope_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-mas&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maskcope_third&#39;</span><span class="p">)</span>

<span class="n">maskvarcope_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-mas&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maskvarcope_third&#39;</span><span class="p">)</span>

<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">copemerge_third</span><span class="p">,</span> <span class="s1">&#39;merged_file&#39;</span><span class="p">,</span> <span class="n">maskcope_third</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">minmask_third</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">maskcope_third</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">varcopemerge_third</span><span class="p">,</span> <span class="s1">&#39;merged_file&#39;</span><span class="p">,</span> <span class="n">maskvarcope_third</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">minmask_third</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">maskvarcope_third</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="set-up-third-level-contrasts">
<h3>Set up third-level contrasts<a class="headerlink" href="#set-up-third-level-contrasts" title="Permalink to this heading">#</a></h3>
<p>Since we only have a single-group set-up, we can actually use <a class="reference external" href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.interfaces.fsl.model.html#l2model">L2Model</a>.
If we have an ANOVA-like design, using <a class="reference external" href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.interfaces.fsl.model.html#multipleregressdesign">MultipleRegressDesign</a> would be a better option.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">num_copes</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

<span class="n">level3model</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">L2Model</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;l3model&#39;</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dg_third</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;copes&#39;</span><span class="p">,</span><span class="n">num_copes</span><span class="p">),</span> <span class="n">level3model</span><span class="p">,</span> <span class="s1">&#39;num_copes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">level3estimate</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">FLAMEO</span><span class="p">(</span><span class="n">run_mode</span><span class="o">=</span><span class="s1">&#39;flame1&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level3estimate&quot;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cope_file&#39;</span><span class="p">,</span> <span class="s1">&#39;var_cope_file&#39;</span><span class="p">])</span>

<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
    <span class="p">(</span><span class="n">maskcope_third</span><span class="p">,</span> <span class="n">level3estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;cope_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">maskvarcope_third</span><span class="p">,</span> <span class="n">level3estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;var_cope_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">minmask_third</span><span class="p">,</span> <span class="n">level3estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;mask_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">level3model</span><span class="p">,</span> <span class="n">level3estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;design_mat&#39;</span><span class="p">,</span> <span class="s1">&#39;design_file&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;design_con&#39;</span><span class="p">,</span> <span class="s1">&#39;t_con_file&#39;</span><span class="p">),</span> 
                                   <span class="p">(</span><span class="s1">&#39;design_grp&#39;</span><span class="p">,</span> <span class="s1">&#39;cov_split_file&#39;</span><span class="p">)]),</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="post-stats">
<h3>Post-Stats<a class="headerlink" href="#post-stats" title="Permalink to this heading">#</a></h3>
<section id="smoothness-estimation">
<h4>Smoothness estimation<a class="headerlink" href="#smoothness-estimation" title="Permalink to this heading">#</a></h4>
<p>to get <code class="docutils literal notranslate"><span class="pre">dlh</span></code> and <code class="docutils literal notranslate"><span class="pre">volume</span></code> for thresholding
<strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">smoothest</span> <span class="o">-</span><span class="n">d</span> <span class="mi">25</span> <span class="o">-</span><span class="n">m</span> <span class="n">mask</span> <span class="o">-</span><span class="n">r</span> <span class="n">stats</span><span class="o">/</span><span class="n">res4d</span> <span class="o">&gt;</span> <span class="n">stats</span><span class="o">/</span><span class="n">smoothness</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoothest</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">SmoothEstimate</span><span class="p">(</span><span class="n">dof</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;smoothest&quot;</span><span class="p">,</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;residual_fit_file&#39;</span><span class="p">,</span> <span class="s1">&#39;mask_file&#39;</span><span class="p">])</span>

<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">minmask_third</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="n">smoothest</span><span class="p">,</span> <span class="s1">&#39;mask_file&#39;</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">level3estimate</span><span class="p">,</span> <span class="s1">&#39;res4d&#39;</span><span class="p">,</span> <span class="n">smoothest</span><span class="p">,</span> <span class="s1">&#39;residual_fit_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mask-zstats-file">
<h4>Mask zstats file<a class="headerlink" href="#mask-zstats-file" title="Permalink to this heading">#</a></h4>
<p>preparation for thresholding</p>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">fslmaths</span> <span class="n">stats</span><span class="o">/</span><span class="n">zstat1</span> <span class="o">-</span><span class="n">mas</span> <span class="n">mask</span> <span class="n">thresh_zstat1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">level3mask</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
    <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">ImageMaths</span><span class="p">(</span><span class="n">op_string</span><span class="o">=</span><span class="s1">&#39;-mas&#39;</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;in_file2&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;level3mask&#39;</span><span class="p">)</span>

<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
    <span class="p">(</span><span class="n">level3estimate</span><span class="p">,</span><span class="n">level3mask</span><span class="p">,[(</span><span class="s1">&#39;zstats&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">minmask_third</span><span class="p">,</span> <span class="n">level3mask</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file2&#39;</span><span class="p">)]),</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cluster-wise-thresholding">
<h4>Cluster-wise thresholding<a class="headerlink" href="#cluster-wise-thresholding" title="Permalink to this heading">#</a></h4>
<p><strong>Corresponding FSL command:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fsl</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cluster</span> <span class="o">-</span><span class="n">i</span> <span class="n">thresh_zstat1</span> <span class="o">-</span><span class="n">t</span> <span class="mf">3.1</span> <span class="o">--</span><span class="n">othresh</span><span class="o">=</span><span class="n">thresh_zstat1</span> <span class="o">-</span><span class="n">o</span> <span class="n">cluster_mask_zstat1</span> <span class="o">--</span><span class="n">connectivity</span><span class="o">=</span><span class="mi">26</span> <span class="o">--</span><span class="n">mm</span> <span class="o">--</span><span class="n">olmax</span><span class="o">=</span><span class="n">lmax_zstat1_std</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">scalarname</span><span class="o">=</span><span class="n">Z</span> <span class="o">-</span><span class="n">p</span> <span class="mf">0.05</span> <span class="o">-</span><span class="n">d</span> <span class="mf">0.0595781</span> <span class="o">--</span><span class="n">volume</span><span class="o">=</span><span class="mi">254734</span> <span class="o">-</span><span class="n">c</span> <span class="n">stats</span><span class="o">/</span><span class="n">cope1</span> <span class="o">&gt;</span> <span class="n">cluster_zstat1_std</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">level3threshold</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
        <span class="n">interface</span><span class="o">=</span><span class="n">fsl</span><span class="o">.</span><span class="n">Cluster</span><span class="p">(</span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">3.1</span><span class="p">,</span>
                              <span class="n">pthreshold</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
                              <span class="n">use_mm</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                              <span class="n">out_threshold_file</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">out_index_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                              <span class="n">out_localmax_txt_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
    <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span><span class="s1">&#39;cope_file&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;level3threshold&#39;</span><span class="p">)</span>

<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
    <span class="p">(</span><span class="n">level3mask</span><span class="p">,</span> <span class="n">level3threshold</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">level3estimate</span><span class="p">,</span> <span class="n">level3threshold</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;copes&#39;</span><span class="p">,</span> <span class="s1">&#39;cope_file&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">smoothest</span><span class="p">,</span> <span class="n">level3threshold</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;dlh&#39;</span><span class="p">,</span> <span class="s1">&#39;dlh&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">)]),</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="save-the-output">
<h2>Save the output<a class="headerlink" href="#save-the-output" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasink_third</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">nio</span><span class="o">.</span><span class="n">DataSink</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sinker&#39;</span><span class="p">)</span>
<span class="n">datasink_third</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">base_directory</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exp_dir_third</span><span class="p">,</span> <span class="s2">&quot;level3_results&quot;</span><span class="p">)</span>

<span class="n">int2string</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;contrast_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">infosource_third</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;contr_id&#39;</span><span class="p">,</span><span class="n">int2string</span><span class="p">),</span> <span class="n">datasink_third</span><span class="p">,</span> <span class="s1">&#39;container&#39;</span><span class="p">)</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">connect</span><span class="p">([</span>
    <span class="p">(</span><span class="n">level3estimate</span><span class="p">,</span> <span class="n">datasink_third</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;stats_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;stats_dir&#39;</span><span class="p">)]),</span>
    <span class="p">(</span><span class="n">level3threshold</span><span class="p">,</span> <span class="n">datasink_third</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;threshold_file&#39;</span><span class="p">,</span> <span class="s1">&#39;thresholded&#39;</span><span class="p">),</span>
                                <span class="p">(</span><span class="s1">&#39;localmax_txt_file&#39;</span><span class="p">,</span> <span class="s1">&#39;localmax_txt&#39;</span><span class="p">),</span>
                                <span class="p">(</span><span class="s1">&#39;index_file&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">)]),</span>
           <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create 1st-level analysis output graph</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Visualize the graph</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wf_third</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">wf_third</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;graph.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">74</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Create 1st-level analysis output graph</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">wf_third</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Visualize the graph</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/workflows.py:465,</span> in <span class="ni">Workflow.write_graph</span><span class="nt">(self, dotfilename, graph2use, format, simple_form)</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>     <span class="n">dotfilename</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">dotfilename</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span>     <span class="bp">self</span><span class="o">.</span><span class="n">write_hierarchical_dotfile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span>         <span class="n">dotfilename</span><span class="o">=</span><span class="n">dotfilename</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span>         <span class="n">colored</span><span class="o">=</span><span class="n">graph2use</span> <span class="o">==</span> <span class="s2">&quot;colored&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>         <span class="n">simple_form</span><span class="o">=</span><span class="n">simple_form</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">465</span>     <span class="n">outfname</span> <span class="o">=</span> <span class="n">format_dot</span><span class="p">(</span><span class="n">dotfilename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">466</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span>     <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1405,</span> in <span class="ni">format_dot</span><span class="nt">(dotfilename, format)</span>
<span class="g g-Whitespace">   </span><span class="mi">1403</span>         <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Cannot draw directed graph; executable &#39;dot&#39; is unavailable&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1404</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1405</span>         <span class="k">raise</span> <span class="n">ioe</span>
<span class="g g-Whitespace">   </span><span class="mi">1406</span> <span class="k">return</span> <span class="n">formatted_dot</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1400,</span> in <span class="ni">format_dot</span><span class="nt">(dotfilename, format)</span>
<span class="g g-Whitespace">   </span><span class="mi">1398</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Dump a directed graph (Linux only; install via `brew` on OSX)&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1399</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1400</span>     <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_run_dot</span><span class="p">(</span><span class="n">dotfilename</span><span class="p">,</span> <span class="n">format_ext</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1401</span> <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">ioe</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1402</span>     <span class="k">if</span> <span class="s2">&quot;could not be found&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">ioe</span><span class="p">):</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/utils.py:1416,</span> in <span class="ni">_run_dot</span><span class="nt">(dotfilename, format_ext)</span>
<span class="g g-Whitespace">   </span><span class="mi">1414</span> <span class="n">formatted_dot</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dot_base</span><span class="p">,</span> <span class="n">format_ext</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1415</span> <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;dot -T</span><span class="si">{}</span><span class="s1"> -o&quot;</span><span class="si">{}</span><span class="s1">&quot; &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">format_ext</span><span class="p">,</span> <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">dotfilename</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1416</span> <span class="n">res</span> <span class="o">=</span> <span class="n">CommandLine</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">terminal_output</span><span class="o">=</span><span class="s2">&quot;allatonce&quot;</span><span class="p">,</span> <span class="n">resource_monitor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1417</span> <span class="k">return</span> <span class="n">formatted_dot</span><span class="p">,</span> <span class="n">res</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py:397,</span> in <span class="ni">BaseInterface.run</span><span class="nt">(self, cwd, ignore_exception, **inputs)</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span> <span class="c1"># Run interface</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_run_hook</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">397</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_interface</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_run_hook</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span> <span class="c1"># Collect outputs</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py:752,</span> in <span class="ni">CommandLine._run_interface</span><span class="nt">(self, runtime, correct_return_codes)</span>
<span class="g g-Whitespace">    </span><span class="mi">749</span> <span class="n">cmd_path</span> <span class="o">=</span> <span class="n">which</span><span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">runtime</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">751</span> <span class="k">if</span> <span class="n">cmd_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">752</span>     <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">753</span>         <span class="s1">&#39;No command &quot;</span><span class="si">%s</span><span class="s1">&quot; found on host </span><span class="si">%s</span><span class="s1">. Please check that the &#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">754</span>         <span class="s2">&quot;corresponding package is installed.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">755</span>         <span class="o">%</span> <span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">runtime</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">756</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">758</span> <span class="n">runtime</span><span class="o">.</span><span class="n">command_path</span> <span class="o">=</span> <span class="n">cmd_path</span>
<span class="g g-Whitespace">    </span><span class="mi">759</span> <span class="n">runtime</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">760</span>     <span class="n">get_dependencies</span><span class="p">(</span><span class="n">executable_name</span><span class="p">,</span> <span class="n">runtime</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">761</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ldd</span>
<span class="g g-Whitespace">    </span><span class="mi">762</span>     <span class="k">else</span> <span class="s2">&quot;&lt;skipped&gt;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">763</span> <span class="p">)</span>

<span class="ne">OSError</span>: No command &quot;dot&quot; found on host fv-az96-114. Please check that the corresponding package is installed.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># Run Workflow</span>
<span class="n">wf_third</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plugin</span><span class="o">=</span><span class="s2">&quot;MultiProc&quot;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_procs&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:32:03,317 nipype.workflow WARNING:
	 Storing result file without outputs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:32:03,322 nipype.workflow WARNING:
	 [Node] Error on &quot;level3.selectfiles_third&quot; (/home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level3/level3/selectfiles_third)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:32:05,166 nipype.workflow ERROR:
	 Node selectfiles_third failed to run on host fv-az96-114.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:32:05,169 nipype.workflow ERROR:
	 Saving crash info to /home/runner/work/example-notebooks/example-notebooks/functional_imaging/crash-20230626-013205-runner-selectfiles_third-269f4a6c-c413-4bd8-905e-04bfebbfd4ab.txt
Traceback (most recent call last):
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node selectfiles_third.

Traceback:
	Traceback (most recent call last):
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 429, in aggregate_outputs
	    predicted_outputs = self._list_outputs()  # Predictions from _list_outputs
	  File &quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/io.py&quot;, line 1469, in _list_outputs
	    raise IOError(msg)
	OSError: No files were found matching copes template: /home/runner/work/example-notebooks/example-notebooks/functional_imaging/output_level3/level3/selectfiles_third/contrast_&lt;undefined&gt;/*/_contr_id_&lt;undefined&gt;/*/cope*.nii.gz
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230626-01:32:07,164 nipype.workflow ERROR:
	 could not run node: level3.selectfiles_third
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">75</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Run Workflow</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">wf_third</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plugin</span><span class="o">=</span><span class="s2">&quot;MultiProc&quot;</span><span class="p">,</span> <span class="n">plugin_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_procs&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/engine/workflows.py:638,</span> in <span class="ni">Workflow.run</span><span class="nt">(self, plugin, plugin_args, updatehash)</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span> <span class="k">if</span> <span class="n">str2bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;execution&quot;</span><span class="p">][</span><span class="s2">&quot;create_report&quot;</span><span class="p">]):</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_write_report_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">execgraph</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">638</span> <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">execgraph</span><span class="p">,</span> <span class="n">updatehash</span><span class="o">=</span><span class="n">updatehash</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span> <span class="n">datestr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">T%H%M%S&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">640</span> <span class="k">if</span> <span class="n">str2bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;execution&quot;</span><span class="p">][</span><span class="s2">&quot;write_provenance&quot;</span><span class="p">]):</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/base.py:224,</span> in <span class="ni">DistributedPluginBase.run</span><span class="nt">(self, graph, config, updatehash)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="n">error</span><span class="p">,</span> <span class="n">cause</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>         <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2"> raised. Re-raising first.&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="n">error</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">224</span> <span class="k">raise</span> <span class="n">error</span> <span class="kn">from</span> <span class="nn">cause</span>

<span class="ne">RuntimeError</span>: Traceback (most recent call last):
  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">67</span><span class="p">,</span> <span class="ow">in</span> <span class="n">run_node</span>
    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">updatehash</span><span class="o">=</span><span class="n">updatehash</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">527</span><span class="p">,</span> <span class="ow">in</span> <span class="n">run</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_interface</span><span class="p">(</span><span class="n">execute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">645</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_run_interface</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_command</span><span class="p">(</span><span class="n">execute</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">771</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_run_command</span>
    <span class="k">raise</span> <span class="n">NodeExecutionError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="n">nipype</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">NodeExecutionError</span><span class="p">:</span> <span class="ne">Exception</span> <span class="n">raised</span> <span class="k">while</span> <span class="n">executing</span> <span class="n">Node</span> <span class="n">selectfiles_third</span><span class="o">.</span>

<span class="ne">Traceback</span>:
	<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
	  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">400</span><span class="p">,</span> <span class="ow">in</span> <span class="n">run</span>
	    <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregate_outputs</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
	  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">429</span><span class="p">,</span> <span class="ow">in</span> <span class="n">aggregate_outputs</span>
	    <span class="n">predicted_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_outputs</span><span class="p">()</span>  <span class="c1"># Predictions from _list_outputs</span>
	  <span class="n">File</span> <span class="s2">&quot;/home/runner/.local/lib/python3.8/site-packages/nipype/interfaces/io.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1469</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_list_outputs</span>
	    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
	<span class="ne">OSError</span><span class="p">:</span> <span class="n">No</span> <span class="n">files</span> <span class="n">were</span> <span class="n">found</span> <span class="n">matching</span> <span class="n">copes</span> <span class="n">template</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runner</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">notebooks</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">notebooks</span><span class="o">/</span><span class="n">functional_imaging</span><span class="o">/</span><span class="n">output_level3</span><span class="o">/</span><span class="n">level3</span><span class="o">/</span><span class="n">selectfiles_third</span><span class="o">/</span><span class="n">contrast_</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;/*/</span><span class="n">_contr_id_</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;/*/</span><span class="n">cope</span><span class="o">*.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unthresholded-copes">
<h2>Unthresholded COPEs<a class="headerlink" href="#unthresholded-copes" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nipype_cope1</span> <span class="o">=</span> <span class="s1">&#39;./output_level3/level3_results/contrast_1/stats_dir/_contr_id_1/stats/cope1.nii.gz&#39;</span>
<span class="n">nipype_cope2</span> <span class="o">=</span> <span class="s1">&#39;./output_level3/level3_results/contrast_2/stats_dir/_contr_id_2/stats/cope1.nii.gz&#39;</span>
<span class="n">nipype_cope3</span> <span class="o">=</span> <span class="s1">&#39;./output_level3/level3_results/contrast_3/stats_dir/_contr_id_3/stats/cope1.nii.gz&#39;</span>
<span class="n">nipype_cope4</span> <span class="o">=</span> <span class="s1">&#39;./output_level3/level3_results/contrast_4/stats_dir/_contr_id_4/stats/cope1.nii.gz&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_nipype_cope1</span> <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">vol_to_surf</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">fsaverage</span><span class="o">.</span><span class="n">pial_right</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span>
        <span class="n">fsaverage</span><span class="o">.</span><span class="n">infl_right</span><span class="p">,</span> <span class="n">t_nipype_cope1</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - COPE1&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_right</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">t_nipype_cope2</span> <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">vol_to_surf</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span> <span class="n">fsaverage</span><span class="o">.</span><span class="n">pial_right</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span>
        <span class="n">fsaverage</span><span class="o">.</span><span class="n">infl_right</span><span class="p">,</span> <span class="n">t_nipype_cope2</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - COPE2&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_right</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">t_nipype_cope3</span> <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">vol_to_surf</span><span class="p">(</span><span class="n">nipype_cope3</span><span class="p">,</span> <span class="n">fsaverage</span><span class="o">.</span><span class="n">pial_right</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span>
        <span class="n">fsaverage</span><span class="o">.</span><span class="n">infl_right</span><span class="p">,</span> <span class="n">t_nipype_cope3</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - COPE3&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_right</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">t_nipype_cope4</span> <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">vol_to_surf</span><span class="p">(</span><span class="n">nipype_cope4</span><span class="p">,</span> <span class="n">fsaverage</span><span class="o">.</span><span class="n">pial_right</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span>
        <span class="n">fsaverage</span><span class="o">.</span><span class="n">infl_right</span><span class="p">,</span> <span class="n">t_nipype_cope4</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - COPE4&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_right</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">77</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">t_nipype_cope1</span> <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">vol_to_surf</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span> <span class="n">fsaverage</span><span class="o">.</span><span class="n">pial_right</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>         <span class="n">fsaverage</span><span class="o">.</span><span class="n">infl_right</span><span class="p">,</span> <span class="n">t_nipype_cope1</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>         <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - COPE1&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>         <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_right</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/surface/surface.py:634,</span> in <span class="ni">vol_to_surf</span><span class="nt">(img, surf_mesh, radius, interpolation, kind, n_samples, mask_img, inner_mesh, depth)</span>
<span class="g g-Whitespace">    </span><span class="mi">631</span> <span class="k">if</span> <span class="n">interpolation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sampling_schemes</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">632</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;interpolation&#39; should be one of &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">633</span>                      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sampling_schemes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">634</span> <span class="n">img</span> <span class="o">=</span> <span class="n">load_img</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">635</span> <span class="k">if</span> <span class="n">mask_img</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span>     <span class="n">mask_img</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">check_niimg</span><span class="p">(</span><span class="n">mask_img</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/image/image.py:1333,</span> in <span class="ni">load_img</span><span class="nt">(img, wildcards, dtype)</span>
<span class="g g-Whitespace">   </span><span class="mi">1295</span> <span class="k">def</span> <span class="nf">load_img</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">wildcards</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1296</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Load a Niimg-like object from filenames or list of filenames.</span>
<span class="g g-Whitespace">   </span><span class="mi">1297</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1298</span><span class="sd">     .. versionadded:: 0.2.5</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1331</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1332</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1333</span>     <span class="k">return</span> <span class="n">check_niimg</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">wildcards</span><span class="o">=</span><span class="n">wildcards</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:303,</span> in <span class="ni">check_niimg</span><span class="nt">(niimg, ensure_ndim, atleast_4d, dtype, return_iterator, wildcards)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">303</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span> <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">niimg</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: File not found: &#39;./output_level3/level3_results/contrast_1/stats_dir/_contr_id_1/stats/cope1.nii.gz&#39;
</pre></div>
</div>
</div>
</div>
<section id="thresholded-p-0-05-zstats">
<h3>Thresholded (p &lt; 0.05) zstats<a class="headerlink" href="#thresholded-p-0-05-zstats" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nipype_cope1</span> <span class="o">=</span> <span class="s1">&#39;./output_level3/level3_results/contrast_1/thresholded/_contr_id_1/zstat1_maths_threshold.nii.gz&#39;</span>
<span class="n">nipype_cope2</span> <span class="o">=</span> <span class="s1">&#39;./output_level3/level3_results/contrast_2/thresholded/_contr_id_2/zstat1_maths_threshold.nii.gz&#39;</span>
<span class="n">nipype_cope3</span> <span class="o">=</span> <span class="s1">&#39;./output_level3/level3_results/contrast_3/thresholded/_contr_id_3/zstat1_maths_threshold.nii.gz&#39;</span>
<span class="n">nipype_cope4</span> <span class="o">=</span> <span class="s1">&#39;./output_level3/level3_results/contrast_4/thresholded/_contr_id_4/zstat1_maths_threshold.nii.gz&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_img_on_surf</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span>
                          <span class="n">views</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lateral&#39;</span><span class="p">],</span>
                          <span class="n">hemispheres</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - Thresholded-zstats1&quot;</span><span class="p">,</span>
                          <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">plot_img_on_surf</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span>
                          <span class="n">views</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lateral&#39;</span><span class="p">],</span>
                          <span class="n">hemispheres</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - Thresholded-zstats2&quot;</span><span class="p">,</span>
                          <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">plot_img_on_surf</span><span class="p">(</span><span class="n">nipype_cope3</span><span class="p">,</span>
                          <span class="n">views</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lateral&#39;</span><span class="p">],</span>
                          <span class="n">hemispheres</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - Thresholded-zstats3&quot;</span><span class="p">,</span>
                          <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">plot_img_on_surf</span><span class="p">(</span><span class="n">nipype_cope4</span><span class="p">,</span>
                          <span class="n">views</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lateral&#39;</span><span class="p">],</span>
                          <span class="n">hemispheres</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - Thresholded-zstats4&quot;</span><span class="p">,</span>
                          <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">79</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_img_on_surf</span><span class="p">(</span><span class="n">nipype_cope1</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                           <span class="n">views</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lateral&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                           <span class="n">hemispheres</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>                           <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - Thresholded-zstats1&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>                           <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_img_on_surf</span><span class="p">(</span><span class="n">nipype_cope2</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>                           <span class="n">views</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lateral&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>                           <span class="n">hemispheres</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>                           <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Nipype - Thresholded-zstats2&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>                           <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/plotting/surf_plotting.py:1351,</span> in <span class="ni">plot_img_on_surf</span><span class="nt">(stat_map, surf_mesh, mask_img, hemispheres, bg_on_data, inflate, views, output_file, title, colorbar, vmax, threshold, cmap, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1347</span>     <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1348</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">((</span><span class="s1">&#39;plot_img_on_surf does not&#39;</span>
<span class="g g-Whitespace">   </span><span class="mi">1349</span>                           <span class="s1">&#39; accept </span><span class="si">%s</span><span class="s1"> as an argument&#39;</span> <span class="o">%</span> <span class="n">arg</span><span class="p">))</span>
<span class="ne">-&gt; </span><span class="mi">1351</span> <span class="n">stat_map</span> <span class="o">=</span> <span class="n">check_niimg_3d</span><span class="p">(</span><span class="n">stat_map</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1352</span> <span class="n">modes</span> <span class="o">=</span> <span class="n">_check_views</span><span class="p">(</span><span class="n">views</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1353</span> <span class="n">hemis</span> <span class="o">=</span> <span class="n">_check_hemispheres</span><span class="p">(</span><span class="n">hemispheres</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:371,</span> in <span class="ni">check_niimg_3d</span><span class="nt">(niimg, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span> <span class="k">def</span> <span class="nf">check_niimg_3d</span><span class="p">(</span><span class="n">niimg</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Check that niimg is a proper 3D niimg-like object and load it.</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">340</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">370</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">371</span>     <span class="k">return</span> <span class="n">check_niimg</span><span class="p">(</span><span class="n">niimg</span><span class="p">,</span> <span class="n">ensure_ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/nilearn/_utils/niimg_conversions.py:303,</span> in <span class="ni">check_niimg</span><span class="nt">(niimg, ensure_ndim, atleast_4d, dtype, return_iterator, wildcards)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">303</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span> <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">niimg</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: &#39;</span><span class="si">{</span><span class="n">niimg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: File not found: &#39;./output_level3/level3_results/contrast_1/thresholded/_contr_id_1/zstat1_maths_threshold.nii.gz&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./functional_imaging"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Setup Neurodesk</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#first-level-glm-using-nipype-fsl">First-level GLM using Nipype FSL</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-data-path">Set up data path</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#start-the-workflow">Start the workflow</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initialisation">Initialisation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motion-correction">Motion Correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functionally-masking">Functionally Masking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grand-mean-scaling">Grand Mean Scaling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#susan-noise-reduction">SUSAN Noise Reduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-filtering">Temporal Filtering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#first-level-glm">First-Level GLM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-events">Get events</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-contrasts">Set-up contrasts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#registration">Registration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1">Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2">Step 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-first-level-glm">The first-level GLM</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#second-level-glm-using-nipype-fsl">Second level GLM using Nipype FSL</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-level-glm">Second-level GLM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-level-input-files-preparation">Higher-level input files preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-merge-registered-copes-varcopes-masks">Step 1: Merge registered copes &amp; varcopes &amp; masks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-making-mask">Step 2: Making mask</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-masking-copes-varcopes">Step 3: Masking copes &amp; varcopes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-second-level-contrasts-and-fixed-effects">Set up second-level contrasts and fixed-effects</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-second-level-glm">The second-level GLM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regapply">Regapply</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copes-from-the-second-level-glm">Copes from the second-level GLM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#third-level-glm-using-nipype-fsl">Third-level GLM using Nipype FSL</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#third-level-glm">Third-level GLM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Higher-level input files preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Step 1: Merge registered copes &amp; varcopes &amp; masks</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Step 2: Making mask</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Step 3: Masking copes &amp; varcopes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-third-level-contrasts">Set up third-level contrasts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-stats">Post-Stats</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#smoothness-estimation">Smoothness estimation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mask-zstats-file">Mask zstats file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-wise-thresholding">Cluster-wise thresholding</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-the-output">Save the output</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unthresholded-copes">Unthresholded COPEs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thresholded-p-0-05-zstats">Thresholded (p &lt; 0.05) zstats</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Neurodesk Team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>